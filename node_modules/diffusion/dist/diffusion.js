!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).diffusion=e()}}(function(){var e=function(e){var t;return function(r){return t||e(t={exports:{},parent:r},t.exports),t.exports}},t=e(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=require("zlib");t.decompressSync=function(e){return r.inflateSync(e)}}),r=e(function(e,t){(function(e){"use strict";var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=e,t.INSPECT_MAX_BYTES=50;var n=2147483647;function o(t){if(t>n)throw new RangeError('The value "'+t+'" is invalid for option "size"');var r=new Uint8Array(t);return Object.setPrototypeOf(r,e.prototype),r}function e(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return a(e)}return i(e,t,r)}function i(t,r,n){if("string"==typeof t)return function(t,r){"string"==typeof r&&""!==r||(r="utf8");if(!e.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var n=0|f(t,r),i=o(n),s=i.write(t,r);s!==n&&(i=i.slice(0,s));return i}(t,r);if(ArrayBuffer.isView(t))return u(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(x(t,ArrayBuffer)||t&&x(t.buffer,ArrayBuffer))return c(t,r,n);if("undefined"!=typeof SharedArrayBuffer&&(x(t,SharedArrayBuffer)||t&&x(t.buffer,SharedArrayBuffer)))return c(t,r,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return e.from(i,r,n);var s=function(t){if(e.isBuffer(t)){var r=0|p(t.length),n=o(r);return 0===n.length?n:(t.copy(n,0,0,r),n)}if(void 0!==t.length)return"number"!=typeof t.length||B(t.length)?o(0):u(t);if("Buffer"===t.type&&Array.isArray(t.data))return u(t.data)}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return e.from(t[Symbol.toPrimitive]("string"),r,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function a(e){return s(e),o(e<0?0:0|p(e))}function u(e){for(var t=e.length<0?0:0|p(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function c(t,r,n){if(r<0||t.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<r+(n||0))throw new RangeError('"length" is outside of buffer bounds');var o;return o=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),Object.setPrototypeOf(o,e.prototype),o}function p(e){if(e>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function f(t,r){if(e.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||x(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,o=arguments.length>2&&!0===arguments[2];if(!o&&0===n)return 0;for(var i=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return D(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(t).length;default:if(i)return o?-1:D(t).length;r=(""+r).toLowerCase(),i=!0}}function l(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function h(t,r,n,o,i){if(0===t.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),B(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof r&&(r=e.from(r,o)),e.isBuffer(r))return 0===r.length?-1:d(t,r,n,o,i);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,n):Uint8Array.prototype.lastIndexOf.call(t,r,n):d(t,[r],n,o,i);throw new TypeError("val must be string, number or Buffer")}function d(e,t,r,n,o){var i,s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var p=-1;for(i=r;i<a;i++)if(c(e,i)===c(t,-1===p?0:i-p)){if(-1===p&&(p=i),i-p+1===u)return p*s}else-1!==p&&(i-=i-p),p=-1}else for(r+u>a&&(r=a-u),i=r;i>=0;i--){for(var f=!0,l=0;l<u;l++)if(c(e,i+l)!==c(t,l)){f=!1;break}if(f)return i}return-1}function y(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(B(a))return s;e[r+s]=a}return s}function v(e,t,r,n){return U(D(t,e.length-r),e,r,n)}function _(e,t,r,n){return U(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return _(e,t,r,n)}function E(e,t,r,n){return U(j(t),e,r,n)}function m(e,t,r,n){return U(function(e,t){for(var r,n,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function w(e,t,r){return 0===t&&r===e.length?Iy.fromByteArray(e):Iy.fromByteArray(e.slice(t,r))}function g(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,s,a,u,c=e[o],p=null,f=c>239?4:c>223?3:c>191?2:1;if(o+f<=r)switch(f){case 1:c<128&&(p=c);break;case 2:128==(192&(i=e[o+1]))&&(u=(31&c)<<6|63&i)>127&&(p=u);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(u=(15&c)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(p=u);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(p=u)}null===p?(p=65533,f=1):p>65535&&(p-=65536,n.push(p>>>10&1023|55296),p=56320|1023&p),n.push(p),o+=f}return function(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=O));return r}(n)}e.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),e.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),e.poolSize=8192,e.from=function(e,t,r){return i(e,t,r)},Object.setPrototypeOf(e.prototype,Uint8Array.prototype),Object.setPrototypeOf(e,Uint8Array),e.alloc=function(e,t,r){return function(e,t,r){return s(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},e.allocUnsafe=function(e){return a(e)},e.allocUnsafeSlow=function(e){return a(e)},e.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==e.prototype},e.compare=function(t,r){if(x(t,Uint8Array)&&(t=e.from(t,t.offset,t.byteLength)),x(r,Uint8Array)&&(r=e.from(r,r.offset,r.byteLength)),!e.isBuffer(t)||!e.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===r)return 0;for(var n=t.length,o=r.length,i=0,s=Math.min(n,o);i<s;++i)if(t[i]!==r[i]){n=t[i],o=r[i];break}return n<o?-1:o<n?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,r){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<t.length;++n)r+=t[n].length;var o=e.allocUnsafe(r),i=0;for(n=0;n<t.length;++n){var s=t[n];if(x(s,Uint8Array)&&(s=e.from(s)),!e.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(o,i),i+=s.length}return o},e.byteLength=f,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)l(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)l(this,t,t+3),l(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)l(this,t,t+7),l(this,t+1,t+6),l(this,t+2,t+5),l(this,t+3,t+4);return this},e.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?g(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return g(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return I(this,t,r);case"base64":return w(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},r&&(e.prototype[r]=e.prototype.inspect),e.prototype.compare=function(t,r,n,o,i){if(x(t,Uint8Array)&&(t=e.from(t,t.offset,t.byteLength)),!e.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===r&&(r=0),void 0===n&&(n=t?t.length:0),void 0===o&&(o=0),void 0===i&&(i=this.length),r<0||n>t.length||o<0||i>this.length)throw new RangeError("out of range index");if(o>=i&&r>=n)return 0;if(o>=i)return-1;if(r>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(o>>>=0),a=(n>>>=0)-(r>>>=0),u=Math.min(s,a),c=this.slice(o,i),p=t.slice(r,n),f=0;f<u;++f)if(c[f]!==p[f]){s=c[f],a=p[f];break}return s<a?-1:a<s?1:0},e.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},e.prototype.indexOf=function(e,t,r){return h(this,e,t,r,!0)},e.prototype.lastIndexOf=function(e,t,r){return h(this,e,t,r,!1)},e.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return v(this,e,t,r);case"ascii":return _(this,e,t,r);case"latin1":case"binary":return S(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function T(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function I(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function R(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=k[e[i]];return o}function b(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function C(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function P(t,r,n,o,i,s){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<s)throw new RangeError('"value" argument is out of bounds');if(n+o>t.length)throw new RangeError("Index out of range")}function A(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function N(e,t,r,n,o){return t=+t,r>>>=0,o||A(e,0,r,4),Dy.write(e,t,r,n,23,4),r+4}function M(e,t,r,n,o){return t=+t,r>>>=0,o||A(e,0,r,8),Dy.write(e,t,r,n,52,8),r+8}e.prototype.slice=function(t,r){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t);var o=this.subarray(t,r);return Object.setPrototypeOf(o,e.prototype),o},e.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},e.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},e.prototype.readUInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},e.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},e.prototype.readInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},e.prototype.readInt16LE=function(e,t){e>>>=0,t||C(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt16BE=function(e,t){e>>>=0,t||C(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return e>>>=0,t||C(e,4,this.length),Dy.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return e>>>=0,t||C(e,4,this.length),Dy.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return e>>>=0,t||C(e,8,this.length),Dy.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return e>>>=0,t||C(e,8,this.length),Dy.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||P(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},e.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||P(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},e.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,255,0),this[t]=255&e,t+1},e.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},e.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);P(this,e,t,r,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},e.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);P(this,e,t,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},e.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},e.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},e.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeFloatLE=function(e,t,r){return N(this,e,t,!0,r)},e.prototype.writeFloatBE=function(e,t,r){return N(this,e,t,!1,r)},e.prototype.writeDoubleLE=function(e,t,r){return M(this,e,t,!0,r)},e.prototype.writeDoubleBE=function(e,t,r){return M(this,e,t,!1,r)},e.prototype.copy=function(t,r,n,o){if(!e.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),o||0===o||(o=this.length),r>=t.length&&(r=t.length),r||(r=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-r<o-n&&(o=t.length-r+n);var i=o-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,n,o);else if(this===t&&n<r&&r<o)for(var s=i-1;s>=0;--s)t[s+r]=this[s+n];else Uint8Array.prototype.set.call(t,this.subarray(n,o),r);return i},e.prototype.fill=function(t,r,n,o){if("string"==typeof t){if("string"==typeof r?(o=r,r=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!e.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(1===t.length){var i=t.charCodeAt(0);("utf8"===o&&i<128||"latin1"===o)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;var s;if(r>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=r;s<n;++s)this[s]=t;else{var a=e.isBuffer(t)?t:e.from(t,o),u=a.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=a[s%u]}return this};var L=/[^+/0-9A-Za-z-_]/g;function D(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function j(e){return Iy.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function x(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function B(e){return e!=e}var k=function(){for(var e=new Array(256),t=0;t<16;++t)for(var r=16*t,n=0;n<16;++n)e[r+n]="0123456789abcdef"[t]+"0123456789abcdef"[n];return e}()}).call(this,r({}).Buffer)}),n=e(function(e,t){"use strict";var r=z({}),n=H({}),a=D({}),c=i({}),p=x({}),l=s({}),h=W({}),d=u({}),y=N({}),v=A({}),_=o({}),S=O({}).f,E=k({}).f,m=f({}),w="prototype",g="Wrong index!",T=r.ArrayBuffer,I=r.DataView,R=r.Math,b=r.RangeError,C=r.Infinity,P=T,M=R.abs,L=R.pow,j=R.floor,U=R.log,B=R.LN2,q=n?"_b":"buffer",V=n?"_l":"byteLength",F=n?"_o":"byteOffset";function G(e,t,r){var n,o,i,s=new Array(r),a=8*r-t-1,u=(1<<a)-1,c=u>>1,p=23===t?L(2,-24)-L(2,-77):0,f=0,l=e<0||0===e&&1/e<0?1:0;for((e=M(e))!=e||e===C?(o=e!=e?1:0,n=u):(n=j(U(e)/B),e*(i=L(2,-n))<1&&(n--,i*=2),(e+=n+c>=1?p/i:p*L(2,1-c))*i>=2&&(n++,i/=2),n+c>=u?(o=0,n=u):n+c>=1?(o=(e*i-1)*L(2,t),n+=c):(o=e*L(2,c-1)*L(2,t),n=0));t>=8;s[f++]=255&o,o/=256,t-=8);for(n=n<<t|o,a+=t;a>0;s[f++]=255&n,n/=256,a-=8);return s[--f]|=128*l,s}function Y(e,t,r){var n,o=8*r-t-1,i=(1<<o)-1,s=i>>1,a=o-7,u=r-1,c=e[u--],p=127&c;for(c>>=7;a>0;p=256*p+e[u],u--,a-=8);for(n=p&(1<<-a)-1,p>>=-a,a+=t;a>0;n=256*n+e[u],u--,a-=8);if(0===p)p=1-s;else{if(p===i)return n?NaN:c?-C:C;n+=L(2,t),p-=s}return(c?-1:1)*n*L(2,p-t)}function J(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function $(e){return[255&e]}function K(e){return[255&e,e>>8&255]}function Q(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function X(e){return G(e,52,8)}function Z(e){return G(e,23,4)}function ee(e,t,r){E(e[w],t,{get:function(){return this[r]}})}function te(e,t,r,n){var o=_(+r);if(o+t>e[V])throw b(g);var i=e[q]._b,s=o+e[F],a=i.slice(s,s+t);return n?a:a.reverse()}function re(e,t,r,n,o,i){var s=_(+r);if(s+t>e[V])throw b(g);for(var a=e[q]._b,u=s+e[F],c=n(+o),p=0;p<t;p++)a[u+p]=c[i?p:t-p-1]}if(c.ABV){if(!h(function(){T(1)})||!h(function(){new T(-1)})||h(function(){return new T,new T(1.5),new T(NaN),"ArrayBuffer"!=T.name})){for(var ne,oe=(T=function(e){return d(this,T),new P(_(e))})[w]=P[w],ie=S(P),se=0;ie.length>se;)(ne=ie[se++])in T||p(T,ne,P[ne]);a||(oe.constructor=T)}var ae=new I(new T(2)),ue=I[w].setInt8;ae.setInt8(0,2147483648),ae.setInt8(1,2147483649),!ae.getInt8(0)&&ae.getInt8(1)||l(I[w],{setInt8:function(e,t){ue.call(this,e,t<<24>>24)},setUint8:function(e,t){ue.call(this,e,t<<24>>24)}},!0)}else T=function(e){d(this,T,"ArrayBuffer");var t=_(e);this._b=m.call(new Array(t),0),this[V]=t},I=function(e,t,r){d(this,I,"DataView"),d(e,T,"DataView");var n=e[V],o=y(t);if(o<0||o>n)throw b("Wrong offset!");if(o+(r=void 0===r?n-o:v(r))>n)throw b("Wrong length!");this[q]=e,this[F]=o,this[V]=r},n&&(ee(T,"byteLength","_l"),ee(I,"buffer","_b"),ee(I,"byteLength","_l"),ee(I,"byteOffset","_o")),l(I[w],{getInt8:function(e){return te(this,1,e)[0]<<24>>24},getUint8:function(e){return te(this,1,e)[0]},getInt16:function(e){var t=te(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=te(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return J(te(this,4,e,arguments[1]))},getUint32:function(e){return J(te(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return Y(te(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return Y(te(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){re(this,1,e,$,t)},setUint8:function(e,t){re(this,1,e,$,t)},setInt16:function(e,t){re(this,2,e,K,t,arguments[2])},setUint16:function(e,t){re(this,2,e,K,t,arguments[2])},setInt32:function(e,t){re(this,4,e,Q,t,arguments[2])},setUint32:function(e,t){re(this,4,e,Q,t,arguments[2])},setFloat32:function(e,t){re(this,4,e,Z,t,arguments[2])},setFloat64:function(e,t){re(this,8,e,X,t,arguments[2])}});et(T,"ArrayBuffer"),et(I,"DataView"),p(I[w],c.VIEW,!0),t.ArrayBuffer=T,t.DataView=I}),o=e(function(e,t){var r=N({}),n=A({});e.exports=function(e){if(void 0===e)return 0;var t=r(e),o=n(t);if(t!==o)throw RangeError("Wrong length!");return o}}),i=e(function(e,t){for(var r,n=z({}),o=x({}),i=j({}),s=i("typed_array"),a=i("view"),u=!(!n.ArrayBuffer||!n.DataView),c=u,p=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");p<9;)(r=n[f[p++]])?(o(r.prototype,s,!0),o(r.prototype,a,!0)):c=!1;e.exports={ABV:u,CONSTR:c,TYPED:s,VIEW:a}}),s=e(function(e,t){var r=x({});e.exports=function(e,t,n){for(var o in t)n&&e[o]?e[o]=t[o]:r(e,o,t[o]);return e}}),a=e(function(e,t){var r=L({})("species");e.exports=function(e,t){var n,o=je(e).constructor;return void 0===o||null==(n=je(o)[r])?t:Le(n)}}),u=e(function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}}),c=e(function(e,t){"use strict";var r=S({});e.exports=ri(Array,"Array",function(e,t){this._t=ct(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,zs(1)):zs(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),r.Arguments=r.Array,Bs("keys"),Bs("values"),Bs("entries")}),p=e(function(e,t){"use strict";var r=z({}),n=k({}),o=H({}),i=L({})("species");e.exports=function(e){var t="function"==typeof Ne[e]?Ne[e]:r[e];o&&t&&!t[i]&&n.f(t,i,{configurable:!0,get:function(){return this}})}}),f=e(function(e,t){"use strict";var r=m({}),n=P({}),o=A({});e.exports=function(e){for(var t=r(this),i=o(t.length),s=arguments.length,a=n(s>1?arguments[1]:void 0,i),u=s>2?arguments[2]:void 0,c=void 0===u?i:n(u,i);c>a;)t[a++]=e;return t}}),l=e(function(e,t){"use strict";var r=m({}),n=P({}),o=A({});e.exports=[].copyWithin||function(e,t){var i=r(this),s=o(i.length),a=n(e,s),u=n(t,s),c=arguments.length>2?arguments[2]:void 0,p=Math.min((void 0===c?s:n(c,s))-u,s-a),f=1;for(u<a&&a<u+p&&(f=-1,u+=p-1,a+=p-1);p-- >0;)u in i?i[a]=i[u]:delete i[a],a+=f,u+=f;return i}}),h=e(function(e,t){var r=G({}),n=m({}),o=A({});e.exports=function(e,t){var i=1==e,s=2==e,a=3==e,u=4==e,c=6==e,p=5==e||c,f=t||ls;return function(t,l,h){for(var d,y,v=n(t),_=at(v),S=r(l,h,3),E=o(_.length),m=0,w=i?f(t,E):s?f(t,0):void 0;E>m;m++)if((p||m in _)&&(y=S(d=_[m],m,v),e))if(i)w[m]=y;else if(y)switch(e){case 3:return!0;case 5:return d;case 6:return m;case 2:w.push(d)}else if(u)return!1;return c?-1:a||u?u:w}}}),d=e(function(e,t){var r=L({})("iterator"),n=!1;try{var o=[7][r]();o.return=function(){n=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!n)return!1;var o=!1;try{var i=[7],s=i[r]();s.next=function(){return{done:o=!0}},i[r]=function(){return s},e(i)}catch(e){}return o}}),y=e(function(e,t){var r=_({}),n=L({})("iterator"),o=S({});e.exports=Ne.getIteratorMethod=function(e){if(null!=e)return e[n]||e["@@iterator"]||o[r(e)]}}),v=e(function(e,t){var r=S({}),n=L({})("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[n]===e)}}),_=e(function(e,t){var r=M({}),n=L({})("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,i,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),n))?i:o?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}}),S=e(function(e,t){e.exports={}}),E=e(function(e,t){var r=Y({}),n=m({}),o=lt("IE_PROTO"),i=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=n(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?i:null}}),m=e(function(e,t){e.exports=function(e){return Object(ut(e))}}),w=e(function(e,t){var r=R({}),n=B({}),o=q({}),i=Y({}),s=Object.getOwnPropertyDescriptor;t.f=H({})?s:function(e,t){if(e=ct(e),t=o(t,!0),Ue)try{return s(e,t)}catch(e){}if(i(e,t))return n(!r.f.call(e,t),e[t])}}),g=e(function(e,t){var r=O({}).f,n={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==n.call(e)?function(e){try{return r(e)}catch(e){return o.slice()}}(e):r(ct(e))}}),O=e(function(e,t){var r=_t.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return vt(e,r)}}),T=e(function(e,t){var r=lt("IE_PROTO"),n=function(){},o=function(){var e,t=V({})("iframe"),r=_t.length;for(t.style.display="none",I({}).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),o=e.F;r--;)delete o.prototype[_t[r]];return o()};e.exports=Object.create||function(e,t){var i;return null!==e?(n.prototype=je(e),i=new n,n.prototype=null,i[r]=e):i=o(),void 0===t?i:Tt(i,t)}}),I=e(function(e,t){var r=z({}).document;e.exports=r&&r.documentElement}),R=e(function(e,t){t.f={}.propertyIsEnumerable}),b=e(function(e,t){t.f=Object.getOwnPropertySymbols}),C=e(function(e,t){var r=A({}),n=P({});e.exports=function(e){return function(t,o,i){var s,a=ct(t),u=r(a.length),c=n(i,u);if(e&&o!=o){for(;u>c;)if((s=a[c++])!=s)return!0}else for(;u>c;c++)if((e||c in a)&&a[c]===o)return e||c||0;return!e&&-1}}}),P=e(function(e,t){var r=N({}),n=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?n(e+t,0):o(e,t)}}),A=e(function(e,t){var r=N({}),n=Math.min;e.exports=function(e){return e>0?n(r(e),9007199254740991):0}}),N=e(function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}}),M=e(function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}}),L=e(function(e,t){var r=Je("wks"),n=j({}),o=z({}).Symbol,i="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=i&&o[e]||(i?o:n)("Symbol."+e))}).store=r}),D=e(function(e,t){e.exports=!0}),j=e(function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}}),U=e(function(e,t){var r=z({}),n=G({}),o=x({}),i=Y({}),s=function(e,t,a){var u,c,p,f=e&s.F,l=e&s.G,h=e&s.S,d=e&s.P,y=e&s.B,v=e&s.W,_=l?Ne:Ne[t]||(Ne[t]={}),S=_.prototype,E=l?r:h?r[t]:(r[t]||{}).prototype;for(u in l&&(a=t),a)(c=!f&&E&&void 0!==E[u])&&i(_,u)||(p=c?E[u]:a[u],_[u]=l&&"function"!=typeof E[u]?a[u]:y&&c?n(p,r):v&&E[u]==p?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(p):d&&"function"==typeof p?n(Function.call,p):p,d&&((_.virtual||(_.virtual={}))[u]=p,e&s.R&&S&&!S[u]&&o(S,u,p)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s}),x=e(function(e,t){var r=k({}),n=B({});e.exports=H({})?function(e,t,o){return r.f(e,t,n(1,o))}:function(e,t,r){return e[t]=r,e}}),B=e(function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}}),k=e(function(e,t){var r=q({}),n=Object.defineProperty;t.f=H({})?Object.defineProperty:function(e,t,o){if(je(e),t=r(t,!0),je(o),Ue)try{return n(e,t,o)}catch(e){}if("get"in o||"set"in o)throw TypeError("Accessors not supported!");return"value"in o&&(e[t]=o.value),e}}),q=e(function(e,t){var r=F({});e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}}),V=e(function(e,t){var r=F({}),n=z({}).document,o=r(n)&&r(n.createElement);e.exports=function(e){return o?n.createElement(e):{}}}),F=e(function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}}),G=e(function(e,t){e.exports=function(e,t,r){if(Le(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}}),H=e(function(e,t){e.exports=!W({})(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})}),W=e(function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}}),Y=e(function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}}),z=e(function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)}),J={};Object.defineProperty(J,"__esModule",{value:!0});var $=function(){function e(e,t){this.currentTimeout=null,this.pingTimeout=e,this.connection=t,this.currentTimeout=setTimeout(t.closeIdleConnection.bind(t),e)}return e.prototype.onSystemPing=function(){var e=this;null!==this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=setTimeout(function(){e.connection.closeIdleConnection()},this.pingTimeout))},e.prototype.shutdown=function(){null!==this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null)},e}();J.ConnectionActivityMonitorImpl=$;var K={};Object.defineProperty(K,"__esModule",{value:!0});var Q=2,X={onSystemPing:function(){},shutdown:function(){}};K.connectionActivityMonitorFactory=function(e,t){if(!t.systemPingPeriod)return X;var r=t.systemPingPeriod.toNumber();if(r>0){var n=r*Q;return new J.ConnectionActivityMonitorImpl(n,e)}return X};var Z={};Object.defineProperty(Z,"__esModule",{value:!0});var ee=function(){function e(e){this.factory=e}return e.prototype.onNewConnection=function(e,t){this.currentConnectionMonitor=this.factory(e,t)},e.prototype.onConnectionClosed=function(){void 0!==this.currentConnectionMonitor&&(this.currentConnectionMonitor.shutdown(),this.currentConnectionMonitor=void 0)},e.prototype.onSystemPing=function(){void 0!==this.currentConnectionMonitor&&this.currentConnectionMonitor.onSystemPing()},e}();Z.NOOP={onNewConnection:function(){},onConnectionClosed:function(){},onSystemPing:function(){}},Z.create=function(e){return new ee(e)};var te={};Object.defineProperty(te,"__esModule",{value:!0}),function(e){e.INITIALISING="initialising",e.CONNECTING="connecting",e.CONNECTED="connected",e.DISCONNECTED="disconnected",e.RECONNECTING="reconnecting",e.CLOSING="closing",e.CLOSED="closed"}(te.InternalSessionState||(te.InternalSessionState={}));var re={};Object.defineProperty(re,"__esModule",{value:!0});var ne=function(){function e(e,t){this.id=e,this.reason=t}return e.prototype.toString=function(){return this.id+": "+this.reason},e}();re.ErrorReason=ne;var oe=se,ie=null;try{ie=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function se(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function ae(e){return!0===(e&&e.__isLong__)}se.prototype.__isLong__,Object.defineProperty(se.prototype,"__isLong__",{value:!0}),se.isLong=ae;var ue={},ce={};function pe(e,t){var r,n,o;return t?(o=0<=(e>>>=0)&&e<256)&&(n=ce[e])?n:(r=le(e,(0|e)<0?-1:0,!0),o&&(ce[e]=r),r):(o=-128<=(e|=0)&&e<128)&&(n=ue[e])?n:(r=le(e,e<0?-1:0,!1),o&&(ue[e]=r),r)}function fe(e,t){if(isNaN(e))return t?we:me;if(t){if(e<0)return we;if(e>=_e)return Re}else{if(e<=-Se)return be;if(e+1>=Se)return Ie}return e<0?fe(-e,t).neg():le(e%ve|0,e/ve|0,t)}function le(e,t,r){return new se(e,t,r)}se.fromInt=pe,se.fromNumber=fe,se.fromBits=le;var he=Math.pow;function de(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return me;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return de(e.substring(1),t,r).neg();for(var o=fe(he(r,8)),i=me,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+a),r);if(a<8){var c=fe(he(r,a));i=i.mul(c).add(fe(u))}else i=(i=i.mul(o)).add(fe(u))}return i.unsigned=t,i}function ye(e,t){return"number"==typeof e?fe(e,t):"string"==typeof e?de(e,t):le(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}se.fromString=de,se.fromValue=ye;var ve=4294967296,_e=ve*ve,Se=_e/2,Ee=pe(1<<24),me=pe(0);se.ZERO=me;var we=pe(0,!0);se.UZERO=we;var ge=pe(1);se.ONE=ge;var Oe=pe(1,!0);se.UONE=Oe;var Te=pe(-1);se.NEG_ONE=Te;var Ie=le(-1,2147483647,!1);se.MAX_VALUE=Ie;var Re=le(-1,-1,!0);se.MAX_UNSIGNED_VALUE=Re;var be=le(0,-2147483648,!1);se.MIN_VALUE=be;var Ce=se.prototype;Ce.toInt=function(){return this.unsigned?this.low>>>0:this.low},Ce.toNumber=function(){return this.unsigned?(this.high>>>0)*ve+(this.low>>>0):this.high*ve+(this.low>>>0)},Ce.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(be)){var t=fe(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=fe(he(e,6),this.unsigned),i=this,s="";;){var a=i.div(o),u=(i.sub(a.mul(o)).toInt()>>>0).toString(e);if((i=a).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},Ce.getHighBits=function(){return this.high},Ce.getHighBitsUnsigned=function(){return this.high>>>0},Ce.getLowBits=function(){return this.low},Ce.getLowBitsUnsigned=function(){return this.low>>>0},Ce.getNumBitsAbs=function(){if(this.isNegative())return this.eq(be)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},Ce.isZero=function(){return 0===this.high&&0===this.low},Ce.eqz=Ce.isZero,Ce.isNegative=function(){return!this.unsigned&&this.high<0},Ce.isPositive=function(){return this.unsigned||this.high>=0},Ce.isOdd=function(){return 1==(1&this.low)},Ce.isEven=function(){return 0==(1&this.low)},Ce.equals=function(e){return ae(e)||(e=ye(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},Ce.eq=Ce.equals,Ce.notEquals=function(e){return!this.eq(e)},Ce.neq=Ce.notEquals,Ce.ne=Ce.notEquals,Ce.lessThan=function(e){return this.comp(e)<0},Ce.lt=Ce.lessThan,Ce.lessThanOrEqual=function(e){return this.comp(e)<=0},Ce.lte=Ce.lessThanOrEqual,Ce.le=Ce.lessThanOrEqual,Ce.greaterThan=function(e){return this.comp(e)>0},Ce.gt=Ce.greaterThan,Ce.greaterThanOrEqual=function(e){return this.comp(e)>=0},Ce.gte=Ce.greaterThanOrEqual,Ce.ge=Ce.greaterThanOrEqual,Ce.compare=function(e){if(ae(e)||(e=ye(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},Ce.comp=Ce.compare,Ce.negate=function(){return!this.unsigned&&this.eq(be)?be:this.not().add(ge)},Ce.neg=Ce.negate,Ce.add=function(e){ae(e)||(e=ye(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,a=e.low>>>16,u=0,c=0,p=0,f=0;return p+=(f+=o+(65535&e.low))>>>16,c+=(p+=n+a)>>>16,u+=(c+=r+s)>>>16,u+=t+i,le((p&=65535)<<16|(f&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},Ce.subtract=function(e){return ae(e)||(e=ye(e)),this.add(e.neg())},Ce.sub=Ce.subtract,Ce.multiply=function(e){if(this.isZero())return me;if(ae(e)||(e=ye(e)),ie)return le(ie.mul(this.low,this.high,e.low,e.high),ie.get_high(),this.unsigned);if(e.isZero())return me;if(this.eq(be))return e.isOdd()?be:me;if(e.eq(be))return this.isOdd()?be:me;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Ee)&&e.lt(Ee))return fe(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,a=e.low>>>16,u=65535&e.low,c=0,p=0,f=0,l=0;return f+=(l+=o*u)>>>16,p+=(f+=n*u)>>>16,f&=65535,p+=(f+=o*a)>>>16,c+=(p+=r*u)>>>16,p&=65535,c+=(p+=n*a)>>>16,p&=65535,c+=(p+=o*s)>>>16,c+=t*u+r*a+n*s+o*i,le((f&=65535)<<16|(l&=65535),(c&=65535)<<16|(p&=65535),this.unsigned)},Ce.mul=Ce.multiply,Ce.divide=function(e){if(ae(e)||(e=ye(e)),e.isZero())throw Error("division by zero");var t,r,n;if(ie)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?le((this.unsigned?ie.div_u:ie.div_s)(this.low,this.high,e.low,e.high),ie.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?we:me;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return we;if(e.gt(this.shru(1)))return Oe;n=we}else{if(this.eq(be))return e.eq(ge)||e.eq(Te)?be:e.eq(be)?ge:(t=this.shr(1).div(e).shl(1)).eq(me)?e.isNegative()?ge:Te:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(be))return this.unsigned?we:me;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=me}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(t)/Math.LN2),i=o<=48?1:he(2,o-48),s=fe(t),a=s.mul(e);a.isNegative()||a.gt(r);)a=(s=fe(t-=i,this.unsigned)).mul(e);s.isZero()&&(s=ge),n=n.add(s),r=r.sub(a)}return n},Ce.div=Ce.divide,Ce.modulo=function(e){return ae(e)||(e=ye(e)),ie?le((this.unsigned?ie.rem_u:ie.rem_s)(this.low,this.high,e.low,e.high),ie.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},Ce.mod=Ce.modulo,Ce.rem=Ce.modulo,Ce.not=function(){return le(~this.low,~this.high,this.unsigned)},Ce.and=function(e){return ae(e)||(e=ye(e)),le(this.low&e.low,this.high&e.high,this.unsigned)},Ce.or=function(e){return ae(e)||(e=ye(e)),le(this.low|e.low,this.high|e.high,this.unsigned)},Ce.xor=function(e){return ae(e)||(e=ye(e)),le(this.low^e.low,this.high^e.high,this.unsigned)},Ce.shiftLeft=function(e){return ae(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):le(0,this.low<<e-32,this.unsigned)},Ce.shl=Ce.shiftLeft,Ce.shiftRight=function(e){return ae(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):le(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},Ce.shr=Ce.shiftRight,Ce.shiftRightUnsigned=function(e){if(ae(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?le(this.low>>>e|t<<32-e,t>>>e,this.unsigned):le(32===e?t:t>>>e-32,0,this.unsigned)},Ce.shru=Ce.shiftRightUnsigned,Ce.shr_u=Ce.shiftRightUnsigned,Ce.toSigned=function(){return this.unsigned?le(this.low,this.high,!1):this},Ce.toUnsigned=function(){return this.unsigned?this:le(this.low,this.high,!0)},Ce.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},Ce.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},Ce.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},se.fromBytes=function(e,t,r){return r?se.fromBytesLE(e,t):se.fromBytesBE(e,t)},se.fromBytesLE=function(e,t){return new se(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},se.fromBytesBE=function(e,t){return new se(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});var Ae=function(){function e(e){this.val=e}return e.fromString=function(t){return new e(oe.fromString(t,!1))},e.prototype.toString=function(){return this.val.toString(10)},e.prototype.equals=function(e){return e.val&&this.val.equals(e.val)},e}();Pe.ConversationId=Ae,Pe.ONEWAY_CID=new Ae(oe.fromNumber(0));var Ne={},Me=Ne={version:"2.6.5"};"number"==typeof __e&&(__e=Me);var Le=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},De=F({}),je=function(e){if(!De(e))throw TypeError(e+" is not an object!");return e},Ue=!H({})&&!W({})(function(){return 7!=Object.defineProperty(V({})("div"),"a",{get:function(){return 7}}).a}),xe=x({}),Be={},ke=j({})("meta"),qe=F({}),Ve=Y({}),Fe=k({}).f,Ge=0,He=Object.isExtensible||function(){return!0},We=!W({})(function(){return He(Object.preventExtensions({}))}),Ye=function(e){Fe(e,ke,{value:{i:"O"+ ++Ge,w:{}}})},ze=Be={KEY:ke,NEED:!1,fastKey:function(e,t){if(!qe(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Ve(e,ke)){if(!He(e))return"F";if(!t)return"E";Ye(e)}return e[ke].i},getWeak:function(e,t){if(!Ve(e,ke)){if(!He(e))return!0;if(!t)return!1;Ye(e)}return e[ke].w},onFreeze:function(e){return We&&ze.NEED&&He(e)&&!Ve(e,ke)&&Ye(e),e}},Je={},$e=z({}),Ke=$e["__core-js_shared__"]||($e["__core-js_shared__"]={});(Je=function(e,t){return Ke[e]||(Ke[e]=void 0!==t?t:{})})("versions",[]).push({version:Ne.version,mode:D({})?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"});var Qe=k({}).f,Xe=Y({}),Ze=L({})("toStringTag"),et=function(e,t,r){e&&!Xe(e=r?e:e.prototype,Ze)&&Qe(e,Ze,{configurable:!0,value:t})},tt={};tt.f=L({});var rt=z({}),nt=D({}),ot=k({}).f,it=function(e){var t=Ne.Symbol||(Ne.Symbol=nt?{}:rt.Symbol||{});"_"==e.charAt(0)||e in t||ot(t,e,{value:tt.f(e)})},st=M({}),at=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==st(e)?e.split(""):Object(e)},ut=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},ct=function(e){return at(ut(e))},pt=Je("keys"),ft=j({}),lt=function(e){return pt[e]||(pt[e]=ft(e))},ht=Y({}),dt=C({})(!1),yt=lt("IE_PROTO"),vt=function(e,t){var r,n=ct(e),o=0,i=[];for(r in n)r!=yt&&ht(n,r)&&i.push(r);for(;t.length>o;)ht(n,r=t[o++])&&(~dt(i,r)||i.push(r));return i},_t="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),St=Object.keys||function(e){return vt(e,_t)},Et=b({}),mt=R({}),wt=M({}),gt=Array.isArray||function(e){return"Array"==wt(e)},Ot=k({}),Tt=H({})?Object.defineProperties:function(e,t){je(e);for(var r,n=St(t),o=n.length,i=0;o>i;)Ot.f(e,r=n[i++],t[r]);return e},It=z({}),Rt=Y({}),bt=H({}),Ct=U({}),Pt=Be.KEY,At=W({}),Nt=j({}),Mt=L({}),Lt=F({}),Dt=q({}),jt=B({}),Ut=T({}),xt=g({}),Bt=w({}),kt=k({}),qt=Bt.f,Vt=kt.f,Ft=xt.f,Gt=It.Symbol,Ht=It.JSON,Wt=Ht&&Ht.stringify,Yt=Mt("_hidden"),zt=Mt("toPrimitive"),Jt={}.propertyIsEnumerable,$t=Je("symbol-registry"),Kt=Je("symbols"),Qt=Je("op-symbols"),Xt=Object.prototype,Zt="function"==typeof Gt,er=It.QObject,tr=!er||!er.prototype||!er.prototype.findChild,rr=bt&&At(function(){return 7!=Ut(Vt({},"a",{get:function(){return Vt(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=qt(Xt,t);n&&delete Xt[t],Vt(e,t,r),n&&e!==Xt&&Vt(Xt,t,n)}:Vt,nr=function(e){var t=Kt[e]=Ut(Gt.prototype);return t._k=e,t},or=Zt&&"symbol"==typeof Gt.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof Gt},ir=function(e,t,r){return e===Xt&&ir(Qt,t,r),je(e),t=Dt(t,!0),je(r),Rt(Kt,t)?(r.enumerable?(Rt(e,Yt)&&e[Yt][t]&&(e[Yt][t]=!1),r=Ut(r,{enumerable:jt(0,!1)})):(Rt(e,Yt)||Vt(e,Yt,jt(1,{})),e[Yt][t]=!0),rr(e,t,r)):Vt(e,t,r)},sr=function(e,t){je(e);for(var r,n=function(e){var t=St(e),r=Et.f;if(r)for(var n,o=r(e),i=mt.f,s=0;o.length>s;)i.call(e,n=o[s++])&&t.push(n);return t}(t=ct(t)),o=0,i=n.length;i>o;)ir(e,r=n[o++],t[r]);return e},ar=function(e){var t=Jt.call(this,e=Dt(e,!0));return!(this===Xt&&Rt(Kt,e)&&!Rt(Qt,e))&&(!(t||!Rt(this,e)||!Rt(Kt,e)||Rt(this,Yt)&&this[Yt][e])||t)},ur=function(e,t){if(e=ct(e),t=Dt(t,!0),e!==Xt||!Rt(Kt,t)||Rt(Qt,t)){var r=qt(e,t);return!r||!Rt(Kt,t)||Rt(e,Yt)&&e[Yt][t]||(r.enumerable=!0),r}},cr=function(e){for(var t,r=Ft(ct(e)),n=[],o=0;r.length>o;)Rt(Kt,t=r[o++])||t==Yt||t==Pt||n.push(t);return n},pr=function(e){for(var t,r=e===Xt,n=Ft(r?Qt:ct(e)),o=[],i=0;n.length>i;)!Rt(Kt,t=n[i++])||r&&!Rt(Xt,t)||o.push(Kt[t]);return o};Zt||(xe((Gt=function(){if(this instanceof Gt)throw TypeError("Symbol is not a constructor!");var e=Nt(arguments.length>0?arguments[0]:void 0),t=function(r){this===Xt&&t.call(Qt,r),Rt(this,Yt)&&Rt(this[Yt],e)&&(this[Yt][e]=!1),rr(this,e,jt(1,r))};return bt&&tr&&rr(Xt,e,{configurable:!0,set:t}),nr(e)}).prototype,"toString",function(){return this._k}),Bt.f=ur,kt.f=ir,O({}).f=xt.f=cr,R({}).f=ar,b({}).f=pr,bt&&!D({})&&xe(Xt,"propertyIsEnumerable",ar,!0),tt.f=function(e){return nr(Mt(e))}),Ct(Ct.G+Ct.W+Ct.F*!Zt,{Symbol:Gt});for(var fr="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),lr=0;fr.length>lr;)Mt(fr[lr++]);for(var hr=St(Mt.store),dr=0;hr.length>dr;)it(hr[dr++]);Ct(Ct.S+Ct.F*!Zt,"Symbol",{for:function(e){return Rt($t,e+="")?$t[e]:$t[e]=Gt(e)},keyFor:function(e){if(!or(e))throw TypeError(e+" is not a symbol!");for(var t in $t)if($t[t]===e)return t},useSetter:function(){tr=!0},useSimple:function(){tr=!1}}),Ct(Ct.S+Ct.F*!Zt,"Object",{create:function(e,t){return void 0===t?Ut(e):sr(Ut(e),t)},defineProperty:ir,defineProperties:sr,getOwnPropertyDescriptor:ur,getOwnPropertyNames:cr,getOwnPropertySymbols:pr}),Ht&&Ct(Ct.S+Ct.F*(!Zt||At(function(){var e=Gt();return"[null]"!=Wt([e])||"{}"!=Wt({a:e})||"{}"!=Wt(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],o=1;arguments.length>o;)n.push(arguments[o++]);if(r=t=n[1],(Lt(t)||void 0!==e)&&!or(e))return gt(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!or(t))return t}),n[1]=t,Wt.apply(Ht,n)}}),Gt.prototype[zt]||x({})(Gt.prototype,zt,Gt.prototype.valueOf),et(Gt,"Symbol"),et(Math,"Math",!0),et(It.JSON,"JSON",!0);var yr=U({});yr(yr.S,"Object",{create:T({})});var vr=U({});vr(vr.S+vr.F*!H({}),"Object",{defineProperty:k({}).f});var _r=U({});_r(_r.S+_r.F*!H({}),"Object",{defineProperties:Tt});var Sr=U({}),Er=W({}),mr=function(e,t){var r=(Ne.Object||{})[e]||Object[e],n={};n[e]=t(r),Sr(Sr.S+Sr.F*Er(function(){r(1)}),"Object",n)},wr=w({}).f;mr("getOwnPropertyDescriptor",function(){return function(e,t){return wr(ct(e),t)}});var gr=m({}),Or=E({});mr("getPrototypeOf",function(){return function(e){return Or(gr(e))}});var Tr=m({});mr("keys",function(){return function(e){return St(Tr(e))}});mr("getOwnPropertyNames",function(){return g({}).f});var Ir=F({}),Rr=Be.onFreeze;mr("freeze",function(e){return function(t){return e&&Ir(t)?e(Rr(t)):t}});var br=F({}),Cr=Be.onFreeze;mr("seal",function(e){return function(t){return e&&br(t)?e(Cr(t)):t}});var Pr=F({}),Ar=Be.onFreeze;mr("preventExtensions",function(e){return function(t){return e&&Pr(t)?e(Ar(t)):t}});var Nr=F({});mr("isFrozen",function(e){return function(t){return!Nr(t)||!!e&&e(t)}});var Mr=F({});mr("isSealed",function(e){return function(t){return!Mr(t)||!!e&&e(t)}});var Lr=F({});mr("isExtensible",function(e){return function(t){return!!Lr(t)&&(!e||e(t))}});var Dr=b({}),jr=R({}),Ur=m({}),xr=Object.assign,Br=!xr||W({})(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=xr({},e)[r]||Object.keys(xr({},t)).join("")!=n})?function(e,t){for(var r=Ur(e),n=arguments.length,o=1,i=Dr.f,s=jr.f;n>o;)for(var a,u=at(arguments[o++]),c=i?St(u).concat(i(u)):St(u),p=c.length,f=0;p>f;)s.call(u,a=c[f++])&&(r[a]=u[a]);return r}:xr,kr=U({});kr(kr.S+kr.F,"Object",{assign:Br});var qr=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},Vr=U({});Vr(Vr.S,"Object",{is:qr});var Fr=F({}),Gr=function(e,t){if(je(e),!Fr(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},Hr={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=G({})(Function.call,w({}).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return Gr(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:Gr},Wr=U({});Wr(Wr.S,"Object",{setPrototypeOf:Hr.set});var Yr={},zr=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)},Jr=F({}),$r=[].slice,Kr={},Qr=Function.bind||function(e){var t=Le(this),r=$r.call(arguments,1),n=function(){var o=r.concat($r.call(arguments));return this instanceof n?function(e,t,r){if(!(t in Kr)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";Kr[t]=Function("F,a","return new F("+n.join(",")+")")}return Kr[t](e,r)}(t,o.length,o):zr(t,o,e)};return Jr(t.prototype)&&(n.prototype=t.prototype),n},Xr=U({});Xr(Xr.P,"Function",{bind:Qr});var Zr=F({}),en=E({}),tn=L({})("hasInstance"),rn=Function.prototype;tn in rn||k({}).f(rn,tn,{value:function(e){if("function"!=typeof this||!Zr(e))return!1;if(!Zr(this.prototype))return e instanceof this;for(;e=en(e);)if(this.prototype===e)return!0;return!1}});var nn="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",on=U({}),sn=W({}),an="["+nn+"]",un=RegExp("^"+an+an+"*"),cn=RegExp(an+an+"*$"),pn=function(e,t,r){var n={},o=sn(function(){return!!nn[e]()||"​"!="​"[e]()}),i=n[e]=o?t(fn):nn[e];r&&(n[r]=i),on(on.P+on.F*o,"String",n)},fn=pn.trim=function(e,t){return e=String(ut(e)),1&t&&(e=e.replace(un,"")),2&t&&(e=e.replace(cn,"")),e},ln=pn,hn=z({}).parseInt,dn=ln.trim,yn=/^[-+]?0[xX]/,vn=8!==hn(nn+"08")||22!==hn(nn+"0x16")?function(e,t){var r=dn(String(e),3);return hn(r,t>>>0||(yn.test(r)?16:10))}:hn,_n=U({});_n(_n.G+_n.F*(parseInt!=vn),{parseInt:vn});var Sn=z({}).parseFloat,En=ln.trim,mn=1/Sn(nn+"-0")!=-1/0?function(e){var t=En(String(e),3),r=Sn(t);return 0===r&&"-"==t.charAt(0)?-0:r}:Sn,wn=U({});wn(wn.G+wn.F*(parseFloat!=mn),{parseFloat:mn});var gn=M({}),On=function(e,t){if("number"!=typeof e&&"Number"!=gn(e))throw TypeError(t);return+e},Tn=N({}),In=function(e){var t=String(ut(this)),r="",n=Tn(e);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},Rn=U({}),bn=N({}),Cn=1..toFixed,Pn=Math.floor,An=[0,0,0,0,0,0],Nn="Number.toFixed: incorrect invocation!",Mn=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*An[r],An[r]=n%1e7,n=Pn(n/1e7)},Ln=function(e){for(var t=6,r=0;--t>=0;)r+=An[t],An[t]=Pn(r/e),r=r%e*1e7},Dn=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==An[e]){var r=String(An[e]);t=""===t?r:t+In.call("0",7-r.length)+r}return t},jn=function(e,t,r){return 0===t?r:t%2==1?jn(e,t-1,r*e):jn(e*e,t/2,r)};Rn(Rn.P+Rn.F*(!!Cn&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!W({})(function(){Cn.call({})})),"Number",{toFixed:function(e){var t,r,n,o,i=On(this,Nn),s=bn(e),a="",u="0";if(s<0||s>20)throw RangeError(Nn);if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return String(i);if(i<0&&(a="-",i=-i),i>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(i*jn(2,69,1))-69)<0?i*jn(2,-t,1):i/jn(2,t,1),r*=4503599627370496,(t=52-t)>0){for(Mn(0,r),n=s;n>=7;)Mn(1e7,0),n-=7;for(Mn(jn(10,n,1),0),n=t-1;n>=23;)Ln(1<<23),n-=23;Ln(1<<n),Mn(1,1),Ln(2),u=Dn()}else Mn(0,r),Mn(1<<-t,0),u=Dn()+In.call("0",s);return u=s>0?a+((o=u.length)<=s?"0."+In.call("0",s-o)+u:u.slice(0,o-s)+"."+u.slice(o-s)):a+u}});var Un=U({}),xn=W({}),Bn=1..toPrecision;Un(Un.P+Un.F*(xn(function(){return"1"!==Bn.call(1,void 0)})||!xn(function(){Bn.call({})})),"Number",{toPrecision:function(e){var t=On(this,"Number#toPrecision: incorrect invocation!");return void 0===e?Bn.call(t):Bn.call(t,e)}});var kn=U({});kn(kn.S,"Number",{EPSILON:Math.pow(2,-52)});var qn=U({}),Vn=z({}).isFinite;qn(qn.S,"Number",{isFinite:function(e){return"number"==typeof e&&Vn(e)}});var Fn=F({}),Gn=Math.floor,Hn=function(e){return!Fn(e)&&isFinite(e)&&Gn(e)===e},Wn=U({});Wn(Wn.S,"Number",{isInteger:Hn});var Yn=U({});Yn(Yn.S,"Number",{isNaN:function(e){return e!=e}});var zn=U({}),Jn=Math.abs;zn(zn.S,"Number",{isSafeInteger:function(e){return Hn(e)&&Jn(e)<=9007199254740991}});var $n=U({});$n($n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991});var Kn=U({});Kn(Kn.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991});var Qn=U({});Qn(Qn.S+Qn.F*(Number.parseFloat!=mn),"Number",{parseFloat:mn});var Xn=U({});Xn(Xn.S+Xn.F*(Number.parseInt!=vn),"Number",{parseInt:vn});var Zn=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)},eo=U({}),to=Math.sqrt,ro=Math.acosh;eo(eo.S+eo.F*!(ro&&710==Math.floor(ro(Number.MAX_VALUE))&&ro(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:Zn(e-1+to(e-1)*to(e+1))}});var no=U({}),oo=Math.asinh;no(no.S+no.F*!(oo&&1/oo(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}});var io=U({}),so=Math.atanh;io(io.S+io.F*!(so&&1/so(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}});var ao=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1},uo=U({});uo(uo.S,"Math",{cbrt:function(e){return ao(e=+e)*Math.pow(Math.abs(e),1/3)}});var co=U({});co(co.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}});var po=U({}),fo=Math.exp;po(po.S,"Math",{cosh:function(e){return(fo(e=+e)+fo(-e))/2}});var lo=Math.expm1,ho=!lo||lo(10)>22025.465794806718||lo(10)<22025.465794806718||-2e-17!=lo(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:lo,yo=U({});yo(yo.S+yo.F*(ho!=Math.expm1),"Math",{expm1:ho});var vo=Math.pow,_o=vo(2,-52),So=vo(2,-23),Eo=vo(2,127)*(2-So),mo=vo(2,-126),wo=Math.fround||function(e){var t,r,n=Math.abs(e),o=ao(e);return n<mo?o*(n/mo/So+1/_o-1/_o)*mo*So:(r=(t=(1+So/_o)*n)-(t-n))>Eo||r!=r?o*(1/0):o*r},go=U({});go(go.S,"Math",{fround:wo});var Oo=U({}),To=Math.abs;Oo(Oo.S,"Math",{hypot:function(e,t){for(var r,n,o=0,i=0,s=arguments.length,a=0;i<s;)a<(r=To(arguments[i++]))?(o=o*(n=a/r)*n+1,a=r):o+=r>0?(n=r/a)*n:r;return a===1/0?1/0:a*Math.sqrt(o)}});var Io=U({}),Ro=Math.imul;Io(Io.S+Io.F*W({})(function(){return-5!=Ro(4294967295,5)||2!=Ro.length}),"Math",{imul:function(e,t){var r=+e,n=+t,o=65535&r,i=65535&n;return 0|o*i+((65535&r>>>16)*i+o*(65535&n>>>16)<<16>>>0)}});var bo=U({});bo(bo.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}});var Co=U({});Co(Co.S,"Math",{log1p:Zn});var Po=U({});Po(Po.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}});var Ao=U({});Ao(Ao.S,"Math",{sign:ao});var No=U({}),Mo=Math.exp;No(No.S+No.F*W({})(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(ho(e)-ho(-e))/2:(Mo(e-1)-Mo(-e-1))*(Math.E/2)}});var Lo=U({}),Do=Math.exp;Lo(Lo.S,"Math",{tanh:function(e){var t=ho(e=+e),r=ho(-e);return t==1/0?1:r==1/0?-1:(t-r)/(Do(e)+Do(-e))}});var jo=U({});jo(jo.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}});var Uo=U({}),xo=P({}),Bo=String.fromCharCode,ko=String.fromCodePoint;Uo(Uo.S+Uo.F*(!!ko&&1!=ko.length),"String",{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,o=0;n>o;){if(t=+arguments[o++],xo(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?Bo(t):Bo(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}});var qo=U({}),Vo=A({});qo(qo.S,"String",{raw:function(e){for(var t=ct(e.raw),r=Vo(t.length),n=arguments.length,o=[],i=0;r>i;)o.push(String(t[i++])),i<n&&o.push(String(arguments[i]));return o.join("")}});ln("trim",function(e){return function(){return e(this,3)}});var Fo=N({}),Go=function(e){return function(t,r){var n,o,i=String(ut(t)),s=Fo(r),a=i.length;return s<0||s>=a?e?"":void 0:(n=i.charCodeAt(s))<55296||n>56319||s+1===a||(o=i.charCodeAt(s+1))<56320||o>57343?e?i.charAt(s):n:e?i.slice(s,s+2):o-56320+(n-55296<<10)+65536}},Ho=T({}),Wo=B({}),Yo={};x({})(Yo,L({})("iterator"),function(){return this});var zo=function(e,t,r){e.prototype=Ho(Yo,{next:Wo(1,r)}),et(e,t+" Iterator")},Jo=D({}),$o=U({}),Ko=x({}),Qo=S({}),Xo=E({}),Zo=L({})("iterator"),ei=!([].keys&&"next"in[].keys()),ti=function(){return this},ri=function(e,t,r,n,o,i,s){zo(r,t,n);var a,u,c,p=function(e){if(!ei&&e in d)return d[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},f=t+" Iterator",l="values"==o,h=!1,d=e.prototype,y=d[Zo]||d["@@iterator"]||o&&d[o],v=y||p(o),_=o?l?p("entries"):v:void 0,S="Array"==t&&d.entries||y;if(S&&(c=Xo(S.call(new e)))!==Object.prototype&&c.next&&(et(c,f,!0),Jo||"function"==typeof c[Zo]||Ko(c,Zo,ti)),l&&y&&"values"!==y.name&&(h=!0,v=function(){return y.call(this)}),Jo&&!s||!ei&&!h&&d[Zo]||Ko(d,Zo,v),Qo[t]=v,Qo[f]=ti,o)if(a={values:l?v:p("values"),keys:i?v:p("keys"),entries:_},s)for(u in a)u in d||xe(d,u,a[u]);else $o($o.P+$o.F*(ei||h),t,a);return a},ni=Go(!0);ri(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=ni(t,r),this._i+=e.length,{value:e,done:!1})});var oi=U({}),ii=Go(!1);oi(oi.P,"String",{codePointAt:function(e){return ii(this,e)}});var si=F({}),ai=M({}),ui=L({})("match"),ci=function(e){var t;return si(e)&&(void 0!==(t=e[ui])?!!t:"RegExp"==ai(e))},pi=function(e,t,r){if(ci(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(ut(e))},fi=L({})("match"),li=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[fi]=!1,!"/./"[e](t)}catch(e){}}return!0},hi=U({}),di=A({}),yi="".endsWith;hi(hi.P+hi.F*li("endsWith"),"String",{endsWith:function(e){var t=pi(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=di(t.length),o=void 0===r?n:Math.min(di(r),n),i=String(e);return yi?yi.call(t,i,o):t.slice(o-i.length,o)===i}});var vi=U({});vi(vi.P+vi.F*li("includes"),"String",{includes:function(e){return!!~pi(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}});var _i=U({});_i(_i.P,"String",{repeat:In});var Si=U({}),Ei=A({}),mi="".startsWith;Si(Si.P+Si.F*li("startsWith"),"String",{startsWith:function(e){var t=pi(this,e,"startsWith"),r=Ei(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return mi?mi.call(t,n,r):t.slice(r,r+n.length)===n}});var wi=U({}),gi=W({}),Oi=/"/g,Ti=function(e,t,r,n){var o=String(ut(e)),i="<"+t;return""!==r&&(i+=" "+r+'="'+String(n).replace(Oi,"&quot;")+'"'),i+">"+o+"</"+t+">"},Ii=function(e,t){var r={};r[e]=t(Ti),wi(wi.P+wi.F*gi(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",r)};Ii("anchor",function(e){return function(t){return e(this,"a","name",t)}});Ii("big",function(e){return function(){return e(this,"big","","")}});Ii("blink",function(e){return function(){return e(this,"blink","","")}});Ii("bold",function(e){return function(){return e(this,"b","","")}});Ii("fixed",function(e){return function(){return e(this,"tt","","")}});Ii("fontcolor",function(e){return function(t){return e(this,"font","color",t)}});Ii("fontsize",function(e){return function(t){return e(this,"font","size",t)}});Ii("italics",function(e){return function(){return e(this,"i","","")}});Ii("link",function(e){return function(t){return e(this,"a","href",t)}});Ii("small",function(e){return function(){return e(this,"small","","")}});Ii("strike",function(e){return function(){return e(this,"strike","","")}});Ii("sub",function(e){return function(){return e(this,"sub","","")}});Ii("sup",function(e){return function(){return e(this,"sup","","")}});var Ri=U({});Ri(Ri.S,"Date",{now:function(){return(new Date).getTime()}});var bi=W({}),Ci=Date.prototype.getTime,Pi=Date.prototype.toISOString,Ai=function(e){return e>9?e:"0"+e},Ni=bi(function(){return"0385-07-25T07:06:39.999Z"!=Pi.call(new Date(-5e13-1))})||!bi(function(){Pi.call(new Date(NaN))})?function(){if(!isFinite(Ci.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+Ai(e.getUTCMonth()+1)+"-"+Ai(e.getUTCDate())+"T"+Ai(e.getUTCHours())+":"+Ai(e.getUTCMinutes())+":"+Ai(e.getUTCSeconds())+"."+(r>99?r:"0"+Ai(r))+"Z"}:Pi,Mi=U({}),Li=m({}),Di=q({}),ji=_({});Mi(Mi.P+Mi.F*W({})(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=Li(this),r=Di(t);return"number"!=typeof r||isFinite(r)?"toISOString"in t||"Date"!=ji(t)?t.toISOString():Ni.call(t):null}});var Ui=U({});Ui(Ui.P+Ui.F*(Date.prototype.toISOString!==Ni),"Date",{toISOString:Ni});var xi=U({});xi(xi.S,"Array",{isArray:gt});var Bi=function(e,t,r,n){try{return n?t(je(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&je(o.call(e)),t}},ki=k({}),qi=B({}),Vi=function(e,t,r){t in e?ki.f(e,t,qi(0,r)):e[t]=r},Fi=G({}),Gi=U({}),Hi=m({}),Wi=v({}),Yi=A({}),zi=y({});Gi(Gi.S+Gi.F*!d({})(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,n,o,i=Hi(e),s="function"==typeof this?this:Array,a=arguments.length,u=a>1?arguments[1]:void 0,c=void 0!==u,p=0,f=zi(i);if(c&&(u=Fi(u,a>2?arguments[2]:void 0,2)),null==f||s==Array&&Wi(f))for(r=new s(t=Yi(i.length));t>p;p++)Vi(r,p,c?u(i[p],p):i[p]);else for(o=f.call(i),r=new s;!(n=o.next()).done;p++)Vi(r,p,c?Bi(o,u,[n.value,p],!0):n.value);return r.length=p,r}});var Ji=U({});Ji(Ji.S+Ji.F*W({})(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)Vi(r,e,arguments[e++]);return r.length=t,r}});var $i=W({}),Ki=function(e,t){return!!e&&$i(function(){t?e.call(null,function(){},1):e.call(null)})},Qi=U({}),Xi=[].join;Qi(Qi.P+Qi.F*(at!=Object||!Ki(Xi)),"Array",{join:function(e){return Xi.call(ct(this),void 0===e?",":e)}});var Zi=U({}),es=I({}),ts=M({}),rs=P({}),ns=A({}),os=[].slice;Zi(Zi.P+Zi.F*W({})(function(){es&&os.call(es)}),"Array",{slice:function(e,t){var r=ns(this.length),n=ts(this);if(t=void 0===t?r:t,"Array"==n)return os.call(this,e,t);for(var o=rs(e,r),i=rs(t,r),s=ns(i-o),a=new Array(s),u=0;u<s;u++)a[u]="String"==n?this.charAt(o+u):this[o+u];return a}});var is=U({}),ss=m({}),as=W({}),us=[].sort,cs=[1,2,3];is(is.P+is.F*(as(function(){cs.sort(void 0)})||!as(function(){cs.sort(null)})||!Ki(us)),"Array",{sort:function(e){return void 0===e?us.call(ss(this)):us.call(ss(this),Le(e))}});var ps=F({}),fs=L({})("species"),ls=function(e,t){return new(function(e){var t;return gt(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!gt(t.prototype)||(t=void 0),ps(t)&&null===(t=t[fs])&&(t=void 0)),void 0===t?Array:t}(e))(t)},hs=U({}),ds=h({})(0),ys=Ki([].forEach,!0);hs(hs.P+hs.F*!ys,"Array",{forEach:function(e){return ds(this,e,arguments[1])}});var vs=U({}),_s=h({})(1);vs(vs.P+vs.F*!Ki([].map,!0),"Array",{map:function(e){return _s(this,e,arguments[1])}});var Ss=U({}),Es=h({})(2);Ss(Ss.P+Ss.F*!Ki([].filter,!0),"Array",{filter:function(e){return Es(this,e,arguments[1])}});var ms=U({}),ws=h({})(3);ms(ms.P+ms.F*!Ki([].some,!0),"Array",{some:function(e){return ws(this,e,arguments[1])}});var gs=U({}),Os=h({})(4);gs(gs.P+gs.F*!Ki([].every,!0),"Array",{every:function(e){return Os(this,e,arguments[1])}});var Ts=m({}),Is=A({}),Rs=function(e,t,r,n,o){Le(t);var i=Ts(e),s=at(i),a=Is(i.length),u=o?a-1:0,c=o?-1:1;if(r<2)for(;;){if(u in s){n=s[u],u+=c;break}if(u+=c,o?u<0:a<=u)throw TypeError("Reduce of empty array with no initial value")}for(;o?u>=0:a>u;u+=c)u in s&&(n=t(n,s[u],u,i));return n},bs=U({});bs(bs.P+bs.F*!Ki([].reduce,!0),"Array",{reduce:function(e){return Rs(this,e,arguments.length,arguments[1],!1)}});var Cs=U({});Cs(Cs.P+Cs.F*!Ki([].reduceRight,!0),"Array",{reduceRight:function(e){return Rs(this,e,arguments.length,arguments[1],!0)}});var Ps=U({}),As=C({})(!1),Ns=[].indexOf,Ms=!!Ns&&1/[1].indexOf(1,-0)<0;Ps(Ps.P+Ps.F*(Ms||!Ki(Ns)),"Array",{indexOf:function(e){return Ms?Ns.apply(this,arguments)||0:As(this,e,arguments[1])}});var Ls=U({}),Ds=N({}),js=A({}),Us=[].lastIndexOf,xs=!!Us&&1/[1].lastIndexOf(1,-0)<0;Ls(Ls.P+Ls.F*(xs||!Ki(Us)),"Array",{lastIndexOf:function(e){if(xs)return Us.apply(this,arguments)||0;var t=ct(this),r=js(t.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,Ds(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}});var Bs=function(){},ks=U({});ks(ks.P,"Array",{copyWithin:l({})}),Bs("copyWithin");var qs=U({});qs(qs.P,"Array",{fill:f({})}),Bs("fill");var Vs=U({}),Fs=h({})(5),Gs=!0;"find"in[]&&Array(1).find(function(){Gs=!1}),Vs(Vs.P+Vs.F*Gs,"Array",{find:function(e){return Fs(this,e,arguments.length>1?arguments[1]:void 0)}}),Bs("find");var Hs=U({}),Ws=h({})(6),Ys=!0;"findIndex"in[]&&Array(1).findIndex(function(){Ys=!1}),Hs(Hs.P+Hs.F*Ys,"Array",{findIndex:function(e){return Ws(this,e,arguments.length>1?arguments[1]:void 0)}}),Bs("findIndex");p({})("Array");var zs=function(e,t){return{value:t,done:!!e}};p({})("RegExp");var Js,$s={},Ks=G({}),Qs=v({}),Xs=A({}),Zs=y({}),ea={},ta={};(Js=$s=function(e,t,r,n,o){var i,s,a,u,c=o?function(){return e}:Zs(e),p=Ks(r,n,t?2:1),f=0;if("function"!=typeof c)throw TypeError(e+" is not iterable!");if(Qs(c)){for(i=Xs(e.length);i>f;f++)if((u=t?p(je(s=e[f])[0],s[1]):p(e[f]))===ea||u===ta)return u}else for(a=c.call(e);!(s=a.next()).done;)if((u=Bi(a,p,s.value,t))===ea||u===ta)return u}).BREAK=ea,Js.RETURN=ta;var ra,na,oa,ia=G({}),sa=I({}),aa=V({}),ua=z({}),ca=ua.process,pa=ua.setImmediate,fa=ua.clearImmediate,la=ua.MessageChannel,ha=ua.Dispatch,da=0,ya={},va=function(){var e=+this;if(ya.hasOwnProperty(e)){var t=ya[e];delete ya[e],t()}},_a=function(e){va.call(e.data)};pa&&fa||(pa=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return ya[++da]=function(){zr("function"==typeof e?e:Function(e),t)},ra(da),da},fa=function(e){delete ya[e]},"process"==M({})(ca)?ra=function(e){ca.nextTick(ia(va,e,1))}:ha&&ha.now?ra=function(e){ha.now(ia(va,e,1))}:la?(oa=(na=new la).port2,na.port1.onmessage=_a,ra=ia(oa.postMessage,oa,1)):ua.addEventListener&&"function"==typeof postMessage&&!ua.importScripts?(ra=function(e){ua.postMessage(e+"","*")},ua.addEventListener("message",_a,!1)):ra="onreadystatechange"in aa("script")?function(e){sa.appendChild(aa("script")).onreadystatechange=function(){sa.removeChild(this),va.call(e)}}:function(e){setTimeout(ia(va,e,1),0)});var Sa={set:pa,clear:fa},Ea=z({}),ma=Sa.set,wa=Ea.MutationObserver||Ea.WebKitMutationObserver,ga=Ea.process,Oa=Ea.Promise,Ta="process"==M({})(ga),Ia=function(){var e,t,r,n=function(){var n,o;for(Ta&&(n=ga.domain)&&n.exit();e;){o=e.fn,e=e.next;try{o()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(Ta)r=function(){ga.nextTick(n)};else if(!wa||Ea.navigator&&Ea.navigator.standalone)if(Oa&&Oa.resolve){var o=Oa.resolve(void 0);r=function(){o.then(n)}}else r=function(){ma.call(Ea,n)};else{var i=!0,s=document.createTextNode("");new wa(n).observe(s,{characterData:!0}),r=function(){s.data=i=!i}}return function(n){var o={fn:n,next:void 0};t&&(t.next=o),e||(e=o,r()),t=o}},Ra={};function ba(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=Le(t),this.reject=Le(r)}Ra.f=function(e){return new ba(e)};var Ca,Pa,Aa,Na,Ma=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},La=z({}).navigator,Da=La&&La.userAgent||"",ja=F({}),Ua=function(e,t){if(je(e),ja(t)&&t.constructor===e)return t;var r=Ra.f(e);return(0,r.resolve)(t),r.promise},xa=D({}),Ba=z({}),ka=G({}),qa=_({}),Va=U({}),Fa=F({}),Ga=u({}),Ha=a({}),Wa=Sa.set,Ya=Ia(),za=Ba.TypeError,Ja=Ba.process,$a=Ja&&Ja.versions,Ka=$a&&$a.v8||"",Qa=Ba.Promise,Xa="process"==qa(Ja),Za=function(){},eu=Pa=Ra.f,tu=!!function(){try{var e=Qa.resolve(1),t=(e.constructor={})[L({})("species")]=function(e){e(Za,Za)};return(Xa||"function"==typeof PromiseRejectionEvent)&&e.then(Za)instanceof t&&0!==Ka.indexOf("6.6")&&-1===Da.indexOf("Chrome/66")}catch(e){}}(),ru=function(e){var t;return!(!Fa(e)||"function"!=typeof(t=e.then))&&t},nu=function(e,t){if(!e._n){e._n=!0;var r=e._c;Ya(function(){for(var n=e._v,o=1==e._s,i=0,s=function(t){var r,i,s,a=o?t.ok:t.fail,u=t.resolve,c=t.reject,p=t.domain;try{a?(o||(2==e._h&&su(e),e._h=1),!0===a?r=n:(p&&p.enter(),r=a(n),p&&(p.exit(),s=!0)),r===t.promise?c(za("Promise-chain cycle")):(i=ru(r))?i.call(r,u,c):u(r)):c(n)}catch(e){p&&!s&&p.exit(),c(e)}};r.length>i;)s(r[i++]);e._c=[],e._n=!1,t&&!e._h&&ou(e)})}},ou=function(e){Wa.call(Ba,function(){var t,r,n,o=e._v,i=iu(e);if(i&&(t=Ma(function(){Xa?Ja.emit("unhandledRejection",o,e):(r=Ba.onunhandledrejection)?r({promise:e,reason:o}):(n=Ba.console)&&n.error&&n.error("Unhandled promise rejection",o)}),e._h=Xa||iu(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},iu=function(e){return 1!==e._h&&0===(e._a||e._c).length},su=function(e){Wa.call(Ba,function(){var t;Xa?Ja.emit("rejectionHandled",e):(t=Ba.onrejectionhandled)&&t({promise:e,reason:e._v})})},au=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),nu(t,!0))},uu=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw za("Promise can't be resolved itself");(t=ru(e))?Ya(function(){var n={_w:r,_d:!1};try{t.call(e,ka(uu,n,1),ka(au,n,1))}catch(e){au.call(n,e)}}):(r._v=e,r._s=1,nu(r,!1))}catch(e){au.call({_w:r,_d:!1},e)}}};tu||(Qa=function(e){Ga(this,Qa,"Promise","_h"),Le(e),Ca.call(this);try{e(ka(uu,this,1),ka(au,this,1))}catch(e){au.call(this,e)}},(Ca=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=s({})(Qa.prototype,{then:function(e,t){var r=eu(Ha(this,Qa));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=Xa?Ja.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&nu(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Aa=function(){var e=new Ca;this.promise=e,this.resolve=ka(uu,e,1),this.reject=ka(au,e,1)},Ra.f=eu=function(e){return e===Qa||e===Na?new Aa(e):Pa(e)}),Va(Va.G+Va.W+Va.F*!tu,{Promise:Qa}),et(Qa,"Promise"),p({})("Promise"),Na=Ne.Promise,Va(Va.S+Va.F*!tu,"Promise",{reject:function(e){var t=eu(this);return(0,t.reject)(e),t.promise}}),Va(Va.S+Va.F*(xa||!tu),"Promise",{resolve:function(e){return Ua(xa&&this===Na?Qa:this,e)}}),Va(Va.S+Va.F*!(tu&&d({})(function(e){Qa.all(e).catch(Za)})),"Promise",{all:function(e){var t=this,r=eu(t),n=r.resolve,o=r.reject,i=Ma(function(){var r=[],i=0,s=1;$s(e,!1,function(e){var a=i++,u=!1;r.push(void 0),s++,t.resolve(e).then(function(e){u||(u=!0,r[a]=e,--s||n(r))},o)}),--s||n(r)});return i.e&&o(i.v),r.promise},race:function(e){var t=this,r=eu(t),n=r.reject,o=Ma(function(){$s(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return o.e&&n(o.v),r.promise}});var cu=F({}),pu=function(e,t){if(!cu(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e},fu=k({}).f,lu=T({}),hu=s({}),du=G({}),yu=u({}),vu=p({}),_u=H({}),Su=Be.fastKey,Eu=_u?"_s":"size",mu=function(e,t){var r,n=Su(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r},wu={getConstructor:function(e,t,r,n){var o=e(function(e,i){yu(e,o,t,"_i"),e._t=t,e._i=lu(null),e._f=void 0,e._l=void 0,e[Eu]=0,null!=i&&$s(i,r,e[n],e)});return hu(o.prototype,{clear:function(){for(var e=pu(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[Eu]=0},delete:function(e){var r=pu(this,t),n=mu(r,e);if(n){var o=n.n,i=n.p;delete r._i[n.i],n.r=!0,i&&(i.n=o),o&&(o.p=i),r._f==n&&(r._f=o),r._l==n&&(r._l=i),r[Eu]--}return!!n},forEach:function(e){pu(this,t);for(var r,n=du(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!mu(pu(this,t),e)}}),_u&&fu(o.prototype,"size",{get:function(){return pu(this,t)[Eu]}}),o},def:function(e,t,r){var n,o,i=mu(e,t);return i?i.v=r:(e._l=i={i:o=Su(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=i),n&&(n.n=i),e[Eu]++,"F"!==o&&(e._i[o]=i)),e},getEntry:mu,setStrong:function(e,t,r){ri(e,t,function(e,r){this._t=pu(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?zs(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,zs(1))},r?"entries":"values",!r,!0),vu(t)}},gu=z({}),Ou=U({}),Tu=W({}),Iu=x({}),Ru=s({}),bu=u({}),Cu=F({}),Pu=k({}).f,Au=h({})(0),Nu=H({}),Mu=function(e,t,r,n,o,i){var s=gu[e],a=s,u=o?"set":"add",c=a&&a.prototype,p={};return Nu&&"function"==typeof a&&(i||c.forEach&&!Tu(function(){(new a).entries().next()}))?(a=t(function(t,r){bu(t,a,e,"_c"),t._c=new s,null!=r&&$s(r,o,t[u],t)}),Au("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in c&&(!i||"clear"!=e)&&Iu(a.prototype,e,function(r,n){if(bu(this,a,e),!t&&i&&!Cu(r))return"get"==e&&void 0;var o=this._c[e](0===r?0:r,n);return t?this:o})}),i||Pu(a.prototype,"size",{get:function(){return this._c.size}})):(a=n.getConstructor(t,e,o,u),Ru(a.prototype,r),Be.NEED=!0),et(a,e),p[e]=a,Ou(Ou.G+Ou.W+Ou.F,p),i||n.setStrong(a,e,o),a},Lu=Mu("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=wu.getEntry(pu(this,"Map"),e);return t&&t.v},set:function(e,t){return wu.def(pu(this,"Map"),0===e?0:e,t)}},wu,!0),Du=Mu("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return wu.def(pu(this,"Set"),e=0===e?0:e,e)}},wu),ju=s({}),Uu=Be.getWeak,xu=F({}),Bu=u({}),ku=h({}),qu=Y({}),Vu=ku(5),Fu=ku(6),Gu=0,Hu=function(e){return e._l||(e._l=new Wu)},Wu=function(){this.a=[]},Yu=function(e,t){return Vu(e.a,function(e){return e[0]===t})};Wu.prototype={get:function(e){var t=Yu(this,e);if(t)return t[1]},has:function(e){return!!Yu(this,e)},set:function(e,t){var r=Yu(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=Fu(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}};var zu,Ju={getConstructor:function(e,t,r,n){var o=e(function(e,i){Bu(e,o,t,"_i"),e._t=t,e._i=Gu++,e._l=void 0,null!=i&&$s(i,r,e[n],e)});return ju(o.prototype,{delete:function(e){if(!xu(e))return!1;var r=Uu(e);return!0===r?Hu(pu(this,t)).delete(e):r&&qu(r,this._i)&&delete r[this._i]},has:function(e){if(!xu(e))return!1;var r=Uu(e);return!0===r?Hu(pu(this,t)).has(e):r&&qu(r,this._i)}}),o},def:function(e,t,r){var n=Uu(je(t),!0);return!0===n?Hu(e).set(t,r):n[e._i]=r,e},ufstore:Hu},$u={},Ku=z({}),Qu=h({})(0),Xu=F({}),Zu=!Ku.ActiveXObject&&"ActiveXObject"in Ku,ec=Be.getWeak,tc=Object.isExtensible,rc=Ju.ufstore,nc=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},oc={get:function(e){if(Xu(e)){var t=ec(e);return!0===t?rc(pu(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return Ju.def(pu(this,"WeakMap"),e,t)}},ic=$u=Mu("WeakMap",nc,oc,Ju,!0,!0);pu&&Zu&&(zu=Ju.getConstructor(nc,"WeakMap"),Br(zu.prototype,oc),Be.NEED=!0,Qu(["delete","has","get","set"],function(e){var t=ic.prototype,r=t[e];xe(t,e,function(t,n){if(Xu(t)&&!tc(t)){this._f||(this._f=new zu);var o=this._f[e](t,n);return"set"==e?this:o}return r.call(this,t,n)})}));Mu("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return Ju.def(pu(this,"WeakSet"),e,!0)}},Ju,!1,!0);var sc=U({}),ac=i({}),uc=n({}),cc=P({}),pc=A({}),fc=F({}),lc=z({}).ArrayBuffer,hc=a({}),dc=uc.ArrayBuffer,yc=uc.DataView,vc=ac.ABV&&lc.isView,_c=dc.prototype.slice,Sc=ac.VIEW;sc(sc.G+sc.W+sc.F*(lc!==dc),{ArrayBuffer:dc}),sc(sc.S+sc.F*!ac.CONSTR,"ArrayBuffer",{isView:function(e){return vc&&vc(e)||fc(e)&&Sc in e}}),sc(sc.P+sc.U+sc.F*W({})(function(){return!new dc(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==_c&&void 0===t)return _c.call(je(this),e);for(var r=je(this).byteLength,n=cc(e,r),o=cc(void 0===t?r:t,r),i=new(hc(this,dc))(pc(o-n)),s=new yc(this),a=new yc(i),u=0;n<o;)a.setUint8(u++,s.getUint8(n++));return i}}),p({})("ArrayBuffer");var Ec=U({});Ec(Ec.G+Ec.W+Ec.F*!i({}).ABV,{DataView:n({}).DataView});var mc={};if(H({})){var wc=D({}),gc=z({}),Oc=W({}),Tc=U({}),Ic=i({}),Rc=n({}),bc=G({}),Cc=u({}),Pc=B({}),Ac=x({}),Nc=s({}),Mc=N({}),Lc=A({}),Dc=o({}),jc=P({}),Uc=q({}),xc=Y({}),Bc=_({}),kc=F({}),qc=m({}),Vc=v({}),Fc=T({}),Gc=E({}),Hc=O({}).f,Wc=y({}),Yc=j({}),zc=L({}),Jc=h({}),$c=C({}),Kc=a({}),Qc=c({}),Xc=S({}),Zc=d({}),ep=p({}),tp=f({}),rp=l({}),np=k({}),op=w({}),ip=np.f,sp=op.f,ap=gc.RangeError,up=gc.TypeError,cp=gc.Uint8Array,pp=Array.prototype,fp=Rc.ArrayBuffer,lp=Rc.DataView,hp=Jc(0),dp=Jc(2),yp=Jc(3),vp=Jc(4),_p=Jc(5),Sp=Jc(6),Ep=$c(!0),mp=$c(!1),wp=Qc.values,gp=Qc.keys,Op=Qc.entries,Tp=pp.lastIndexOf,Ip=pp.reduce,Rp=pp.reduceRight,bp=pp.join,Cp=pp.sort,Pp=pp.slice,Ap=pp.toString,Np=pp.toLocaleString,Mp=zc("iterator"),Lp=zc("toStringTag"),Dp=Yc("typed_constructor"),jp=Yc("def_constructor"),Up=Ic.CONSTR,xp=Ic.TYPED,Bp=Ic.VIEW,kp=Jc(1,function(e,t){return Hp(Kc(e,e[jp]),t)}),qp=Oc(function(){return 1===new cp(new Uint16Array([1]).buffer)[0]}),Vp=!!cp&&!!cp.prototype.set&&Oc(function(){new cp(1).set({})}),Fp=function(e,t){var r=Mc(e);if(r<0||r%t)throw ap("Wrong offset!");return r},Gp=function(e){if(kc(e)&&xp in e)return e;throw up(e+" is not a typed array!")},Hp=function(e,t){if(!(kc(e)&&Dp in e))throw up("It is not a typed array constructor!");return new e(t)},Wp=function(e,t){return Yp(Kc(e,e[jp]),t)},Yp=function(e,t){for(var r=0,n=t.length,o=Hp(e,n);n>r;)o[r]=t[r++];return o},zp=function(e,t,r){ip(e,t,{get:function(){return this._d[r]}})},Jp=function(e){var t,r,n,o,i,s,a=qc(e),u=arguments.length,c=u>1?arguments[1]:void 0,p=void 0!==c,f=Wc(a);if(null!=f&&!Vc(f)){for(s=f.call(a),n=[],t=0;!(i=s.next()).done;t++)n.push(i.value);a=n}for(p&&u>2&&(c=bc(c,arguments[2],2)),t=0,r=Lc(a.length),o=Hp(this,r);r>t;t++)o[t]=p?c(a[t],t):a[t];return o},$p=function(){for(var e=0,t=arguments.length,r=Hp(this,t);t>e;)r[e]=arguments[e++];return r},Kp=!!cp&&Oc(function(){Np.call(new cp(1))}),Qp=function(){return Np.apply(Kp?Pp.call(Gp(this)):Gp(this),arguments)},Xp={copyWithin:function(e,t){return rp.call(Gp(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return vp(Gp(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return tp.apply(Gp(this),arguments)},filter:function(e){return Wp(this,dp(Gp(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return _p(Gp(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return Sp(Gp(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){hp(Gp(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return mp(Gp(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return Ep(Gp(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return bp.apply(Gp(this),arguments)},lastIndexOf:function(e){return Tp.apply(Gp(this),arguments)},map:function(e){return kp(Gp(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return Ip.apply(Gp(this),arguments)},reduceRight:function(e){return Rp.apply(Gp(this),arguments)},reverse:function(){for(var e,t=Gp(this).length,r=Math.floor(t/2),n=0;n<r;)e=this[n],this[n++]=this[--t],this[t]=e;return this},some:function(e){return yp(Gp(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return Cp.call(Gp(this),e)},subarray:function(e,t){var r=Gp(this),n=r.length,o=jc(e,n);return new(Kc(r,r[jp]))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,Lc((void 0===t?n:jc(t,n))-o))}},Zp=function(e,t){return Wp(this,Pp.call(Gp(this),e,t))},ef=function(e){Gp(this);var t=Fp(arguments[1],1),r=this.length,n=qc(e),o=Lc(n.length),i=0;if(o+t>r)throw ap("Wrong length!");for(;i<o;)this[t+i]=n[i++]},tf={entries:function(){return Op.call(Gp(this))},keys:function(){return gp.call(Gp(this))},values:function(){return wp.call(Gp(this))}},rf=function(e,t){return kc(e)&&e[xp]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},nf=function(e,t){return rf(e,t=Uc(t,!0))?Pc(2,e[t]):sp(e,t)},of=function(e,t,r){return!(rf(e,t=Uc(t,!0))&&kc(r)&&xc(r,"value"))||xc(r,"get")||xc(r,"set")||r.configurable||xc(r,"writable")&&!r.writable||xc(r,"enumerable")&&!r.enumerable?ip(e,t,r):(e[t]=r.value,e)};Up||(op.f=nf,np.f=of),Tc(Tc.S+Tc.F*!Up,"Object",{getOwnPropertyDescriptor:nf,defineProperty:of}),Oc(function(){Ap.call({})})&&(Ap=Np=function(){return bp.call(this)});var sf=Nc({},Xp);Nc(sf,tf),Ac(sf,Mp,tf.values),Nc(sf,{slice:Zp,set:ef,constructor:function(){},toString:Ap,toLocaleString:Qp}),zp(sf,"buffer","b"),zp(sf,"byteOffset","o"),zp(sf,"byteLength","l"),zp(sf,"length","e"),ip(sf,Lp,{get:function(){return this[xp]}}),mc=function(e,t,r,n){var o=e+((n=!!n)?"Clamped":"")+"Array",i="get"+e,s="set"+e,a=gc[o],u=a||{},c=a&&Gc(a),p=!a||!Ic.ABV,f={},l=a&&a.prototype,h=function(e,r){ip(e,r,{get:function(){return function(e,r){var n=e._d;return n.v[i](r*t+n.o,qp)}(this,r)},set:function(e){return function(e,r,o){var i=e._d;n&&(o=(o=Math.round(o))<0?0:o>255?255:255&o),i.v[s](r*t+i.o,o,qp)}(this,r,e)},enumerable:!0})};p?(a=r(function(e,r,n,i){Cc(e,a,o,"_d");var s,u,c,p,f=0,l=0;if(kc(r)){if(!(r instanceof fp||"ArrayBuffer"==(p=Bc(r))||"SharedArrayBuffer"==p))return xp in r?Yp(a,r):Jp.call(a,r);s=r,l=Fp(n,t);var d=r.byteLength;if(void 0===i){if(d%t)throw ap("Wrong length!");if((u=d-l)<0)throw ap("Wrong length!")}else if((u=Lc(i)*t)+l>d)throw ap("Wrong length!");c=u/t}else c=Dc(r),s=new fp(u=c*t);for(Ac(e,"_d",{b:s,o:l,l:u,e:c,v:new lp(s)});f<c;)h(e,f++)}),l=a.prototype=Fc(sf),Ac(l,"constructor",a)):Oc(function(){a(1)})&&Oc(function(){new a(-1)})&&Zc(function(e){new a,new a(null),new a(1.5),new a(e)},!0)||(a=r(function(e,r,n,i){var s;return Cc(e,a,o),kc(r)?r instanceof fp||"ArrayBuffer"==(s=Bc(r))||"SharedArrayBuffer"==s?void 0!==i?new u(r,Fp(n,t),i):void 0!==n?new u(r,Fp(n,t)):new u(r):xp in r?Yp(a,r):Jp.call(a,r):new u(Dc(r))}),hp(c!==Function.prototype?Hc(u).concat(Hc(c)):Hc(u),function(e){e in a||Ac(a,e,u[e])}),a.prototype=l,wc||(l.constructor=a));var d=l[Mp],y=!!d&&("values"==d.name||null==d.name),v=tf.values;Ac(a,Dp,!0),Ac(l,xp,o),Ac(l,Bp,!0),Ac(l,jp,a),(n?new a(1)[Lp]==o:Lp in l)||ip(l,Lp,{get:function(){return o}}),f[o]=a,Tc(Tc.G+Tc.W+Tc.F*(a!=u),f),Tc(Tc.S,o,{BYTES_PER_ELEMENT:t}),Tc(Tc.S+Tc.F*Oc(function(){u.of.call(a,1)}),o,{from:Jp,of:$p}),"BYTES_PER_ELEMENT"in l||Ac(l,"BYTES_PER_ELEMENT",t),Tc(Tc.P,o,Xp),ep(o),Tc(Tc.P+Tc.F*Vp,o,{set:ef}),Tc(Tc.P+Tc.F*!y,o,tf),wc||l.toString==Ap||(l.toString=Ap),Tc(Tc.P+Tc.F*Oc(function(){new a(1).slice()}),o,{slice:Zp}),Tc(Tc.P+Tc.F*(Oc(function(){return[1,2].toLocaleString()!=new a([1,2]).toLocaleString()})||!Oc(function(){l.toLocaleString.call([1,2])})),o,{toLocaleString:Qp}),Xc[o]=y?d:v,wc||y||Ac(l,Mp,v)}}else mc=function(){};mc("Int8",1,function(e){return function(t,r,n){return e(this,t,r,n)}});mc("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}});mc("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}},!0);mc("Int16",2,function(e){return function(t,r,n){return e(this,t,r,n)}});mc("Uint16",2,function(e){return function(t,r,n){return e(this,t,r,n)}});mc("Int32",4,function(e){return function(t,r,n){return e(this,t,r,n)}});mc("Uint32",4,function(e){return function(t,r,n){return e(this,t,r,n)}});mc("Float32",4,function(e){return function(t,r,n){return e(this,t,r,n)}});mc("Float64",8,function(e){return function(t,r,n){return e(this,t,r,n)}});var af=U({}),uf=(z({}).Reflect||{}).apply,cf=Function.apply;af(af.S+af.F*!W({})(function(){uf(function(){})}),"Reflect",{apply:function(e,t,r){var n=Le(e),o=je(r);return uf?uf(n,t,o):cf.call(n,t,o)}});var pf=U({}),ff=T({}),lf=F({}),hf=W({}),df=(z({}).Reflect||{}).construct,yf=hf(function(){function e(){}return!(df(function(){},[],e)instanceof e)}),vf=!hf(function(){df(function(){})});pf(pf.S+pf.F*(yf||vf),"Reflect",{construct:function(e,t){Le(e),je(t);var r=arguments.length<3?e:Le(arguments[2]);if(vf&&!yf)return df(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(Qr.apply(e,n))}var o=r.prototype,i=ff(lf(o)?o:Object.prototype),s=Function.apply.call(e,i,t);return lf(s)?s:i}});var _f=k({}),Sf=U({}),Ef=q({});Sf(Sf.S+Sf.F*W({})(function(){Reflect.defineProperty(_f.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,r){je(e),t=Ef(t,!0),je(r);try{return _f.f(e,t,r),!0}catch(e){return!1}}});var mf=U({}),wf=w({}).f;mf(mf.S,"Reflect",{deleteProperty:function(e,t){var r=wf(je(e),t);return!(r&&!r.configurable)&&delete e[t]}});var gf=U({}),Of=function(e){this._t=je(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};zo(Of,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),gf(gf.S,"Reflect",{enumerate:function(e){return new Of(e)}});var Tf=w({}),If=E({}),Rf=Y({}),bf=U({}),Cf=F({});bf(bf.S,"Reflect",{get:function e(t,r){var n,o,i=arguments.length<3?t:arguments[2];return je(t)===i?t[r]:(n=Tf.f(t,r))?Rf(n,"value")?n.value:void 0!==n.get?n.get.call(i):void 0:Cf(o=If(t))?e(o,r,i):void 0}});var Pf=w({}),Af=U({});Af(Af.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return Pf.f(je(e),t)}});var Nf=U({}),Mf=E({});Nf(Nf.S,"Reflect",{getPrototypeOf:function(e){return Mf(je(e))}});var Lf=U({});Lf(Lf.S,"Reflect",{has:function(e,t){return t in e}});var Df=U({}),jf=Object.isExtensible;Df(Df.S,"Reflect",{isExtensible:function(e){return je(e),!jf||jf(e)}});var Uf=O({}),xf=b({}),Bf=z({}).Reflect,kf=Bf&&Bf.ownKeys||function(e){var t=Uf.f(je(e)),r=xf.f;return r?t.concat(r(e)):t},qf=U({});qf(qf.S,"Reflect",{ownKeys:kf});var Vf=U({}),Ff=Object.preventExtensions;Vf(Vf.S,"Reflect",{preventExtensions:function(e){je(e);try{return Ff&&Ff(e),!0}catch(e){return!1}}});var Gf=k({}),Hf=w({}),Wf=E({}),Yf=Y({}),zf=U({}),Jf=B({}),$f=F({});zf(zf.S,"Reflect",{set:function e(t,r,n){var o,i,s=arguments.length<4?t:arguments[3],a=Hf.f(je(t),r);if(!a){if($f(i=Wf(t)))return e(i,r,n,s);a=Jf(0)}if(Yf(a,"value")){if(!1===a.writable||!$f(s))return!1;if(o=Hf.f(s,r)){if(o.get||o.set||!1===o.writable)return!1;o.value=n,Gf.f(s,r,o)}else Gf.f(s,r,Jf(0,n));return!0}return void 0!==a.set&&(a.set.call(s,n),!0)}});var Kf=U({});Hr&&Kf(Kf.S,"Reflect",{setPrototypeOf:function(e,t){Hr.check(e,t);try{return Hr.set(e,t),!0}catch(e){return!1}}});var Qf=U({}),Xf=C({})(!0);Qf(Qf.P,"Array",{includes:function(e){return Xf(this,e,arguments.length>1?arguments[1]:void 0)}}),Bs("includes");var Zf=F({}),el=A({}),tl=G({}),rl=L({})("isConcatSpreadable");var nl=function e(t,r,n,o,i,s,a,u){for(var c,p,f=i,l=0,h=!!a&&tl(a,u,3);l<o;){if(l in n){if(c=h?h(n[l],l,r):n[l],p=!1,Zf(c)&&(p=void 0!==(p=c[rl])?!!p:gt(c)),p&&s>0)f=e(t,r,c,el(c.length),f,s-1)-1;else{if(f>=9007199254740991)throw TypeError();t[f]=c}f++}l++}return f},ol=U({}),il=m({}),sl=A({});ol(ol.P,"Array",{flatMap:function(e){var t,r,n=il(this);return Le(e),t=sl(n.length),r=ls(n,0),nl(r,n,n,t,0,1,e,arguments[1]),r}}),Bs("flatMap");var al=U({}),ul=m({}),cl=A({}),pl=N({});al(al.P,"Array",{flatten:function(){var e=arguments[0],t=ul(this),r=cl(t.length),n=ls(t,0);return nl(n,t,t,r,0,void 0===e?1:pl(e)),n}}),Bs("flatten");var fl=U({}),ll=Go(!0);fl(fl.P,"String",{at:function(e){return ll(this,e)}});var hl=A({}),dl=function(e,t,r,n){var o=String(ut(e)),i=o.length,s=void 0===r?" ":String(r),a=hl(t);if(a<=i||""==s)return o;var u=a-i,c=In.call(s,Math.ceil(u/s.length));return c.length>u&&(c=c.slice(0,u)),n?c+o:o+c},yl=U({}),vl=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(Da);yl(yl.P+yl.F*vl,"String",{padStart:function(e){return dl(this,e,arguments.length>1?arguments[1]:void 0,!0)}});var _l=U({}),Sl=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(Da);_l(_l.P+_l.F*Sl,"String",{padEnd:function(e){return dl(this,e,arguments.length>1?arguments[1]:void 0,!1)}});ln("trimLeft",function(e){return function(){return e(this,1)}},"trimStart");ln("trimRight",function(e){return function(){return e(this,2)}},"trimEnd");var El=U({}),ml=A({}),wl=RegExp.prototype,gl=function(e,t){this._r=e,this._s=t};zo(gl,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),El(El.P,"String",{matchAll:function(e){if(ut(this),!ci(e))throw TypeError(e+" is not a regexp!");var t=String(this),r="flags"in wl?String(e.flags):function(){var e=je(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}.call(e),n=new RegExp(e.source,~r.indexOf("g")?r:"g"+r);return n.lastIndex=ml(e.lastIndex),new gl(n,t)}});it("asyncIterator");it("observable");var Ol=U({}),Tl=w({});Ol(Ol.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=ct(e),o=Tl.f,i=kf(n),s={},a=0;i.length>a;)void 0!==(r=o(n,t=i[a++]))&&Vi(s,t,r);return s}});var Il=R({}).f,Rl=function(e){return function(t){for(var r,n=ct(t),o=St(n),i=o.length,s=0,a=[];i>s;)Il.call(n,r=o[s++])&&a.push(e?[r,n[r]]:n[r]);return a}},bl=U({}),Cl=Rl(!1);bl(bl.S,"Object",{values:function(e){return Cl(e)}});var Pl=U({}),Al=Rl(!0);Pl(Pl.S,"Object",{entries:function(e){return Al(e)}});var Nl=D({})||!W({})(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete z({})[e]}),Ml=U({}),Ll=m({}),Dl=k({});H({})&&Ml(Ml.P+Nl,"Object",{__defineGetter__:function(e,t){Dl.f(Ll(this),e,{get:Le(t),enumerable:!0,configurable:!0})}});var jl=U({}),Ul=m({}),xl=k({});H({})&&jl(jl.P+Nl,"Object",{__defineSetter__:function(e,t){xl.f(Ul(this),e,{set:Le(t),enumerable:!0,configurable:!0})}});var Bl=U({}),kl=m({}),ql=q({}),Vl=E({}),Fl=w({}).f;H({})&&Bl(Bl.P+Nl,"Object",{__lookupGetter__:function(e){var t,r=kl(this),n=ql(e,!0);do{if(t=Fl(r,n))return t.get}while(r=Vl(r))}});var Gl=U({}),Hl=m({}),Wl=q({}),Yl=E({}),zl=w({}).f;H({})&&Gl(Gl.P+Nl,"Object",{__lookupSetter__:function(e){var t,r=Hl(this),n=Wl(e,!0);do{if(t=zl(r,n))return t.set}while(r=Yl(r))}});var Jl=function(e,t){var r=[];return $s(e,!1,r.push,r,t),r},$l=_({}),Kl=function(e){return function(){if($l(this)!=e)throw TypeError(e+"#toJSON isn't generic");return Jl(this)}},Ql=U({});Ql(Ql.P+Ql.R,"Map",{toJSON:Kl("Map")});var Xl=U({});Xl(Xl.P+Xl.R,"Set",{toJSON:Kl("Set")});var Zl=U({}),eh=function(e){Zl(Zl.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})};eh("Map");eh("Set");eh("WeakMap");eh("WeakSet");var th=U({}),rh=G({}),nh=function(e){th(th.S,e,{from:function(e){var t,r,n,o,i=arguments[1];return Le(this),(t=void 0!==i)&&Le(i),null==e?new this:(r=[],t?(n=0,o=rh(i,arguments[2],2),$s(e,!1,function(e){r.push(o(e,n++))})):$s(e,!1,r.push,r),new this(r))}})};nh("Map");nh("Set");nh("WeakMap");nh("WeakSet");var oh=U({});oh(oh.G,{global:z({})});var ih=U({});ih(ih.S,"System",{global:z({})});var sh=U({}),ah=M({});sh(sh.S,"Error",{isError:function(e){return"Error"===ah(e)}});var uh=U({});uh(uh.S,"Math",{clamp:function(e,t,r){return Math.min(r,Math.max(t,e))}});var ch=U({});ch(ch.S,"Math",{DEG_PER_RAD:Math.PI/180});var ph=U({}),fh=180/Math.PI;ph(ph.S,"Math",{degrees:function(e){return e*fh}});var lh=Math.scale||function(e,t,r,n,o){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||o!=o?NaN:e===1/0||e===-1/0?e:(e-t)*(o-n)/(r-t)+n},hh=U({});hh(hh.S,"Math",{fscale:function(e,t,r,n,o){return wo(lh(e,t,r,n,o))}});var dh=U({});dh(dh.S,"Math",{iaddh:function(e,t,r,n){var o=e>>>0,i=r>>>0;return(t>>>0)+(n>>>0)+((o&i|(o|i)&~(o+i>>>0))>>>31)|0}});var yh=U({});yh(yh.S,"Math",{isubh:function(e,t,r,n){var o=e>>>0,i=r>>>0;return(t>>>0)-(n>>>0)-((~o&i|~(o^i)&o-i>>>0)>>>31)|0}});var vh=U({});vh(vh.S,"Math",{imulh:function(e,t){var r=+e,n=+t,o=65535&r,i=65535&n,s=r>>16,a=n>>16,u=(s*i>>>0)+(o*i>>>16);return s*a+(u>>16)+((o*a>>>0)+(65535&u)>>16)}});var _h=U({});_h(_h.S,"Math",{RAD_PER_DEG:180/Math.PI});var Sh=U({}),Eh=Math.PI/180;Sh(Sh.S,"Math",{radians:function(e){return e*Eh}});var mh=U({});mh(mh.S,"Math",{scale:lh});var wh=U({});wh(wh.S,"Math",{umulh:function(e,t){var r=+e,n=+t,o=65535&r,i=65535&n,s=r>>>16,a=n>>>16,u=(s*i>>>0)+(o*i>>>16);return s*a+(u>>>16)+((o*a>>>0)+(65535&u)>>>16)}});var gh=U({});gh(gh.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}});var Oh=U({}),Th=z({}),Ih=a({});Oh(Oh.P+Oh.R,"Promise",{finally:function(e){var t=Ih(this,Ne.Promise||Th.Promise),r="function"==typeof e;return this.then(r?function(r){return Ua(t,e()).then(function(){return r})}:e,r?function(r){return Ua(t,e()).then(function(){throw r})}:e)}});var Rh=U({});Rh(Rh.S,"Promise",{try:function(e){var t=Ra.f(this),r=Ma(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}});var bh=U({}),Ch=Je("metadata"),Ph=Ch.store||(Ch.store=new $u),Ah=function(e,t,r){var n=Ph.get(e);if(!n){if(!r)return;Ph.set(e,n=new Lu)}var o=n.get(t);if(!o){if(!r)return;n.set(t,o=new Lu)}return o},Nh={store:Ph,map:Ah,has:function(e,t,r){var n=Ah(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=Ah(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){Ah(r,n,!0).set(e,t)},keys:function(e,t){var r=Ah(e,t,!1),n=[];return r&&r.forEach(function(e,t){n.push(t)}),n},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){bh(bh.S,"Reflect",e)}},Mh=Nh.key,Lh=Nh.set;Nh.exp({defineMetadata:function(e,t,r,n){Lh(e,t,je(r),Mh(n))}});var Dh=Nh.key,jh=Nh.map,Uh=Nh.store;Nh.exp({deleteMetadata:function(e,t){var r=arguments.length<3?void 0:Dh(arguments[2]),n=jh(je(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var o=Uh.get(t);return o.delete(r),!!o.size||Uh.delete(t)}});var xh=E({}),Bh=Nh.has,kh=Nh.get,qh=Nh.key,Vh=function(e,t,r){if(Bh(e,t,r))return kh(e,t,r);var n=xh(t);return null!==n?Vh(e,n,r):void 0};Nh.exp({getMetadata:function(e,t){return Vh(e,je(t),arguments.length<3?void 0:qh(arguments[2]))}});var Fh=E({}),Gh=Nh.keys,Hh=Nh.key,Wh=function(e,t){var r=Gh(e,t),n=Fh(e);if(null===n)return r;var o=Wh(n,t);return o.length?r.length?Jl(new Du(r.concat(o))):o:r};Nh.exp({getMetadataKeys:function(e){return Wh(je(e),arguments.length<2?void 0:Hh(arguments[1]))}});var Yh=Nh.get,zh=Nh.key;Nh.exp({getOwnMetadata:function(e,t){return Yh(e,je(t),arguments.length<3?void 0:zh(arguments[2]))}});var Jh=Nh.keys,$h=Nh.key;Nh.exp({getOwnMetadataKeys:function(e){return Jh(je(e),arguments.length<2?void 0:$h(arguments[1]))}});var Kh=E({}),Qh=Nh.has,Xh=Nh.key,Zh=function(e,t,r){if(Qh(e,t,r))return!0;var n=Kh(t);return null!==n&&Zh(e,n,r)};Nh.exp({hasMetadata:function(e,t){return Zh(e,je(t),arguments.length<3?void 0:Xh(arguments[2]))}});var ed=Nh.has,td=Nh.key;Nh.exp({hasOwnMetadata:function(e,t){return ed(e,je(t),arguments.length<3?void 0:td(arguments[2]))}});var rd=Nh.key,nd=Nh.set;Nh.exp({metadata:function(e,t){return function(r,n){nd(e,t,(void 0!==n?je:Le)(r),rd(n))}}});var od=U({}),id=Ia(),sd=z({}).process,ad="process"==M({})(sd);od(od.G,{asap:function(e){var t=ad&&sd.domain;id(t?t.bind(e):e)}});var ud=U({}),cd=z({}),pd=Ia(),fd=L({})("observable"),ld=u({}),hd=s({}),dd=x({}),yd=$s.RETURN,vd=function(e){return null==e?void 0:Le(e)},_d=function(e){var t=e._c;t&&(e._c=void 0,t())},Sd=function(e){return void 0===e._o},Ed=function(e){Sd(e)||(e._o=void 0,_d(e))},md=function(e,t){je(e),this._c=void 0,this._o=e,e=new wd(this);try{var r=t(e),n=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){n.unsubscribe()}:Le(r),this._c=r)}catch(t){return void e.error(t)}Sd(this)&&_d(this)};md.prototype=hd({},{unsubscribe:function(){Ed(this)}});var wd=function(e){this._s=e};wd.prototype=hd({},{next:function(e){var t=this._s;if(!Sd(t)){var r=t._o;try{var n=vd(r.next);if(n)return n.call(r,e)}catch(e){try{Ed(t)}finally{throw e}}}},error:function(e){var t=this._s;if(Sd(t))throw e;var r=t._o;t._o=void 0;try{var n=vd(r.error);if(!n)throw e;e=n.call(r,e)}catch(e){try{_d(t)}finally{throw e}}return _d(t),e},complete:function(e){var t=this._s;if(!Sd(t)){var r=t._o;t._o=void 0;try{var n=vd(r.complete);e=n?n.call(r,e):void 0}catch(e){try{_d(t)}finally{throw e}}return _d(t),e}}});var gd=function(e){ld(this,gd,"Observable","_f")._f=Le(e)};hd(gd.prototype,{subscribe:function(e){return new md(e,this._f)},forEach:function(e){var t=this;return new(Ne.Promise||cd.Promise)(function(r,n){Le(e);var o=t.subscribe({next:function(t){try{return e(t)}catch(e){n(e),o.unsubscribe()}},error:n,complete:r})})}}),hd(gd,{from:function(e){var t="function"==typeof this?this:gd,r=vd(je(e)[fd]);if(r){var n=je(r.call(e));return n.constructor===t?n:new t(function(e){return n.subscribe(e)})}return new t(function(t){var r=!1;return pd(function(){if(!r){try{if($s(e,!1,function(e){if(t.next(e),r)return yd})===yd)return}catch(e){if(r)throw e;return void t.error(e)}t.complete()}}),function(){r=!0}})},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:gd)(function(e){var t=!1;return pd(function(){if(!t){for(var n=0;n<r.length;++n)if(e.next(r[n]),t)return;e.complete()}}),function(){t=!0}})}}),dd(gd.prototype,fd,function(){return this}),ud(ud.G,{Observable:gd}),p({})("Observable");var Od=z({}),Td=U({}),Id=[].slice,Rd=/MSIE .\./.test(Da),bd=function(e){return function(t,r){var n=arguments.length>2,o=!!n&&Id.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,o)}:t,r)}};Td(Td.G+Td.B+Td.F*Rd,{setTimeout:bd(Od.setTimeout),setInterval:bd(Od.setInterval)});var Cd=U({});Cd(Cd.G+Cd.B,{setImmediate:Sa.set,clearImmediate:Sa.clear});c({});for(var Pd=z({}),Ad=x({}),Nd=S({}),Md=L({})("toStringTag"),Ld="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Dd=0;Dd<Ld.length;Dd++){var jd=Ld[Dd],Ud=Pd[jd],xd=Ud&&Ud.prototype;xd&&!xd[Md]&&Ad(xd,Md,jd),Nd[jd]=Nd.Array}c({});var Bd=function(e,t){for(var r,n=ct(e),o=St(n),i=o.length,s=0;i>s;)if(n[r=o[s++]]===t)return r},kd=_({}),qd=L({})("iterator"),Vd=S({}),Fd=Ne.isIterable=function(e){var t=Object(e);return void 0!==t[qd]||"@@iterator"in t||Vd.hasOwnProperty(kd(t))},Gd=G({}),Hd=U({}),Wd=B({}),Yd=T({}),zd=E({}),Jd=k({}),$d=F({}),Kd=H({}),Qd=Y({}),Xd=function(e){var t=1==e,r=4==e;return function(n,o,i){var s,a,u,c=Gd(o,i,3),p=ct(n),f=t||7==e||2==e?new("function"==typeof this?this:ry):void 0;for(s in p)if(Qd(p,s)&&(u=c(a=p[s],s,n),e))if(t)f[s]=u;else if(u)switch(e){case 2:f[s]=a;break;case 3:return!0;case 5:return a;case 6:return s;case 7:f[u[0]]=u[1]}else if(r)return!1;return 3==e||r?r:f}},Zd=Xd(6),ey=function(e){return function(t){return new ty(t,e)}},ty=function(e,t){this._t=ct(e),this._a=St(e),this._i=0,this._k=t};function ry(e){var t=Yd(null);return null!=e&&(Fd(e)?$s(e,!0,function(e,r){t[e]=r}):Br(t,e)),t}zo(ty,"Dict",function(){var e,t=this._t,r=this._a,n=this._k;do{if(this._i>=r.length)return this._t=void 0,zs(1)}while(!Qd(t,e=r[this._i++]));return zs(0,"keys"==n?e:"values"==n?t[e]:[e,t[e]])}),ry.prototype=null,Hd(Hd.G+Hd.F,{Dict:ry}),Hd(Hd.S,"Dict",{keys:ey("keys"),values:ey("values"),entries:ey("entries"),forEach:Xd(0),map:Xd(1),filter:Xd(2),some:Xd(3),every:Xd(4),find:Xd(5),findKey:Zd,mapPairs:Xd(7),reduce:function(e,t,r){Le(t);var n,o,i=ct(e),s=St(i),a=s.length,u=0;if(arguments.length<3){if(!a)throw TypeError("Reduce of empty object with no initial value");n=i[s[u++]]}else n=Object(r);for(;a>u;)Qd(i,o=s[u++])&&(n=t(n,i[o],o,e));return n},keyOf:Bd,includes:function(e,t){return void 0!==(t==t?Bd(e,t):Zd(e,function(e){return e!=e}))},has:Qd,get:function(e,t){if(Qd(e,t))return e[t]},set:function(e,t,r){return Kd&&t in Object?Jd.f(e,t,Wd(0,r)):e[t]=r,e},isDict:function(e){return $d(e)&&zd(e)===ry.prototype}});var ny=y({}),oy=(Ne.getIterator=function(e){var t=ny(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return je(t.call(e))},Ne),iy=function(){for(var e=Le(this),t=arguments.length,r=new Array(t),n=0,o=oy._,i=!1;t>n;)(r[n]=arguments[n++])===o&&(i=!0);return function(){var n,s=arguments.length,a=0,u=0;if(!i&&!s)return zr(e,r,this);if(n=r.slice(),i)for(;t>a;a++)n[a]===o&&(n[a]=arguments[u++]);for(;s>u;)n.push(arguments[u++]);return zr(e,n,this)}},sy=z({}),ay=U({});ay(ay.G+ay.F,{delay:function(e){return new(Ne.Promise||sy.Promise)(function(t){setTimeout(iy.call(t,!0),e)})}});var uy=U({});Ne._=oy._=oy._||{},uy(uy.P+uy.F,"Function",{part:iy});var cy=U({});cy(cy.S+cy.F,"Object",{isObject:F({})});var py=U({});py(py.S+py.F,"Object",{classof:_({})});var fy=k({}),ly=w({}),hy=function(e,t){for(var r,n=kf(ct(t)),o=n.length,i=0;o>i;)fy.f(e,r=n[i++],ly.f(t,r));return e},dy=U({});dy(dy.S+dy.F,"Object",{define:hy});var yy=U({}),vy=T({});yy(yy.S+yy.F,"Object",{make:function(e,t){return hy(vy(e),t)}});ri(Number,"Number",function(e){this._l=+e,this._i=0},function(){var e=this._i++,t=!(e<this._l);return{done:t,value:t?void 0:e}});var _y=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}},Sy=U({}),Ey=_y(/[\\^$*+?.()|[\]{}]/g,"\\$&");Sy(Sy.S,"RegExp",{escape:function(e){return Ey(e)}});var my=U({}),wy=_y(/[&<>"']/g,{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"});my(my.P+my.F,"String",{escapeHTML:function(){return wy(this)}});var gy=U({}),Oy=_y(/&(?:amp|lt|gt|quot|apos);/g,{"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"});gy(gy.P+gy.F,"String",{unescapeHTML:function(){return Oy(this)}}),y({});for(var Ty=Ne,Iy={toByteArray:function(e){var t,r,n=My(e),o=n[0],i=n[1],s=new Cy(function(e,t,r){return 3*(t+r)/4-r}(0,o,i)),a=0,u=i>0?o-4:o;for(r=0;r<u;r+=4)t=by[e.charCodeAt(r)]<<18|by[e.charCodeAt(r+1)]<<12|by[e.charCodeAt(r+2)]<<6|by[e.charCodeAt(r+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;2===i&&(t=by[e.charCodeAt(r)]<<2|by[e.charCodeAt(r+1)]>>4,s[a++]=255&t);1===i&&(t=by[e.charCodeAt(r)]<<10|by[e.charCodeAt(r+1)]<<4|by[e.charCodeAt(r+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t);return s},fromByteArray:function(e){for(var t,r=e.length,n=r%3,o=[],i=0,s=r-n;i<s;i+=16383)o.push(Ly(e,i,i+16383>s?s:i+16383));1===n?(t=e[r-1],o.push(Ry[t>>2]+Ry[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(Ry[t>>10]+Ry[t>>4&63]+Ry[t<<2&63]+"="));return o.join("")}},Ry=[],by=[],Cy="undefined"!=typeof Uint8Array?Uint8Array:Array,Py="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ay=0,Ny=Py.length;Ay<Ny;++Ay)Ry[Ay]=Py[Ay],by[Py.charCodeAt(Ay)]=Ay;function My(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function Ly(e,t,r){for(var n,o,i=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(Ry[(o=n)>>18&63]+Ry[o>>12&63]+Ry[o>>6&63]+Ry[63&o]);return i.join("")}by["-".charCodeAt(0)]=62,by["_".charCodeAt(0)]=63;var Dy={read:function(e,t,r,n,o){var i,s,a=8*o-n-1,u=(1<<a)-1,c=u>>1,p=-7,f=r?o-1:0,l=r?-1:1,h=e[t+f];for(f+=l,i=h&(1<<-p)-1,h>>=-p,p+=a;p>0;i=256*i+e[t+f],f+=l,p-=8);for(s=i&(1<<-p)-1,i>>=-p,p+=n;p>0;s=256*s+e[t+f],f+=l,p-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),i-=c}return(h?-1:1)*s*Math.pow(2,i-n)},write:function(e,t,r,n,o,i){var s,a,u,c=8*i-o-1,p=(1<<c)-1,f=p>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,d=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=p):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+f>=1?l/u:l*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=p?(a=0,s=p):s+f>=1?(a=(t*u-1)*Math.pow(2,o),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,o),s=0));o>=8;e[r+h]=255&a,h+=d,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;e[r+h]=255&s,h+=d,s/=256,c-=8);e[r+h-d]|=128*y}},jy={};(function(e){"use strict";var t=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(jy,"__esModule",{value:!0});var r=oe.fromNumber(128),n=oe.fromNumber(127),o=n.not();function i(e){var t=e.read();if(-1===t)throw new Error("End of stream");return t}function s(e){for(var t=0,r=0;t<32;){var n=i(e);if(r|=(127&n)<<t,0==(128&n))return r;t+=7}throw new Error("Malformed int32")}function a(e,t){for(;0!=(-128&t);)e.write(127&t|128),t>>>=7;e.write(t)}function u(e){var t=s(e);return e.readMany(t)}function c(e,t){a(e,t.length),e.writeMany(t)}function p(e){var t=u(e);return t?t.toString("utf8"):""}function f(t,r){c(t,e.from(r,"utf8"))}function l(e,r,n,o){var i,s;a(e,Object.keys(r).length);try{for(var u=t(Object.getOwnPropertyNames(r)),c=u.next();!c.done;c=u.next()){var p=c.value;n(e,p),o(e,r[p])}}catch(e){i={error:e}}finally{try{c&&!c.done&&(s=u.return)&&s.call(u)}finally{if(i)throw i.error}}}function h(e,t,r){for(var n=s(e),o={},i=0;i<n;++i){o[t(e)]=r(e)}return o}jy.readByte=i,jy.readInt64=function(e){for(var t=oe.fromNumber(0),o=0;o<64;){var s=i(e),a=oe.fromNumber(s);if(t=t.or(a.and(n).shiftLeft(o)),a.and(r).equals(0))return t;o+=7}throw new Error("Malformed int64")},jy.writeInt64=function(e,t){for(var i=t instanceof oe?t:oe.fromNumber(t,!1);!i.and(o).equals(0);)e.write(i.and(n).or(r).toInt()),i=i.shiftRightUnsigned(7);e.write(i.toInt())},jy.readInt32=s,jy.writeInt32=a,jy.writeByte=function(e,t){e.write(t)},jy.readBytes=u,jy.writeBytes=c,jy.readString=p,jy.writeString=f,jy.writeCollection=function(e,r,n){var o,i;a(e,r.length);try{for(var s=t(r),u=s.next();!u.done;u=s.next())n(e,u.value)}catch(e){o={error:e}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}},jy.readCollection=function(e,t){for(var r=s(e),n=[],o=0;o<r;++o)n.push(t(e));return n},jy.readDictionary=function(e,t){return h(e,p,t)},jy.writeDictionary=function(e,t,r){l(e,t,f,r)},jy.writeObject=l,jy.readObject=h,jy.readMap=function(e,t,r){for(var n=s(e),o=new Ty.Map,i=0;i<n;++i){var a=t(e);o.set(a,r(e))}return o},jy.writeMap=function(e,t,r,n){a(e,t.size),t.forEach(function(t,o){r(e,o),n(e,t)})},jy.readBoolean=function(e){return 0!==e.readInt8()},jy.writeBoolean=function(e,t){e.writeInt8(t?1:0)}}).call(this,r({}).Buffer);var Uy={};Object.defineProperty(Uy,"__esModule",{value:!0});var xy=function(){function e(){}return e.prototype.read=function(e){return new Pe.ConversationId(jy.readInt64(e))},e.prototype.write=function(e,t){jy.writeInt64(e,t.val)},e}();Uy.CIDSerialiser=new xy;var By={};Object.defineProperty(By,"__esModule",{value:!0});var ky=function(){function e(){}return e.prototype.read=function(e){throw new Error("AbstractSerialiser#read is not implemented")},e.prototype.write=function(e,t){throw new Error("AbstractSerialiser#write is not implemented")},e}();By.AbstractSerialiser=ky;var qy={};Object.defineProperty(qy,"__esModule",{value:!0});var Vy=function(){function e(e,t){this.service=e,this.cid=t}return e.createRequestHeader=function(t,r){return new e(t,r)},e.prototype.createResponseHeader=function(){return new e(this.service,this.cid)},e.prototype.createErrorHeader=function(){return new e(this.service,this.cid)},e.prototype.toString=function(){return"<"+this.service+", "+this.cid.toString()+">"},e}();qy.CommandHeader=Vy;var Fy,Gy={},Hy=this&&this.__extends||(Fy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}Fy(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(Gy,"__esModule",{value:!0});var Wy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Hy(t,e),t.prototype.read=function(e){var t=jy.readInt32(e),r=Uy.CIDSerialiser.read(e);return new qy.CommandHeader(t,r)},t.prototype.write=function(e,t){jy.writeInt32(e,t.service),Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser),Yy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Hy(t,e),t.prototype.write=function(e,t){Uy.CIDSerialiser.write(e,t.cid)},t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e);return new qy.CommandHeader(0,t)},t}(By.AbstractSerialiser);Gy.CommandHeaderSerialiser=new Wy,Gy.ResponseCommandHeaderSerialiser=new Yy;var zy={exports:{}};!function(e,t){"use strict";zy.exports?zy.exports=t():e.log=t()}(this,function(){"use strict";var e=function(){},t="undefined",r=["trace","debug","info","warn","error"];function n(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function o(t,n){for(var o=0;o<r.length;o++){var i=r[o];this[i]=o<t?e:this.methodFactory(i,t,n)}this.log=this.debug}function i(r,i,s){return function(r){return"debug"===r&&(r="log"),typeof console!==t&&(void 0!==console[r]?n(console,r):void 0!==console.log?n(console,"log"):e)}(r)||function(e,r,n){return function(){typeof console!==t&&(o.call(this,r,n),this[e].apply(this,arguments))}}.apply(this,arguments)}function s(e,n,s){var a,u=this,c="loglevel";function p(){var e;if(typeof window!==t){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var r=window.document.cookie,n=r.indexOf(encodeURIComponent(c)+"=");-1!==n&&(e=/^([^;]+)/.exec(r.slice(n))[1])}catch(e){}return void 0===u.levels[e]&&(e=void 0),e}}e&&(c+=":"+e),u.name=e,u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=s||i,u.getLevel=function(){return a},u.setLevel=function(n,i){if("string"==typeof n&&void 0!==u.levels[n.toUpperCase()]&&(n=u.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=u.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(a=n,!1!==i&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}(n),o.call(u,n,e),typeof console===t&&n<u.levels.SILENT)return"No console available for logging"},u.setDefaultLevel=function(e){p()||u.setLevel(e,!1)},u.enableAll=function(e){u.setLevel(u.levels.TRACE,e)},u.disableAll=function(e){u.setLevel(u.levels.SILENT,e)};var f=p();null==f&&(f=null==n?"WARN":n),u.setLevel(f,!1)}var a=new s,u={};a.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=u[e];return t||(t=u[e]=new s(e,a.getLevel(),a.methodFactory)),t};var c=typeof window!==t?window.log:void 0;return a.noConflict=function(){return typeof window!==t&&window.log===a&&(window.log=c),a},a.getLoggers=function(){return u},a}),zy=zy.exports;var Jy,$y={},Ky=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};function Qy(e,t){var r="|"+e.toUpperCase()+"|"+t+"|",n=function(){return new Date};return function(t,o){o?zy[e](n()+r+t,o):zy[e](n()+r+t)}}Object.defineProperty($y,"__esModule",{value:!0}),function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error"}(Jy=$y.LoggingLevel||($y.LoggingLevel={})),$y.create=function(e){var t,r,n={};try{for(var o=Ky(Object.keys(Jy)),i=o.next();!i.done;i=o.next()){var s=i.value;n[s]=Qy(s,e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},$y.setLevel=zy.setLevel;var Xy={};Object.defineProperty(Xy,"__esModule",{value:!0});var Zy=function(){function e(e){this.buffer=e,this.count=e.length,this.pos=0}return e.prototype.read=function(){return this.pos<this.count?255&this.buffer[this.pos++]:-1},e.prototype.peek=function(){return this.pos<this.count?255&this.buffer[this.pos]:-1},e.prototype.readMany=function(e){var t=Math.min(e,this.count-this.pos);if(t<0)throw new Error("Length out of bounds");var r=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,r},e.prototype.readUntil=function(e){for(var t=this.count,r=this.pos;r<this.count;r++)if(this.buffer[r]===e){t=r;break}var n=this.buffer.slice(this.pos,t);return this.pos=t===this.count?t:t+1,n},e.prototype.readInt8=function(){return this.buffer.readInt8(this.pos++)},e.prototype.readInt32=function(){var e=this.buffer.readInt32BE(this.pos);return this.pos+=4,e},e.prototype.readInt64=function(){var e=this.buffer.readInt32BE(this.pos);this.pos+=4;var t=this.buffer.readInt32BE(this.pos);return this.pos+=4,oe.fromBits(t,e,!1)},e.prototype.readUInt64=function(){var e=this.buffer.readInt32BE(this.pos);this.pos+=4;var t=this.buffer.readInt32BE(this.pos);return this.pos+=4,oe.fromBits(t,e,!0)},e.prototype.hasRemaining=function(){return this.pos<this.buffer.length},e}();Xy.BufferInputStream=Zy;var ev={};(function(e){"use strict";Object.defineProperty(ev,"__esModule",{value:!0});var t=function(){function t(t){void 0===t&&(t=32),"number"==typeof t?(this.buffer=e.alloc(t),this.count=0):(this.buffer=t,this.count=t.length)}return t.prototype.write=function(e){this.ensureCapacity(this.count+1),this.buffer[this.count++]=e},t.prototype.writeMany=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length),0!==r&&(this.ensureCapacity(this.count+r),e.copy(this.buffer,this.count,t,t+r),this.count+=r)},t.prototype.writeString=function(t){var r=e.byteLength(t);this.ensureCapacity(this.count+r),this.buffer.write(t,this.count,r),this.count+=r},t.prototype.writeInt8=function(e){this.ensureCapacity(this.count+1),this.buffer.writeInt8(e,this.count++)},t.prototype.writeInt32=function(e){this.ensureCapacity(this.count+4),this.buffer.writeInt32BE(e,this.count),this.count+=4},t.prototype.writeInt64=function(e){this.ensureCapacity(this.count+8),this.buffer.writeInt32BE(e.getHighBits(),this.count),this.buffer.writeInt32BE(e.getLowBits(),this.count+4),this.count+=8},t.prototype.getBuffer=function(){return this.buffer.slice(0,this.count)},t.prototype.getBase64=function(){return this.getBuffer().toString("base64")},t.prototype.ensureCapacity=function(e){e-this.buffer.length>0&&this.grow(e)},t.prototype.grow=function(t){var r=this.buffer.length<<1;r-t<0&&(r=t);try{var n=e.alloc(r);this.buffer.copy(n),this.buffer=n}catch(e){throw new Error("Unable to resize BufferOutputStream to "+r)}},t}();ev.BufferOutputStream=t}).call(this,r({}).Buffer);var tv={};Object.defineProperty(tv,"__esModule",{value:!0}),tv.PROTOCOL={TYPE:"WB",CAPABILITIES:function(){try{if(require("zlib"))return!0}catch(e){return!1}return!1}()?10:8,PROTOCOL_BYTE:35,CURRENT_VERSION:18};var rv={};Object.defineProperty(rv,"__esModule",{value:!0});var nv=function(){function e(e,t){this.encodingByte=e,this.messageTypeFlags=t}return e.extractMessageType=function(e){return~11e6&e},e.extractMessageEncoding=function(e){return 128===(11e6&e)?rv.EncodingType.ZLIB:rv.EncodingType.NO_ENCODING},e}();rv.MessageEncoding=nv,rv.EncodingType={NO_ENCODING:new nv(0,0),ZLIB:new nv(18,1)};var ov={};Object.defineProperty(ov,"__esModule",{value:!0}),ov.isObjectAs=function(e){return e instanceof Object};var iv={};(function(e){"use strict";var r,n=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(iv,"__esModule",{value:!0});var o,i,s,a=$y.create("Message");10===tv.PROTOCOL.CAPABILITIES?o=t({}):(a.warn("Per message compression is disabled because 'zlib' bundle is not included"),o=null),function(e){e[e.SERVICE_REQUEST=0]="SERVICE_REQUEST",e[e.SERVICE_RESPONSE=6]="SERVICE_RESPONSE",e[e.SERVICE_ERROR=7]="SERVICE_ERROR",e[e.TOPIC_VALUE=4]="TOPIC_VALUE",e[e.TOPIC_DELTA=5]="TOPIC_DELTA",e[e.ABORT_NOTIFICATION=28]="ABORT_NOTIFICATION",e[e.CLOSE_REQUEST=29]="CLOSE_REQUEST",e[e.FETCH_REPLY=34]="FETCH_REPLY"}(i=iv.types||(iv.types={})),function(e){e[e.NONE=0]="NONE",e[e.ENCRYPTION_REQUESTED=1]="ENCRYPTION_REQUESTED",e[e.COMPRESSION_REQUESTED=2]="COMPRESSION_REQUESTED",e[e.BASE64_REQUESTED=3]="BASE64_REQUESTED",e[e.ENCRYPTED=17]="ENCRYPTED",e[e.COMPRESSED=18]="COMPRESSED",e[e.BASE64=19]="BASE64"}(s=iv.encoding||(iv.encoding={}));var u=function(){function e(e,t,r,n,o){this.type=e,this.encoding=t,this.id=r.id,this.topic=r.topic,this.data=n,this.headers=o}return e.prototype.getInputStream=function(){return new Xy.BufferInputStream(this.data)},e}(),c=function(e){function t(t){var r=e.call(this,t.type,t.encoding,t,t.buffer,t.headers)||this;return r.stream=new ev.BufferOutputStream(t.buffer),r}return n(t,e),t.prototype.getStream=function(){return this.stream},t.prototype.getBuffer=function(){return this.stream.getBuffer()},t}(u);iv.parse=function(e,t){var r=new Xy.BufferInputStream(e),n=r.read(),a=rv.MessageEncoding.extractMessageType(n),c=rv.MessageEncoding.extractMessageEncoding(n);if(void 0===i[a]&&t(new Error("Invalid message type: "+a),null),a===i.SERVICE_REQUEST||a===i.SERVICE_RESPONSE||a===i.SERVICE_ERROR)t(null,function(e,t){var r=t.readMany(t.count);return new u(e,s.NONE,{},r,[])}(a,r));else if(a===i.TOPIC_VALUE||a===i.TOPIC_DELTA)!function(e,t,r,n){var i=[],a={id:r.readInt32()};if(t===rv.EncodingType.ZLIB&&null!==o)try{var c=o.decompressSync(r.readMany(r.count));n(null,new u(e,s.COMPRESSED,a,c,i))}catch(e){n(e,null)}else n(null,new u(e,s.NONE,a,r.readMany(r.count),i))}(a,c,r,t);else{var p=r.readUntil(1).toString().split(""),f=r.readMany(r.count),l=a===i.FETCH_REPLY?p.shift():void 0;t(null,new u(a,s.NONE,{topic:l},f,p))}},iv.create=function(t){var r;if(void 0===t||"number"==typeof t&&void 0===i[t])throw new Error("Invalid message type: "+t);return(r=ov.isObjectAs(t)?t:{type:t}).encoding=r.encoding||0,r.headers=r.headers||[],r.buffer=r.buffer||e.alloc(0),new c(r)},iv.writeToBuffer=function(e,t){t.write(e.type),t.writeString(function(e){return e.type!==i.FETCH_REPLY?"":[e.topic].concat(e.headers).join("")+""}(e)),t.writeMany(e.getBuffer())}}).call(this,r({}).Buffer);var sv={};Object.defineProperty(sv,"__esModule",{value:!0}),sv.enumerize=function(e){Object.keys(e).forEach(function(t){var r=e[t].id;void 0!==r&&(e[r]=t)})};var av={};Object.defineProperty(av,"__esModule",{value:!0}),av.ErrorReason={COMMUNICATION_FAILURE:new re.ErrorReason(100,"Communication with server failed"),SESSION_CLOSED:new re.ErrorReason(101,"Session is closed"),REQUEST_TIME_OUT:new re.ErrorReason(102,"Request time out"),ACCESS_DENIED:new re.ErrorReason(103,"Access denied"),UNSUPPORTED:new re.ErrorReason(104,"Unsupported service"),CALLBACK_EXCEPTION:new re.ErrorReason(105,"An application callback threw an exception. Check logs for more information"),INVALID_DATA:new re.ErrorReason(106,"Invalid data"),NO_SUCH_SESSION:new re.ErrorReason(107,"A requested session could not be found"),INCOMPATIBLE_DATATYPE:new re.ErrorReason(108,"Data type is incompatible"),UNHANDLED_MESSAGE:new re.ErrorReason(109,"A message was not handled"),CLUSTER_REPARTITION:new re.ErrorReason(110,"The cluster was repartitioning and the request could not be routed."),INCOMPATIBLE_STATE:new re.ErrorReason(111,"Topic operation not performed because it is managed by a component that prohibits external updates"),CLUSTER_ROUTING:new re.ErrorReason(112,"The cluster operation could not be routed."),TOPIC_TREE_REGISTRATION_CONFLICT:new re.ErrorReason(200,"A conflicting registration exists on the same branch of the topic tree"),HANDLER_CONFLICT:new re.ErrorReason(201,"Conflict with an existing handler"),INVALID_PATH:new re.ErrorReason(202,"Invalid path"),REJECTED_REQUEST:new re.ErrorReason(9003,"A request has been rejected by the recipient session")},sv.enumerize(av.ErrorReason);var uv={};Object.defineProperty(uv,"__esModule",{value:!0});var cv=$y.create("ServiceAdapter"),pv={respond:function(){},fail:function(){}},fv=function(){function e(e,t){this.listeners={},this.internalSession=e,this.sender=t}return e.prototype.sendRequest=function(e,t,r){var n=iv.create({type:iv.types.SERVICE_REQUEST}),o=n.getStream();Gy.CommandHeaderSerialiser.write(o,e),r.write(o,t),cv.debug("Sending command request: "+e,t),this.sender(n)},e.prototype.sendResponse=function(e,t,r){var n=iv.create({type:iv.types.SERVICE_RESPONSE}),o=n.getStream();Gy.ResponseCommandHeaderSerialiser.write(o,e),r.write(o,t),cv.debug("Sending command response: "+e,t),this.sender(n)},e.prototype.sendError=function(e,t,r){var n=iv.create({type:iv.types.SERVICE_ERROR}),o=n.getStream();Gy.ResponseCommandHeaderSerialiser.write(o,e),jy.writeString(o,r),jy.writeInt32(o,t.id),cv.debug("Sending command error: "+t.id,r),this.sender(n)},e.prototype.addService=function(e,t){var r=this;if(void 0!==this.listeners[e.id])throw new Error("Service already exists for service "+e.id);var n=e.request,o=e.response;this.listeners[e.id]=function(i,s){var a=n.read(s),u=i.cid.equals(Pe.ONEWAY_CID)?pv:{respond:function(e){var t=i.createResponseHeader();r.sendResponse(t,e,o)},fail:function(e,t){var n=i.createErrorHeader();throw r.sendError(n,e,t),e}};try{t.onRequest(r.internalSession,a,u)}catch(t){throw cv.error(t),new Error("Unable to handle request for service "+e.id)}}},e.prototype.isServiceRegistered=function(e){return void 0!==this.listeners[e]},e.prototype.onMessage=function(e,t){switch(e){case iv.types.SERVICE_REQUEST:this.handleRequest(Gy.CommandHeaderSerialiser.read(t),t);break;case iv.types.SERVICE_RESPONSE:this.handleResponse(Uy.CIDSerialiser.read(t),t);break;case iv.types.SERVICE_ERROR:this.handleError(Uy.CIDSerialiser.read(t),t);break;default:throw new Error("Unknown Command Service message "+e)}},e.prototype.handleRequest=function(e,t){var r=this.listeners[e.service];r?(cv.debug("Received command request for service: "+e),r(e,t)):(cv.error("Received command request for unknown service: "+e),this.sendError(e.createErrorHeader(),av.ErrorReason.COMMUNICATION_FAILURE,"Unknown client service: "+e.service))},e.prototype.handleResponse=function(e,t){cv.debug("Received command response: "+e),this.internalSession.getConversationSet().respondIfPresent(e,t)},e.prototype.handleError=function(e,t){var r=jy.readString(t),n=jy.readInt32(t),o=new re.ErrorReason(n,r);cv.warn("Received command error",o),this.internalSession.getConversationSet().discard(e,o)},e}();uv.ServiceAdapter=fv;var lv={};Object.defineProperty(lv,"__esModule",{value:!0});var hv=$y.create("ServiceLocator"),dv=function(){function e(e,t){this.context=e,this.serviceAdapter=t}return e.prototype.obtain=function(e){var t=this,r=e.request,n=e.response;return{send:function(o,i){void 0===i&&(i=function(){});var s={onOpen:function(n){var s=new qy.CommandHeader(e.id,n);try{t.serviceAdapter.sendRequest(s,o,r)}catch(e){throw i(e),e}},onResponse:function(t,r){var o;try{o=n.read(r)}catch(t){return hv.debug("Failed to deserialise response from service "+e.id,t.stack),i(t),!0}try{i(null,o)}catch(t){hv.debug("Request callback for service '"+e.id+"' threw an error",t.stack);try{i(t)}catch(t){hv.debug("Failed to notify callback error for service '"+e.id+"'",t)}}return!0},onDiscard:function(e,t){i(t)}},a=t.context.getConversationSet(),u=a.newConversation(s);return function(){a.discard(u,new Error("Cancelled"))}}}},e}();lv.ServiceLocatorImpl=dv;var yv={};Object.defineProperty(yv,"__esModule",{value:!0});var vv=function(){function e(){this.valueClass=e}return e.prototype.name=function(){return"any"},e}();yv.AnyDataTypeImpl=vv;var _v,Sv={};Object.defineProperty(Sv,"__esModule",{value:!0}),function(e){e[e.UINT=0]="UINT",e[e.INT=1]="INT",e[e.BYTES=2]="BYTES",e[e.STRING=3]="STRING",e[e.ARRAY=4]="ARRAY",e[e.MAP=5]="MAP",e[e.SEMANTIC=6]="SEMANTIC",e[e.SIMPLE=7]="SIMPLE",e[e.FLOAT=7]="FLOAT"}(Sv.types||(Sv.types={})),function(e){e[e.FALSE=20]="FALSE",e[e.TRUE=21]="TRUE",e[e.NULL=22]="NULL",e[e.UNDEFINED=23]="UNDEFINED",e[e.SIMPLE=24]="SIMPLE",e[e.HALF_PRECISION=25]="HALF_PRECISION",e[e.SINGLE_PRECISION=26]="SINGLE_PRECISION",e[e.DOUBLE_PRECISION=27]="DOUBLE_PRECISION",e[e.BREAK=31]="BREAK"}(Sv.additional||(Sv.additional={})),function(e){e[e.ARRAY_START=0]="ARRAY_START",e[e.ARRAY_END=1]="ARRAY_END",e[e.MAP_START=2]="MAP_START",e[e.MAP_END=3]="MAP_END",e[e.STRING_START=4]="STRING_START",e[e.STRING_END=5]="STRING_END",e[e.VALUE=6]="VALUE"}(_v=Sv.tokens||(Sv.tokens={})),Sv.isStructStart=function(e){switch(e){case _v.ARRAY_START:case _v.MAP_START:case _v.STRING_START:return!0;default:return!1}},Sv.isStructEnd=function(e){switch(e){case _v.ARRAY_END:case _v.MAP_END:case _v.STRING_END:return!0;default:return!1}};var Ev,mv={};Object.defineProperty(mv,"__esModule",{value:!0}),function(e){e[e.root=0]="root",e[e.string=1]="string",e[e.array=2]="array",e[e.object=3]="object"}(Ev=mv.TokenContextType||(mv.TokenContextType={}));var wv=function(){function e(){this.ROOT={length:-1,type:Ev.root,read:0},this.stack=[],this.tail=this.ROOT}return e.prototype.type=function(){return this.tail.type},e.prototype.read=function(){return this.tail.read},e.prototype.expected=function(){return this.tail.length},e.prototype.push=function(e,t){void 0===t&&(t=-1),this.tail={length:t,type:e,read:0},this.stack.push(this.tail)},e.prototype.pop=function(){var e=this.stack.pop();return this.stack.length?this.tail=this.stack[this.stack.length-1]:this.tail=this.ROOT,e},e.prototype.next=function(){if(!this.hasRemaining())throw new Error("Exceeded expected collection limit");this.tail.read++},e.prototype.break=function(){this.acceptsBreakMarker()&&(this.tail.length=0,this.tail.read=0)},e.prototype.hasRemaining=function(){return-1===this.tail.length||this.tail.length>this.tail.read},e.prototype.acceptsBreakMarker=function(){return this.tail!==this.ROOT&&-1===this.tail.length},e}();mv.Context=wv;var gv={};(function(e){"use strict";var t=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(gv,"__esModule",{value:!0});var r=1<<24,n=4294967296;function o(e,t,r){for(var n=r?0:4,o=3;o>=0;--o)t[n+o]=255&e,e>>=8}function i(e,t){var n=t?0:4;return e[n]*r+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3]}var s=function(){function r(i,s){this.buffer=e.from([0,0,0,0,0,0,0,0]),e.isBuffer(i)&&(this.buffer=i),"string"==typeof i&&function(e,r,i){var s,a,u="-"===e[0];u?e=e.substring(1):"0x"===e.substring(0,2)&&(e=e.substring(2),r=16);var c=0,p=0;try{for(var f=t(e),l=f.next();!l.done;l=f.next()){var h=l.value;p=p*r+parseInt(h,r),c=c*r+Math.floor(p/n),p%=n}}catch(e){s={error:e}}finally{try{l&&!l.done&&(a=f.return)&&a.call(f)}finally{if(s)throw s.error}}u&&(c=~c,p?p=n-p:c++),o(c,i,!0),o(p,i,!1)}(i,s=s||10,this.buffer),"number"==typeof i&&("number"==typeof s?(o(i,this.buffer,!0),o(s,this.buffer,!1)):i>=0?function(e,t){for(var r=7;r>=0;--r)t[r]=255&e,e/=256}(i,this.buffer):function(e,t){e++;for(var r=7;r>=0;--r)t[r]=255&-e^255,e/=256}(i,this.buffer)),i instanceof r&&(o(i.getHighBits(),this.buffer,!0),o(i.getLowBits(),this.buffer,!1))}return r.toString=function(){return"Int64Impl"},r.prototype.getHighBits=function(){return i(this.buffer,!0)},r.prototype.getLowBits=function(){return i(this.buffer,!1)},r.prototype.toBuffer=function(){return this.buffer},r.prototype.toNumber=function(){var e=0|this.getHighBits(),t=this.getLowBits();return e?e*n+t:t},r.prototype.isNegative=function(){return!!(2147483648&this.getHighBits())},r.prototype.toString=function(e){void 0===e&&(e=10);var t=this.getHighBits(),r=this.getLowBits(),o=this.isNegative();if(o&&(t=~t,r=n-r),0===t&&0===r)return"0";for(var i="";t||r;){var s=t%e*n+r;t=Math.floor(t/e),r=Math.floor(s/e),i=(s%e).toString(e)+i}return o&&(i="-"+i),i},r.prototype.equals=function(e){return!!(e&&e instanceof r)&&(this.getHighBits()===e.getHighBits()&&this.getLowBits()===e.getLowBits())},r}();gv.Int64Impl=s}).call(this,r({}).Buffer);var Ov={};(function(e){"use strict";Object.defineProperty(Ov,"__esModule",{value:!0});var t=new Error,r=e.alloc(0),n=function(){function e(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length),this.bufferOffset=t,this.length=r,this.data=e,this.context=new mv.Context,this.pos=this.bufferOffset}return e.prototype.reset=function(){this.context=new mv.Context,this.token=void 0,this.type=void 0,this.pos=this.bufferOffset},e.prototype.hasRemaining=function(){var e=this.context.type()===mv.TokenContextType.root?this.length:this.length+1;return this.pos<this.bufferOffset+e},e.prototype.offset=function(){return this.pos},e.prototype.getContext=function(){return this.context},e.prototype.getToken=function(){return this.token},e.prototype.nextToken=function(){if(!this.hasRemaining())return null;var e=this.context.type(),t=this.pos;if(e!==mv.TokenContextType.root&&!this.context.hasRemaining()){switch(e){case mv.TokenContextType.object:this.type=Sv.tokens.MAP_END;break;case mv.TokenContextType.array:this.type=Sv.tokens.ARRAY_END;break;case mv.TokenContextType.string:this.type=Sv.tokens.STRING_END}return this.context.pop(),{pos:this.pos,type:this.type,getBuffer:function(){return r}}}this.context.next();var n,o=this.readHeader();switch(o.type){case Sv.types.INT:case Sv.types.UINT:case Sv.types.FLOAT:case Sv.types.SIMPLE:this.type=Sv.tokens.VALUE,n=this.readValue(o);break;case Sv.types.BYTES:case Sv.types.STRING:o.raw===Sv.additional.BREAK?(this.context.push(mv.TokenContextType.string,-1),this.type=Sv.tokens.STRING_START):(this.type=Sv.tokens.VALUE,n=this.readValue(o));break;case Sv.types.ARRAY:this.context.push(mv.TokenContextType.array,this.readCollectionLength(o)),this.type=Sv.tokens.ARRAY_START;break;case Sv.types.MAP:var i=this.readCollectionLength(o);i>=0&&(i*=2),this.context.push(mv.TokenContextType.object,i),this.type=Sv.tokens.MAP_START;break;case Sv.types.SEMANTIC:return this.nextToken();default:throw new Error("Unknown CBOR header type: "+o.type)}if(n instanceof Error){if(this.context.acceptsBreakMarker())return this.context.break(),this.nextToken();throw new Error("Unexpected break flag outside of indefinite-length context")}var s=this.data;return this.token={pos:t,type:this.type,value:n,header:o,length:this.pos,getBuffer:function(){return s.slice(this.pos,this.length)}},this.token},e.prototype.readValue=function(e){switch(e.type){case Sv.types.UINT:return this.readHeaderValue(e);case Sv.types.INT:return this.readHeaderValue(e,!0);case Sv.types.BYTES:return this.readBuffer(this.readHeaderValue(e));case Sv.types.STRING:return this.readBuffer(this.readHeaderValue(e)).toString("utf-8");case Sv.types.SIMPLE:return this.readSimpleValue(e.raw)}throw new Error("Unrecognised value type ("+e.type+")")},e.prototype.readSimpleValue=function(e){switch(e){case Sv.additional.TRUE:return!0;case Sv.additional.FALSE:return!1;case Sv.additional.NULL:return null;case Sv.additional.BREAK:return t;case Sv.additional.HALF_PRECISION:return this.readFloat16();case Sv.additional.SINGLE_PRECISION:return this.readFloat32();case Sv.additional.DOUBLE_PRECISION:return this.readFloat64();default:return}},e.prototype.readByte=function(){if(this.pos<this.data.length)return this.data[this.pos++];throw new Error("Exhausted token stream")},e.prototype.readBuffer=function(e){return this.data.slice(this.pos,this.pos+=e)},e.prototype.readUint16=function(){var e=this.data.readUInt16BE(this.pos);return this.pos+=2,e},e.prototype.readUint32=function(){var e=this.data.readUInt32BE(this.pos);return this.pos+=4,e},e.prototype.readUint64=function(e){var t=new gv.Int64Impl(this.readBuffer(8)),r=t.toNumber();return r<=9007199254740991&&r>=-9007199254740991?e?-1-r:r:t},e.prototype.readFloat16=function(){var e=this.readUint16(),t=1023&e,r=(31744&e)>>10,n=(32768&e)>>15?-1:1;return 0===r?n*Math.pow(2,-14)*(t/Math.pow(2,10)):31===r?t?NaN:n*(1/0):n*Math.pow(2,r-15)*(1+t/Math.pow(2,10))},e.prototype.readFloat32=function(){var e=this.data.readFloatBE(this.pos);return this.pos+=4,e},e.prototype.readFloat64=function(){var e=this.data.readDoubleBE(this.pos);return this.pos+=8,e},e.prototype.readHeader=function(){var e=this.readByte();return{type:e>>5,raw:31&e}},e.prototype.readHeaderValue=function(e,r){void 0===r&&(r=!1);var n=e.raw,o=function(e){return r?-1-e:e};if(n<24)return o(n);switch(n){case Sv.additional.SIMPLE:return o(this.readByte());case Sv.additional.HALF_PRECISION:return o(this.readUint16());case Sv.additional.SINGLE_PRECISION:return o(this.readUint32());case Sv.additional.DOUBLE_PRECISION:return this.readUint64(r);case Sv.additional.BREAK:return t;default:throw new Error("Unexpected value "+n)}},e.prototype.readCollectionLength=function(e){var r=this.readHeaderValue(e);return r===t?-1:r},e}();Ov.Tokeniser=n}).call(this,r({}).Buffer);var Tv={};Object.defineProperty(Tv,"__esModule",{value:!0});var Iv=function(){return function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length),this.$buffer=e,this.$offset=t,this.$length=r}}();Tv.BufferSlice=Iv;var Rv=function(e){return null!=e&&(bv(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&bv(e.slice(0,0))}(e)||!!e._isBuffer)};function bv(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var Cv={};(function(e){"use strict";var t,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(Cv,"__esModule",{value:!0});var n=function(t){function n(e,r,n){return void 0===r&&(r=0),void 0===n&&(n=e.length),t.call(this,e,r,n)||this}return r(n,t),n.prototype.visit=function(t){if(this.hasChanges()){for(var r=new Ov.Tokeniser(this.$buffer,this.$offset,this.$length);r.hasRemaining();){var n=r.nextToken(),o=!1;if(e.isBuffer(n.value))o=!t.insert(n.value);else{var i=n.value,s=r.nextToken().value;o=!t.match(i,s)}if(o)return void t.end()}t.end()}else t.noChange()},n.prototype.hasChanges=function(){return 1!==this.$length},n}(Tv.BufferSlice);Cv.BinaryDeltaImpl=n}).call(this,{isBuffer:Rv});var Pv={};(function(e){"use strict";Object.defineProperty(Pv,"__esModule",{value:!0});var t=function(){function t(t,r,n){this.tokeniser=e.isBuffer(t)?new Ov.Tokeniser(t,r,n):t}return t.prototype.hasRemaining=function(){return this.tokeniser.hasRemaining()},t.prototype.nextValue=function(){return this.nextValueExpecting(r)},t.prototype.nextValueExpecting=function(t){if(!this.tokeniser.hasRemaining())throw new Error("Token stream exhausted");var r=this.tokeniser.nextToken();if(t(r.header.type))return function t(r,n){switch(r.type){case Sv.tokens.VALUE:return r.value;case Sv.tokens.MAP_START:for(var o={};;){var i=n.nextToken();if(null===i)throw new Error("Unexpected EOF (reading: map key)");if(i.type===Sv.tokens.MAP_END)break;var s=n.nextToken();if(null===s||s.type===Sv.tokens.MAP_END)throw new Error("Unexpected EOF (reading: map value)");var a=t(i,n);if(null==a)throw new Error("Cannot have undefined key (reading: map key)");o[a.toString()]=t(s,n)}return o;case Sv.tokens.ARRAY_START:for(var u=[];;){var c=n.nextToken();if(null===c)throw new Error("Unexpected EOF (reading: array value)");if(c.type===Sv.tokens.ARRAY_END)break;u.push(t(c,n))}return u;case Sv.tokens.STRING_START:for(var p=[];;){var f=n.nextToken();if(null===f)throw new Error("Unexpected EOF (reading: indefinite-length string");if(f.type===Sv.tokens.STRING_END)break;if(f.header.type!==r.header.type)throw new Error("Unexpected chunk type ("+f.header.type+") within string");p.push(f.value)}switch(r.header.type){case Sv.types.BYTES:return e.concat(p);case Sv.types.STRING:return p.join("");default:throw new Error("Unexpected chunk type ("+r.header.type+") (reading: string)")}default:throw new Error("Unexpected token: "+JSON.stringify(r))}}(r,this.tokeniser);throw new Error("Unexpected CBOR type")},t}();function r(){return!0}Pv.Decoder=t,Pv.isDouble=function(e){return e===Sv.types.FLOAT},Pv.isInt64=function(e){return e===Sv.types.UINT||e===Sv.types.INT},Pv.isString=function(e){return e===Sv.types.STRING}}).call(this,r({}).Buffer);var Av={};(function(e){"use strict";var t=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(Av,"__esModule",{value:!0});var r=function(){function r(){this.bos=new ev.BufferOutputStream}return r.prototype.writeByte=function(e){this.bos.write(e)},r.prototype.writeBuffer=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length),this.bos.writeMany(e,t,r)},r.prototype.writeUint16=function(e){this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.writeUint32=function(e){this.writeUint16(e>>16&65535),this.writeUint16(65535&e)},r.prototype.writeUint64=function(e){this.writeUint32(Math.floor(e/4294967296)),this.writeUint32(e%4294967296)},r.prototype.writeBreakHeader=function(e){this.writeByte(e<<5|Sv.additional.BREAK)},r.prototype.writeToken=function(e,t){var r=e<<5;t<24?this.writeByte(r|t):t<256?(this.writeByte(24|r),this.writeByte(t)):t<65536?(this.writeByte(25|r),this.writeUint16(t)):t<4294967296?(this.writeByte(26|r),this.writeUint32(t)):(this.writeByte(27|r),this.writeUint64(t))},r.prototype.writeNumber=function(t){if(t.toString().indexOf(".")>-1){var r=e.alloc(8);r.writeDoubleBE(t,0),this.writeByte(Sv.types.SIMPLE<<5|Sv.additional.DOUBLE_PRECISION),this.writeBuffer(r)}else t<0?this.writeToken(Sv.types.INT,-1-t):this.writeToken(Sv.types.UINT,t)},r.prototype.writeString=function(t){var r=e.from(t,"utf-8");this.writeToken(Sv.types.STRING,r.length),this.writeBuffer(r)},r.prototype.writeBinary=function(e,t,r){void 0===r&&(r=e.length),this.writeToken(Sv.types.BYTES,r),this.writeBuffer(e,t,r)},r.prototype.writeBoolean=function(e){this.writeToken(Sv.types.SIMPLE,e?Sv.additional.TRUE:Sv.additional.FALSE)},r.prototype.writeUndefined=function(){this.writeToken(Sv.types.SIMPLE,Sv.additional.UNDEFINED)},r.prototype.writeNull=function(){this.writeToken(Sv.types.SIMPLE,Sv.additional.NULL)},r.prototype.writeObject=function(e){var r,n,o=Object.getOwnPropertyNames(e);this.startObject(o.length);try{for(var i=t(o),s=i.next();!s.done;s=i.next()){var a=s.value;this.encode(a),this.encode(e[a])}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},r.prototype.writeArray=function(e){var r,n;this.startArray(e.length);try{for(var o=t(e),i=o.next();!i.done;i=o.next()){var s=i.value;this.encode(s)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},r.prototype.break=function(){return this.writeBreakHeader(Sv.types.SIMPLE),this},r.prototype.startArray=function(e){return void 0===e?this.writeBreakHeader(Sv.types.ARRAY):this.writeToken(Sv.types.ARRAY,e),this},r.prototype.startObject=function(e){return void 0===e?this.writeBreakHeader(Sv.types.MAP):this.writeToken(Sv.types.MAP,e),this},r.prototype.writeInt64=function(e){return e.isNegative()?this.writeByte(Sv.types.INT<<5|27):this.writeByte(Sv.types.UINT<<5|27),this.writeBuffer(e.toBuffer()),this},r.prototype.writeDouble=function(t){var r=e.alloc(8);return r.writeDoubleBE(t,0),this.writeByte(Sv.types.SIMPLE<<5|Sv.additional.DOUBLE_PRECISION),this.writeBuffer(r),this},r.prototype.encode=function(t,r,n){if(t instanceof Date)this.writeString(t.toJSON());else if(null===t)this.writeNull();else if(void 0===t)this.writeUndefined();else if(t instanceof gv.Int64Impl)this.writeInt64(t);else switch(typeof t){case"boolean":this.writeBoolean(t);break;case"string":this.writeString(t);break;case"number":this.writeNumber(t);break;case"object":e.isBuffer(t)?this.writeBinary(t,r,n):Array.isArray(t)?this.writeArray(t):this.writeObject(t)}return this},r.prototype.flush=function(){var e=this.bos.getBuffer();return this.bos=new ev.BufferOutputStream,e},r}();Av.Encoder=r}).call(this,r({}).Buffer);var Nv={};Object.defineProperty(Nv,"__esModule",{value:!0}),Nv.approximateSquareRoot=function(e){if(e<0)throw new Error("Value must be great or equal to 0");if(0===e)return 0;var t=32-function(e){if(0===e)return 32;var t=1;return e>>>16==0&&(t+=16,e<<=16),e>>>24==0&&(t+=8,e<<=8),e>>>28==0&&(t+=4,e<<=4),e>>>30==0&&(t+=2,e<<=2),t-=e>>>31}(e);return 1<<Math.round(t/2)},Nv.findNextPowerOfTwo=function(e){if(e<0||e>1<<30)throw new Error("Illegal argument: "+e);return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},Nv.intBitsToFloat=function(e){var t=2147483648&e?-1:1,r=(e>>23&255)-127,n=8388607&e;if(128===r)return t*(n?Number.NaN:Number.POSITIVE_INFINITY);if(-127===r){if(0===n)return 0*t;r=-126,n/=1<<22}else n=(n|1<<23)/(1<<23);return t*n*Math.pow(2,r)},Nv.MAX_INT32=2147483647,Nv.MAX_SAFE_INTEGER=9007199254740991;var Mv={},Lv=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(Mv,"__esModule",{value:!0});var Dv=1e4,jv=2147483647;Mv.SUCCESS=0,Mv.REPLACE=1,Mv.NO_CHANGE=2;var Uv=function(){function e(e){this.maximumD=(e-3)/4,this.vectorLength=0,this.vector=[]}return e.prototype.fill=function(e){for(var t=e;t<this.vectorLength+4;t+=4)this.vector[t+0]=-1,this.vector[t+1]=-1,this.vector[t+2]=2147483647,this.vector[t+3]=2147483647},e.prototype.ensure=function(e){this.vectorLength=4*(e+1)+3},e.prototype.initialise=function(e){return this.ensure(e),this.fill(3),this.vector},e.prototype.extend=function(e){if(e>this.maximumD)return null;var t=this.vectorLength;return this.ensure(e),this.fill(t),this.vector},e}();function xv(e){return e<0?-4*e-1:4*e}function Bv(e){return xv(e)+2}function kv(e,t){var r=e[xv(t)];return void 0===r?0:r}function qv(e,t){var r=e[Bv(t)];return void 0===r?0:r}function Vv(e,t,r){e[xv(t)]=r}function Fv(e,t,r){e[Bv(t)]=r}function Gv(e,t){var r=kv(e,t+1),n=kv(e,t-1);return r<n?n:r+1}function Hv(e,t){var r=qv(e,t+1),n=qv(e,t-1);return r<n?r:n-1}function Wv(e,t){return e<=t?e:2*t-e}function Yv(e,t,r){if(t<0)throw new Error("offset "+t+" < 0");if(r<0)throw new Error("length "+r+" < 0");if(t+r>e.length||t+r<0)throw new Error("offset "+t+" + "+r+" > "+e.length)}var zv=function(){function e(e,t,r,n,o){this.storage=e,this.a=t,this.b=r,this.script=n,this.bailOutFactor=o}return e.prototype.diff=function(e,t,r,n,o){void 0===o&&(o=this.bailOutFactor),Yv(this.a,e,t),Yv(this.b,r,n);var i=this.afterCommonPrefix(e,t,r,n),s=this.beforeCommonSuffix(e,t,r,n,i),a=s+n-t;return!!this.script.match(e,i)&&((i===s?this.script.insert(r+i,a-i):i===a?this.script.delete():this.middleSnake(e+i,s-i,r+i,a-i,o))&&this.script.match(e+s,t-s))},e.prototype.afterCommonPrefix=function(e,t,r,n){for(var o=Math.min(t,n),i=0;i<o;++i)if(this.a[e+i]!==this.b[r+i])return i;return Math.max(0,o)},e.prototype.beforeCommonSuffix=function(e,t,r,n,o){for(var i=Math.max(0,t-n)+o,s=t;s>i;--s)if(this.a[e+s-1]!==this.b[r+s+n-t-1])return s;return Math.min(t,i)},e.prototype.diffNoPrefix=function(e,t,r,n,o){void 0===o&&(o=this.bailOutFactor);var i=this.beforeCommonSuffix(e,t,r,n,0),s=i+n-t;return(0===i?this.script.insert(r,s):0===s?this.script.delete():this.middleSnake(e,i,r,s,o))&&this.script.match(e+i,t-i)},e.prototype.diffNoSuffix=function(e,t,r,n,o){void 0===o&&(o=this.bailOutFactor);var i=this.afterCommonPrefix(e,t,r,n);return!!this.script.match(e,i)&&(i===t?this.script.insert(r+i,n-i):i===n?this.script.delete():this.middleSnake(e+i,t-i,r+i,n-i,o))},e.prototype.middleSnake=function(e,t,r,n,o){var i=t-n,s=1&i,a=this.storage.initialise(1);Vv(a,0,0),Fv(a,0,t);var u=1,c=o;do{for(var p=Wv(u,t),f=Wv(u,n),l=-p;l<=f;l+=2){var h=Gv(a,l),d=h+this.afterCommonPrefix(e+h,t-h,r+h+l,n-l-h);if(s&&Math.abs(l+i)<=u-1&&d>=qv(a,l+i))return this.recurse(e,t,r,n,h,d,l);Vv(a,l,d)}for(var y=-f;y<=p;y+=2){var v=Hv(a,y),_=y-i,S=this.beforeCommonSuffix(e,v,r,_+v,0);if(!s&&Math.abs(_)<=u&&S<=kv(a,_))return this.recurse(e,t,r,n,S,v,_);Fv(a,y,S)}if(0==(63&u)&&this.slowProgress(a,t,n,p,f,u))c-=48;else if(u>Math.max(4,c))return this.bail(a,e,t,r,n,p,f,Math.trunc(c/2));++u,a=this.storage.extend(u)}while(null!==a);return!1},e.prototype.slowProgress=function(e,t,r,n,o,i){var s=Lv(this.bestForward(e,t,r,n,o),2),a=s[0],u=s[1],c=Lv(this.bestReverse(e,t,r,n,o),2);return a+u+(t+r-c[0]-c[1])<Nv.approximateSquareRoot(i)*i},e.prototype.bestForward=function(e,t,r,n,o){for(var i=0,s=0,a=-n;a<=o;a+=2){var u=Math.min(kv(e,a),t,r-a),c=u+a;u+c>i+s&&(i=u,s=c)}return[i,s]},e.prototype.bestReverse=function(e,t,r,n,o){for(var i=t,s=r,a=-o;a<=n;a+=2){var u=a-(t-r),c=Math.max(qv(e,a),0,-u),p=c+u;c+p<i+s&&(i=c,s=p)}return[i,s]},e.prototype.recurse=function(e,t,r,n,o,i,s){return this.diffNoPrefix(e,o,r,o+s)&&this.script.match(e+o,i-o)&&this.diffNoSuffix(e+i,t-i,r+i+s,n-i-s)},e.prototype.bail=function(e,t,r,n,o,i,s,a){var u=Lv(this.bestForward(e,r,o,i,s),2),c=u[0],p=u[1],f=Lv(this.bestReverse(e,r,o,i,s),2),l=f[0],h=f[1];return c>=l||p>=h?r+o-l-h>c+p?this.splitDiff(t,l,r,n,h,o):this.splitDiff(t,c,r,n,p,o):this.diffNoPrefix(t,c,n,p)&&this.boundedDiff(t+c,l-c,n+p,h-p,r,o,a)&&this.diffNoSuffix(t+l,r-l,n+h,o-h)},e.prototype.boundedDiff=function(e,t,r,n,o,i,s){var a=o*i;if(t*n>=Math.floor((1<<24)+a/2)){if(s<=0){var u=Math.trunc(t/4),c=u+Math.trunc(t/2),p=Math.trunc(n/4),f=p+Math.trunc(n/2);return this.noDiff(r,p)&&this.diff(e+u,c-u,r+p,f-p,s)&&this.noDiff(r+f,n-f)}var l=Math.trunc(t/2),h=Math.trunc(n/2);return this.splitDiff(e,l,t,r,h,n,s)}return this.middleSnake(e,t,r,n,s)},e.prototype.splitDiff=function(e,t,r,n,o,i,s){return this.diffNoPrefix(e,t,n,o,s)&&this.diffNoSuffix(e+t,r-t,n+o,i-o,s)},e.prototype.noDiff=function(e,t){return this.script.insert(e,t)&&this.script.delete()},e}();function Jv(e,t,r){return e.insert(t,r)}function $v(e,t,r){return e.match(t,r)}function Kv(){return!0}function Qv(e,t,r){var n=!0,o=0,i=0,s=Kv;function a(){return n=n&&s===Kv,s(e,i,o)}function u(e,t,r){if(r>0)if(s!==e){if(!a())return!1;s=e,i=t,o=r}else o+=r;return!0}return{insert:function(e,t){return u(Jv,e-r,t)},match:function(e,r){return u($v,e-t,r)},delete:function(e,t){if(s===Jv)return!0;var r=a();return s=Kv,r},close:function(t,r){if(n){if(s===Jv)return Mv.REPLACE;if(0===i&&o===t)return Mv.NO_CHANGE}return a()&&e.close()?Mv.SUCCESS:Mv.REPLACE}}}var Xv=function(){function e(e,t){void 0===e&&(e=jv),void 0===t&&(t=Dv),this.bailOutFactor=t,this.storage=new Uv(e)}return e.prototype.diff=function(e,t,r,n,o,i,s){var a=Qv(s,t,o);return new zv(this.storage,e,n,a,this.bailOutFactor).diff(t,r,o,i)?a.close(r,i):Mv.REPLACE},e}();Mv.MyersBinaryDiff=Xv;var Zv={};(function(e){"use strict";Object.defineProperty(Zv,"__esModule",{value:!0});var t=new Av.Encoder;function r(e){return e<24?1:e<255?2:e<=65535?3:5}function n(e,t,n){var o=r(e)+1;return r(t+n)-r(n)+t<=o}Zv.NO_CHANGE=new Cv.BinaryDeltaImpl(e.from([-10]),0,1);var o=function(){function e(e,t,r,n){this.insertStart=-1,this.matchStart=-1,this.cborEncoder=e,this.buffer=t,this.offset=r,this.blowsBudget=n}return e.prototype.insert=function(e,t){if(-1!==this.matchStart){if(n(this.matchStart,this.matchLength,t))return this.matchStart=-1,-1===this.insertStart?(this.insertStart=e-this.matchLength,this.insertLength=this.matchLength+t):this.insertLength+=this.matchLength+t,!0;if(!this.flush())return!1}return-1===this.insertStart?(this.insertStart=e,this.insertLength=t):this.insertLength+=t,!0},e.prototype.match=function(e,t){if(-1!==this.matchStart){if(!this.flush())return!1}else if(-1!==this.insertStart&&n(e,t,this.insertLength))return this.insertLength+=t,!0;return this.matchStart=e,this.matchLength=t,!0},e.prototype.delete=function(e,t){return!0},e.prototype.close=function(){return this.flush()},e.prototype.flush=function(){return(-1===this.insertStart||this.writeInsert())&&(-1===this.matchStart||this.writeMatch())},e.prototype.writeInsert=function(){return!this.blowsBudget(this.insertLength+r(this.insertLength))&&(t.encode(this.buffer,this.offset+this.insertStart,this.insertLength),this.insertStart=-1,!0)},e.prototype.writeMatch=function(){return!this.blowsBudget(r(this.matchStart)+r(this.matchLength))&&(this.cborEncoder.encode(this.matchStart),this.cborEncoder.encode(this.matchLength),this.matchStart=-1,!0)},e}(),i=function(){function r(e,t,r){this.binaryDiff=new Mv.MyersBinaryDiff,this.implementation=e,this.cToV=r,this.vToC=t}return r.prototype.name=function(){return"binary"},r.prototype.diff=function(e,r){var n,i=this.vToC(e),s=this.vToC(r),a=s.$buffer,u=s.$offset,c=s.$length,p=c,f=new o(t,a,u,function(e){return(p-=e)<=0}),l=this.binaryDiff.diff(i.$buffer,i.$offset,i.$length,a,u,c,f),h=t.flush();switch(l){case Mv.REPLACE:return n=s,t.encode(n.$buffer,n.$offset,n.$length),new Cv.BinaryDeltaImpl(t.flush());case Mv.NO_CHANGE:return Zv.NO_CHANGE;default:return this.readDelta(h)}},r.prototype.apply=function(e,t){return this.applyImpl(e,t).value},r.prototype.applyImpl=function(t,r,n){var o=r,i=n||this.vToC(t);if(!r||!r.hasChanges())return{value:this.cToV(i),cbor:i};for(var s=new Pv.Decoder(o.$buffer),a=new ev.BufferOutputStream;s.hasRemaining();){var u=s.nextValue();e.isBuffer(u)?a.writeMany(u):"number"==typeof u&&a.writeMany(i.$buffer,i.$offset+u,s.nextValue())}var c=new this.implementation(a.getBuffer());return{value:this.cToV(c),cbor:c}},r.prototype.readDelta=function(e,t,r){var n=new Cv.BinaryDeltaImpl(e,t,r);return 1===n.$length&&e[n.$offset]===Zv.NO_CHANGE.$buffer[0]?Zv.NO_CHANGE:n},r.prototype.writeDelta=function(e){var t=e;return t.$buffer.slice(t.$offset,t.$offset+t.$length)},r.prototype.noChange=function(){return Zv.NO_CHANGE},r.prototype.isValueCheaper=function(e,t){return e.$length<=t.$length},r}();Zv.BinaryDeltaTypeImpl=i}).call(this,r({}).Buffer);var e_={},t_=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e_,"__esModule",{value:!0});var r_=function(e){function t(t,r,n){return void 0===r&&(r=0),void 0===n&&(n=t.length),e.call(this,t,r,n)||this}return t_(t,e),t.toString=function(){return"BytesImpl"},t.prototype.length=function(){return this.$length},t.prototype.asBuffer=function(){return this.$buffer.slice(this.$offset,this.$offset+this.$length)},t.prototype.copyTo=function(e,t){void 0===t&&(t=0),this.$buffer.copy(e,t,this.$offset,this.$offset+this.$length)},t.prototype.equals=function(e){return this.equalBytes(e.$buffer,e.$offset,e.$length)},t.prototype.equalBytes=function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=e.length),this.$length!==r)return!1;if(this.$buffer===e&&this.$offset===t)return!0;for(var n=0;n<r;++n)if(this.$buffer[this.$offset+n]!==e[t+n])return!1;return!0},t}(Tv.BufferSlice);e_.BytesImpl=r_;var n_={};Object.defineProperty(n_,"__esModule",{value:!0});var o_=function(){function e(e,t,r,n,o,i,s){var a=this;this.valueConverters={},this.typeName=e,this.cToV=o,this.vToC=n,this.implementation=r,i.forEach(function(e){a.valueConverters[e.toString()]=function(t,r,n){return new e(t,r,n)}}),this.valueConverters[e_.BytesImpl.toString()]=function(e,t,r){return new e_.BytesImpl(e,t,r)},this.valueConverters[t.toString()]=this.readValue.bind(this),this.valueConverters[yv.AnyDataTypeImpl.toString()]=this.readValue.bind(this),this.valueClass=t,s&&(this.binaryDeltaTypeImpl=new Zv.BinaryDeltaTypeImpl(r,n,o))}return e.prototype.name=function(){return this.typeName},e.prototype.toString=function(){return this.typeName+" data type"},e.prototype.writeValue=function(e){var t=this.vToC(e);if(null===t)throw new Error(this+" cannot write "+e);return t.asBuffer()},e.prototype.toBytes=function(e){var t=this.vToC(e);if(t)return t;throw new Error(this+" cannot convert value to Bytes: "+e)},e.prototype.readValue=function(e,t,r){return e instanceof e_.BytesImpl?e instanceof this.implementation?this.cToV(e):this.readValue(e.$buffer,e.$offset,e.$length):this.cToV(new this.implementation(e,t,r))},e.prototype.canReadAs=function(e){return void 0!==this.valueConverters[e.toString()]},e.prototype.readAs=function(e,t,r,n){if(t instanceof e_.BytesImpl)return this.readAs(e,t.$buffer,t.$offset,t.$length);if(this.valueConverters[e.toString()])return this.valueConverters[e.toString()](t,r,n);throw new Error(this+" is incompatible with values of "+e)},e.prototype.deltaType=function(e){if(!e||"binary"===e||e instanceof Cv.BinaryDeltaImpl)return this.binaryDeltaType();throw new Error(this+" has no '"+e+"' delta type")},e.prototype.binaryDeltaType=function(){if(void 0===this.binaryDeltaTypeImpl)throw new Error(this+" has no binary delta type");return this.binaryDeltaTypeImpl},e}();n_.AbstractDataType=o_;var i_={};function s_(e,t){switch(t.length){case 0:return e();case 1:return e(t[0]);case 2:return e(t[0],t[1]);case 3:return e(t[0],t[1],t[2]);case 4:return e(t[0],t[1],t[2],t[3]);case 5:return e(t[0],t[1],t[2],t[3],t[4]);case 6:return e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7])}return e.apply(e,t)}Object.defineProperty(i_,"__esModule",{value:!0}),i_.curryR=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return s_(e,r.concat(t))}},i_.callWithArguments=s_,i_.identity=function(e){return e};var a_={};(function(e){"use strict";var t,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});function n(t){if(t instanceof o)return t;if(e.isBuffer(t))return new o(t);throw new Error("Unable to read Binary value from: "+t)}Object.defineProperty(a_,"__esModule",{value:!0});var o=function(e){function t(t,r,n){return void 0===r&&(r=0),void 0===n&&(n=t.length),e.call(this,t,r,n)||this}return r(t,e),t.toString=function(){return"BinaryImpl"},t.from=function(e){return n(e)},t.prototype.get=function(){return this.asBuffer()},t.prototype.diff=function(e,t){return i.diff(e,this)},t.prototype.apply=function(e){return i.apply(this,e)},t.prototype.toString=function(){return"Binary <"+this.$length+" bytes> "+this.get().toString()},t}(e_.BytesImpl);a_.BinaryImpl=o;var i=new Zv.BinaryDeltaTypeImpl(o,n,i_.identity)}).call(this,{isBuffer:Rv});var u_={},c_=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(u_,"__esModule",{value:!0});var p_=function(e){function t(){var t=e.call(this,"binary",a_.BinaryImpl,a_.BinaryImpl,a_.BinaryImpl.from,i_.identity,[],!0)||this;return t.Binary=a_.BinaryImpl,t}return c_(t,e),t.prototype.from=function(e){return a_.BinaryImpl.from(e)},t.prototype.validate=function(){},t}(n_.AbstractDataType);u_.BinaryDataTypeImpl=p_;var f_={},l_=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(f_,"__esModule",{value:!0});var h_=function(){function e(e){this.index=e}return e.prototype.equals=function(t){return t===this||!!(t&&t instanceof e)&&t.index===this.index},e.prototype.toString=function(){return"/"+this.index},e}(),d_=new h_(0),y_=function(){function e(e){this.expression="/"+function(e){for(var t=0;t<e.length;++t){var r=e.charAt(t);if("/"===r||"~"===r){var n=e.length,o=[];o.push(e.substring(0,t));for(var i=t;i<n;++i){var s=e.charAt(i);"/"===s?o.push("~1"):"~"===s?o.push("~0"):o.push(s)}return o.join("")}}return e}(e)}return e.prototype.equals=function(t){return t===this||!!(t&&t instanceof e)&&t.expression===this.expression},e.prototype.toString=function(){return this.expression},e}(),v_=function(){function e(e){if(this.pos=0,""!==e&&"/"!==e.charAt(0))throw new Error("JSON Pointer expression must be empty or start with '/' : "+e);this.expression=e}return e.prototype.nextSegmentString=function(){for(var e=this.pos;this.pos<this.expression.length;++this.pos){var t=this.expression[this.pos];if("/"===t)break;if("~"===t){for(var r=[this.expression.substring(e,this.pos)],n=this.expression.length;this.pos<n;++this.pos){var o=this.expression.charAt(this.pos);if("/"===o)break;if("~"===o&&this.pos!==n-1){++this.pos;var i=this.expression.charAt(this.pos);"0"===i?r.push("~"):"1"===i?r.push("/"):(r.push("~"),r.push(i))}else r.push(o)}return r.join("")}}return this.expression.substring(e,this.pos)},e.prototype.maybeIndex=function(e){var t=e.length;if(0===t||t>10)return null;for(var r=0;r<t;++r){var n=e.charAt(r);if(n<"0"||n>"9")return null;if("0"===n&&0===r)return 1===t?d_:null}var o=parseInt(e,10);return o>Nv.MAX_INT32?null:new h_(o)},e.prototype.next=function(){if(this.pos===this.expression.length)return null;++this.pos;var e=this.nextSegmentString(),t=this.maybeIndex(e);return null!==t?t:new y_(e)},e}(),__=function(){function e(e){this.segments=e}return e.parse=function(t){if(t instanceof e)return t;for(var r=f_.ROOT,n=new v_(t);;){var o=n.next();if(null===o)return r;r=r.withSegment(o)}},e.prototype.withKey=function(e){return this.withSegment(new y_(e))},e.prototype.withIndex=function(e){return this.withSegment(new h_(e))},e.prototype.withSegment=function(t){return new e(this.segments.concat(t))},e.prototype.equalIgnoringIndexes=function(e){if(e===this)return!0;var t=this.segments.length;if(t!==e.segments.length)return!1;for(var r=0;r<t;++r){var n=this.segments[r],o=e.segments[r];if(n instanceof h_){if(o instanceof y_)return!1}else if(!n.equals(o))return!1}return!0},e.prototype.toString=function(){var e,t,r=[];try{for(var n=l_(this.segments),o=n.next();!o.done;o=n.next()){var i=o.value;r.push(i.toString())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r.join("")},e.prototype.equals=function(t){if(t===this)return!0;if(!(t&&t instanceof e))return!1;if(this.segments.length!==t.segments.length)return!1;for(var r=this.segments.length,n=0;n<r;++n){var o=this.segments[n],i=t.segments[n];if(!o.equals(i))return!1}return!0},e}();f_.JSONPointer=__,f_.ROOT=new __([]);var S_={};Object.defineProperty(S_,"__esModule",{value:!0}),S_.requireNonNull=function(e,t){if(null==e)throw new Error(t+" is null");return e};var E_={},m_=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(E_,"__esModule",{value:!0});var w_=function(){function e(e,t,r){this.segment=e,this.pointer=t,this.children=[],this.value=null,this.context=r}return e.prototype.count=function(){var e,t,r=this.value?1:0;try{for(var n=m_(this.children),o=n.next();!o.done;o=n.next()){r+=o.value.count()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype.addChild=function(t){var r=new e(t,this.pointer.withSegment(t),this.context);return this.children.push(r),r},e.prototype.findChild=function(e){var t,r;try{for(var n=m_(this.children),o=n.next();!o.done;o=n.next()){var i=o.value;if(e.equals(i.segment))return i}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return null},e.prototype.setValue=function(e){var t=this.value;return null===t&&this.context.size++,this.value=e,t},e.prototype.removeDescendants=function(){var e,t,r=0;try{for(var n=m_(this.children),o=n.next();!o.done;o=n.next()){r+=o.value.count()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return this.children=[],this.context.size-=r,r},e.prototype.numberOfChildren=function(){var e,t,r=0;try{for(var n=m_(this.children),o=n.next();!o.done;o=n.next()){r+=o.value.value?1:0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype.toString=function(){return this.pointer+"="+this.value},e}(),g_=function(){function e(e){this.nextChildIndex=0,this.node=e}return e.prototype.nextChild=function(){var e=this.node.children;return this.nextChildIndex>=e.length?null:e[this.nextChildIndex++]},e}(),O_=function(){function e(e){this.nextEntry=e(),this.nextWithValue=e}return e.prototype.hasNext=function(){return null!==this.nextEntry},e.prototype.next=function(){if(null===this.nextEntry)throw new Error("No such element");var e=this.nextEntry;return this.nextEntry=this.nextWithValue(),e},e}(),T_=function(){function e(){this.root=new w_(null,f_.ROOT,this),this.size=0}return e.prototype.put=function(e,t){S_.requireNonNull(t,"value");for(var r=this.root,n=0;n<e.segments.length;){var o=e.segments[n++],i=r.findChild(o);if(null===i){r=r.addChild(o);break}r=i}for(;n<e.segments.length;n++)r=r.addChild(e.segments[n]);return r.setValue(t)},e.prototype.contains=function(e){return null!==this.get(e)},e.prototype.get=function(e){var t=this.getEntry(e);return t?t.value:null},e.prototype.getEntry=function(e){var t,r,n=this.root;try{for(var o=m_(e.segments),i=o.next();!i.done;i=o.next()){var s=i.value;if(null===(n=n.findChild(s)))return null}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype.descendants=function(t){var r=new e,n=this.root,o=r.root,i=t.segments,s=i.length;if(0===s)return this;for(var a=0;a<s-1;++a){var u=i[a];if(null===(n=n.findChild(u)))return I_;o=o.addChild(u)}var c=n.findChild(i[s-1]);return null===c?I_:(o.children.push(c),r.size=c.count(),r)},e.prototype.intersection=function(t){var r=new e,n=this.root,o=r.root,i=t.segments,s=i.length;if(0===s)return this;null!==n.value&&o.setValue(n.value);for(var a=0;a<s-1;++a){var u=i[a];if(null===(n=n.findChild(u)))return r;o=o.addChild(u),null!==n.value&&o.setValue(n.value)}var c=n.findChild(i[s-1]);return null===c?r:(o.children.push(c),r.size+=c.count(),r)},e.prototype.iterator=function(){var e=[this.root];return new O_(function(){for(;;){var t=e.shift();if(void 0===t)return null;for(var r=t.children.length;r>0;--r)e.unshift(t.children[r-1]);if(null!==t.value)return t}})},e.prototype.postOrder=function(){var e=[new g_(this.root)];return new O_(function(){for(;;){var t=e[0];if(void 0===t)return null;var r=t.nextChild();if(null===r){if(e.shift(),null!==t.node.value)return t.node}else{if(0===r.children.length)return r;e.unshift(new g_(r))}}})},e.prototype.toString=function(){for(var e=["{"],t=this.iterator();t.hasNext();)e.length>1&&e.push(", "),e.push(t.next());return e.push("}"),e.join("")},e}();E_.JSONPointerMap=T_;var I_=new T_,R_={},b_=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),C_=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(R_,"__esModule",{value:!0});var P_=function(){function e(e,t,r,n){this.tokenRange=[],this.accumulatedTokens=0,this.totalTokens=0,this.tokeniser=e,this.base=t,this.startOffset=r,this.nextOffset=n}return e.prototype.total=function(){return this.totalTokens},e.prototype.accumulated=function(){return this.accumulatedTokens},e.prototype.newArray=function(e,t){return new A_(this.tokeniser,this.currentPointer(this.base,this.totalTokens),e,t)},e.prototype.newObject=function(e,t){return new N_(this.tokeniser,this.currentPointer(this.base,this.totalTokens),e,t)},e.prototype.notEmptyAndSplitBy=function(e){return this.startOffset<e&&0!==this.totalTokens},e.prototype.add=function(e){return this.tokenRange[this.accumulatedTokens]=[this.nextOffset,e],this.nextOffset=e,++this.accumulatedTokens,++this.totalTokens,!1},e.prototype.setNextStart=function(e){this.nextOffset=e},e.prototype.skip=function(){++this.totalTokens,this.accumulatedTokens=0},e.prototype.takeAll=function(e){for(var t=this.totalTokens-this.accumulatedTokens,r=0;r<this.accumulatedTokens;++r){var n=this.tokenRange[r],o=n[0],i=n[1];this.take(e,this.base,t,t+r,o,i-o)}this.accumulatedTokens=0},e.prototype.splitStructureEnd=function(e){e.splitStructureEnd(this.base,this.totalTokens,this.startOffset,this.nextOffset+1-this.startOffset)},e.prototype.toString=function(){return this.base.toString()},e}(),A_=function(e){function t(t,r,n,o){return e.call(this,t,r,n,o)||this}return b_(t,e),t.prototype.take=function(e,t,r,n,o,i){e.accept(t.withIndex(n),o,i)},t.prototype.currentPointer=function(e,t){return e.withIndex(t)},t}(P_),N_=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n,o)||this;return i.pendingKeyName="",i.pendingKey=!0,i.keys=[],i}return b_(t,e),t.prototype.add=function(t){return this.pendingKey?(this.setNextStart(t),this.pendingKeyName=this.tokeniser.getToken().value,this.pendingKey=!1):(this.keys[this.accumulated()]=this.pendingKeyName,this.pendingKey=!0,e.prototype.add.call(this,t)),!this.pendingKey},t.prototype.take=function(e,t,r,n,o,i){e.accept(t.withKey(this.keys[n-r]),o,i)},t.prototype.currentPointer=function(e){return e.withKey(this.pendingKeyName)},t}(P_),M_=function(e){function t(t){return e.call(this,t,f_.ROOT,-1,0)||this}return b_(t,e),t.prototype.take=function(e,t,r,n,o,i){if(this.total()>1)throw new Error("Invalid JSON: multiple values found");e.accept(t,o,i)},t.prototype.currentPointer=function(e){return e},t}(P_),L_=function(){function e(e){this.parentStack=[],this.tokeniser=new Ov.Tokeniser(e.$buffer,e.$offset,e.$length),this.structure=new M_(this.tokeniser),this.startOffset=this.tokeniser.offset(),this.json=e}return e.prototype.spanToNext=function(e,t){return this.spanTo(e,t,!0)},e.prototype.spanTo=function(e,t,r){var n,o;void 0===r&&(r=!1);var i=this.nextByte();if(i>=e)return 0;var s,a=this.parentStack.length,u=r,c=i;do{s=this.tokeniser.nextToken();var p=c;if(c=this.nextByte(),null===s){if(0!==this.parentStack.length)throw new Error("Invalid structure");break}if(s.type===Sv.tokens.VALUE)u=this.structure.add(c);else if(s.type===Sv.tokens.ARRAY_START)this.parentStack.push(this.structure),this.structure=this.structure.newArray(p,c);else if(s.type===Sv.tokens.MAP_START)this.parentStack.push(this.structure),this.structure=this.structure.newObject(p,c);else if(Sv.isStructEnd(s.type)){var f=this.parentStack.pop();this.structure.notEmptyAndSplitBy(i)?(this.structure.takeAll(t),this.structure.splitStructureEnd(t),f.skip(),f.setNextStart(c)):f.add(c),this.structure=f,u=!1}}while(u||c<e||this.nextTokenIsStructEnd(s,c));try{for(var l=C_(this.parentStack),h=l.next();!h.done;h=l.next()){h.value.takeAll(t)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return this.structure.takeAll(t),this.parentStack.length-a},e.prototype.nextTokenIsStructEnd=function(e,t){var r=this.tokeniser.getContext();return Sv.isStructStart(e.type)?0===r.expected():r.acceptsBreakMarker()&&t<this.json.$length&&(31&this.json.$buffer[this.json.$offset+t])===Sv.additional.BREAK||!r.hasRemaining()},e.prototype.nextByte=function(){return this.tokeniser.offset()-this.startOffset},e.prototype.toString=function(){var e=["SpanParser"," next=",this.nextByte().toString()," ["];return this.parentStack.forEach(function(t){e.push(t.toString()),e.push(", ")}),e.push(this.structure.toString()),e.push("]"),e.join("")},e}();R_.SpanParser=L_;var D_={};(function(e){"use strict";Object.defineProperty(D_,"__esModule",{value:!0});var t=function(){function e(e){this.splitStructures=e}return e.prototype.accept=function(e,t,r){this.last=e,this.lastStart=t,this.lastLength=r},e.prototype.foundLast=function(){return void 0!==this.last},e.prototype.consumeLast=function(e){e.accept(this.last,this.lastStart,this.lastLength)},e.prototype.splitStructureEnd=function(e,t,r,n){this.splitStructures.put(e,{start:r,length:n,elements:t})},e}();function r(e,t,r,n){return e.equalBytes(t.$buffer,t.$offset+r,n)}var n=function(){function e(e,t,n,o,i,s){var a=this;this.removedSplitStructures=new E_.JSONPointerMap,this.insertedSplitStructures=new E_.JSONPointerMap,this.oldOffset=0,this.newOffset=0,this.pendingRemove=null,this.pendingInsert=null,this.inserter={accept:function(e,t,n){null!==a.pendingRemove&&a.pendingRemove.equalIgnoringIndexes(e)&&r(a.pendingRemoveValue,a.newValue,t,n)?(a.pendingRemove=null,a.pendingRemoveValue=null):(a.addInsert(e,a.partOf(a.newValue,t,n)),a.addRemove(null,null))},splitStructureEnd:function(e,t,r,n){a.insertedSplitStructures.put(e,{start:r,length:n,elements:t})}},this.remover={accept:function(e,t,n){null!==a.pendingInsert&&a.pendingInsert.equalIgnoringIndexes(e)&&r(a.pendingInsertValue,a.oldValue,t,n)?(a.pendingInsert=null,a.pendingInsertValue=null):(a.addRemove(e,a.copyPartOf(a.oldValue,t,n)),a.addInsert(null,null))},splitStructureEnd:function(e,t,r,n){a.removedSplitStructures.put(e,{start:r,length:n,elements:t})}},this.oldParser=new R_.SpanParser(e),this.newParser=new R_.SpanParser(t),this.oldValue=e,this.newValue=t,this.inserted=n,this.removed=o,this.partOf=i,this.copyPartOf=s}return e.prototype.match=function(e,t){return this.handleDelete(this.oldOffset,e-this.oldOffset),this.handleMatch(e,t),!0},e.prototype.handleDelete=function(e,t){this.checkInvariants();var r=e+t;this.oldParser.nextByte()<r&&(0!==this.oldParser.spanTo(r,this.remover)||this.oldParser.nextByte()>r)&&this.newParser.spanToNext(this.newOffset+1,this.inserter)},e.prototype.handleMatch=function(e,r){this.checkInvariants();var n=this.newOffset,o=e+r;this.newOffset+=r,this.oldOffset=o;var i=this.oldParser.nextByte(),s=this.newParser.nextByte();s>n&&i===e?this.oldParser.spanToNext(e+1,this.remover):i>e&&s===n&&this.newParser.spanToNext(n+1,this.inserter);var a=new t(this.removedSplitStructures),u=new t(this.insertedSplitStructures);this.oldParser.spanTo(o,a),this.newParser.spanTo(this.newOffset,u);var c=a.foundLast()&&this.oldParser.nextByte()>o,p=u.foundLast()&&this.newParser.nextByte()>this.newOffset;c&&p&&(a.consumeLast(this.remover),u.consumeLast(this.inserter))},e.prototype.insert=function(e){return this.checkInvariants(),this.newOffset+=e.length,this.newParser.nextByte()<this.newOffset&&(0!==this.newParser.spanTo(this.newOffset,this.inserter)||this.newParser.nextByte()>this.newOffset)&&this.oldParser.spanToNext(this.oldOffset+1,this.remover),!0},e.prototype.end=function(){this.handleDelete(this.oldOffset,this.oldValue.$length-this.oldOffset),this.addInsert(null,null),this.addRemove(null,null),this.replaceFullRemovedStructures(),this.replaceFullInsertedStructures()},e.prototype.addInsert=function(e,t){null!==this.pendingInsert&&this.inserted.put(this.pendingInsert,this.pendingInsertValue),this.pendingInsert=e,this.pendingInsertValue=t},e.prototype.addRemove=function(e,t){null!==this.pendingRemove&&this.removed.put(this.pendingRemove,this.pendingRemoveValue),this.pendingRemove=e,this.pendingRemoveValue=t},e.prototype.noChange=function(){},e.prototype.checkInvariants=function(){if(this.oldParser.nextByte()<this.oldOffset||this.newParser.nextByte()<this.newOffset)throw new Error("Invalid binary delta")},e.prototype.replaceFullRemovedStructures=function(){for(var e=this.removedSplitStructures.postOrder();e.hasNext();){var t=e.next(),r=t.value,n=this.removed.getEntry(t.pointer);null!==n&&n.numberOfChildren()===r.elements&&(n.setValue(this.copyPartOf(this.oldValue,r.start,r.length)),n.removeDescendants())}},e.prototype.replaceFullInsertedStructures=function(){for(var e=this.insertedSplitStructures.postOrder();e.hasNext();){var t=e.next(),r=t.value,n=this.inserted.getEntry(t.pointer);null!==n&&n.numberOfChildren()===r.elements&&(n.setValue(this.partOf(this.newValue,r.start,r.length)),n.removeDescendants())}},e}(),o=function(){function e(e){this.entries=[],this.parts=e;for(var t=e.iterator();t.hasNext();){var r=t.next();this.entries.push({key:r.pointer.toString(),value:r.value.get()})}this.length=this.entries.length}return e.prototype.get=function(e){return this.parts.get(f_.JSONPointer.parse(e)).get()},e.prototype.entrySet=function(){return this.entries},e.prototype.containsKey=function(e){return this.parts.contains(f_.JSONPointer.parse(e))},e.prototype.descendants=function(t){return new e(this.parts.descendants(f_.JSONPointer.parse(t)))},e.prototype.intersection=function(t){return new e(this.parts.intersection(f_.JSONPointer.parse(t)))},e}(),i=function(){function t(e,t,r,o){this.insertedMap=new E_.JSONPointerMap,this.removedMap=new E_.JSONPointerMap,this.factory=e,void 0!==o?o.visit(new n(t,r,this.insertedMap,this.removedMap,this.partOf.bind(this),this.copyPartOf.bind(this))):(this.insertedMap.put(f_.ROOT,t),this.removedMap.put(f_.ROOT,r))}return t.prototype.partOf=function(e,t,r){return new this.factory(e.$buffer,e.$offset+t,r)},t.prototype.copyPartOf=function(t,r,n){var o=t.$offset+r,i=e.alloc(n);return t.$buffer.copy(i,0,o,o+n),new this.factory(i,0,n)},t.prototype.removed=function(){return new o(this.removedMap)},t.prototype.inserted=function(){return new o(this.insertedMap)},t.prototype.hasChanges=function(){return 0!==this.removedMap.size||0!==this.insertedMap.size},t.prototype.toString=function(){return["REMOVE ",this.removedMap," INSERT ",this.insertedMap].join("")},t}();D_.JSONDeltaImpl=i}).call(this,r({}).Buffer);var j_={},U_=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(j_,"__esModule",{value:!0});var x_=new Av.Encoder;function B_(e){return e instanceof q_?e:new q_(x_.encode(e).flush())}function k_(e,t){return t instanceof gv.Int64Impl?t.toString():t}var q_=function(e){function t(t,r,n){return void 0===r&&(r=0),void 0===n&&(n=t.length),e.call(this,t,r,n)||this}return U_(t,e),t.toString=function(){return"JSONImpl"},t.from=function(e){return B_(e)},t.prototype.get=function(){return new Pv.Decoder(this.$buffer,this.$offset,this.$length).nextValue()},t.prototype.diff=function(e,r){var n=this.binaryDiff(e);return"json"===r?new D_.JSONDeltaImpl(t,e,this,n):n},t.prototype.binaryDiff=function(e){return V_.diff(e,this)},t.prototype.jsonDiff=function(e){return this.diff(e,"json")},t.prototype.apply=function(e){return V_.apply(this,e)},t.prototype.toString=function(){return JSON.stringify(this.get())},t.prototype.toJsonString=function(){return JSON.stringify(this.get(),k_)},t}(e_.BytesImpl);j_.JSONImpl=q_;var V_=new Zv.BinaryDeltaTypeImpl(q_,B_,i_.identity),F_={},G_=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(F_,"__esModule",{value:!0});var H_=function(e){function t(){var t=e.call(this,"json",j_.JSONImpl,j_.JSONImpl,j_.JSONImpl.from,i_.identity,[],!0)||this;return t.JSON=j_.JSONImpl,t}return G_(t,e),t.prototype.fromJsonString=function(e){return j_.JSONImpl.from(JSON.parse(e))},t.prototype.from=function(e){return j_.JSONImpl.from(e)},t.prototype.validate=function(){},t}(n_.AbstractDataType);F_.JSONDataTypeImpl=H_;var W_={};(function(e){"use strict";var t,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(W_,"__esModule",{value:!0});var n=new Av.Encoder,o=new e_.BytesImpl(e.from([246])),i=function(e){function t(t,r,i,s,a){var u=this,c=function(e){return i(e,n),new e_.BytesImpl(n.flush())};return(u=e.call(this,t,r,e_.BytesImpl,c,function(e){return o.equals(e)?null:new Pv.Decoder(e.$buffer,e.$offset,e.$length).nextValueExpecting(s)},[j_.JSONImpl],a)||this).serialise=i,u.fromValue=c,u}return r(t,e),t.prototype.writeValue=function(e){return null==e?o.asBuffer():(this.serialise(e,n),n.flush())},t.prototype.validate=function(){},t.prototype.from=function(e){return e.$buffer?e:this.fromValue(e)},t}(n_.AbstractDataType);W_.PrimitiveDataType=i}).call(this,r({}).Buffer);var Y_={},z_=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function J_(e,t){null==e?t.encode(null):t.writeDouble(e)}Object.defineProperty(Y_,"__esModule",{value:!0});var $_=function(e){function t(){return e.call(this,"double",Number,J_,Pv.isDouble,!1)||this}return z_(t,e),t}(W_.PrimitiveDataType);Y_.DoubleDataTypeImpl=$_;var K_={},Q_=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function X_(e,t){null==e?t.encode(null):t.writeInt64(new gv.Int64Impl(e))}Object.defineProperty(K_,"__esModule",{value:!0});var Z_=function(e){function t(){var t=e.call(this,"int64",gv.Int64Impl,X_,Pv.isInt64,!1)||this;return t.Int64=gv.Int64Impl,t}return Q_(t,e),t}(W_.PrimitiveDataType);K_.Int64DataTypeImpl=Z_;var eS={},tS=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function rS(e,t){null==e?t.encode(null):t.encode(e.toString())}Object.defineProperty(eS,"__esModule",{value:!0});var nS=function(e){function t(){return e.call(this,"string",String,rS,Pv.isString,!0)||this}return tS(t,e),t}(W_.PrimitiveDataType);eS.StringDataTypeImpl=nS;var oS={};function iS(e,t,r,n,o){if(0===r)return 0;if(e[0]===n)return 1;for(var i=1,s=t;s<t+r;s++)e[s]===o&&i++;return i}Object.defineProperty(oS,"__esModule",{value:!0}),oS.RECORD_DELIMITER=1,oS.FIELD_DELIMITER=2,oS.EMPTY_FIELD=3,oS.RECORD_MU=4,oS.FIELD_MU=5,String.fromCharCode(oS.RECORD_DELIMITER),String.fromCharCode(oS.FIELD_DELIMITER),String.fromCharCode(oS.EMPTY_FIELD),String.fromCharCode(oS.RECORD_MU),String.fromCharCode(oS.FIELD_MU),oS.bytesToString=function(e,t,r){for(var n="",o=t;o<t+r;++o)switch(e[o]){case oS.FIELD_DELIMITER:n+="<FD>";break;case oS.RECORD_DELIMITER:n+="<RD>";break;case oS.EMPTY_FIELD:n+="<EF>";break;case oS.FIELD_MU:n+="<FM>";break;case oS.RECORD_MU:n+="<RM>";break;default:n+=String.fromCharCode(e[o])}return n},oS.recordCount=function(e,t,r){return iS(e,t,r,oS.RECORD_MU,oS.RECORD_DELIMITER)},oS.fieldCount=function(e,t,r){return iS(e,t,r,oS.FIELD_MU,oS.FIELD_DELIMITER)},oS.findDelimiter=function(e,t,r,n){for(var o=t;o<r;o++)if(e[o]===n)return o;return r},oS.isSingleEmptyRecord=function(e,t,r){return 1===r&&e[t]===oS.RECORD_MU},oS.recordIsSingleEmptyField=function(e,t,r){return 1===r&&(e[t]===oS.FIELD_MU||e[t]===oS.EMPTY_FIELD)};var sS={};(function(e){"use strict";function t(t,r){if(0!==t.length)if(1!==t.length||0!==t[0].length){var n=!1;t.forEach(function(t){if(n?r.write(oS.RECORD_DELIMITER):n=!0,1===t.length&&""===t[0])r.write(oS.FIELD_MU);else{var o=!1;t.forEach(function(t){o?r.write(oS.FIELD_DELIMITER):o=!0,null!=t&&r.writeMany(e.from(t))})}})}else r.write(oS.RECORD_MU)}Object.defineProperty(sS,"__esModule",{value:!0}),sS.toBuffer=function(e){var r=new ev.BufferOutputStream;return t(e,r),r.getBuffer()}}).call(this,r({}).Buffer);var aS={};function uS(e,t,r){var n=e.getAbsoluteIndex(r);if(n>t.length-1)throw new Error("Index '"+r+"' does not have a matching entry for variable occurrence record: '"+e.name+"'");return n}function cS(e,t,r){var n=e.getAbsoluteIndex(r);if(n>t.length-1)throw new Error("Index '"+r+"' does not have a matching entry for variable occurrence field: '"+e.name+"'");return n}Object.defineProperty(aS,"__esModule",{value:!0}),aS.resolveRecordIndex=uS,aS.resolveFieldIndex=cS;var pS=function(){function e(e,t){this.recordV2Constructor=e,this.modelSchema=t}return e.prototype.schema=function(){return this.modelSchema},e.prototype.asValue=function(){return new this.recordV2Constructor(sS.toBuffer(this.model()))},e.prototype.get=function(e,t,r,n){var o,i;switch(void 0===t&&(t=0),void 0===n&&(n=0),arguments.length){case 1:var s=this.parseKey(e);e=s.recordName,i=s.recordIndex,o=s.fieldName,n=s.fieldIndex;break;case 2:o=t,i=0;break;default:o=r,i=t}var a=this.modelSchema.getRecord(e),u=a.getField(o),c=this.getRecord(a,i);return c[cS(u,c,n)]},e.prototype.recordCount=function(e){var t=this.modelSchema.getRecord(e);return t.isVariable?this.model().length-t.getIndex():t.min},e.prototype.fieldCount=function(e,t,r){var n=this.modelSchema.getRecord(e),o=n.getField(r);return o.isVariable?this.getRecord(n,t).length-o.getIndex():o.min},e.prototype.getRecord=function(e,t){var r=this.model();return r[uS(e,r,t)]},e.prototype.parseKey=function(e){var t,r,n,o=e.split(".",2);if(1===o.length)t=this.modelSchema.firstRecord().name,r=0,n=o[0];else{var i=this.parseKeyPart(o[0].trim());t=i[0],r=i[1],n=o[1]}var s=this.parseKeyPart(n);return{recordName:t,recordIndex:r,fieldName:s[0],fieldIndex:s[1]}},e.prototype.parseKeyPart=function(e){if(0===e.length)throw new Error("No name specified");var t=e.indexOf("(");if(-1===t)return[e,0];if(0===t)throw new Error("No name specified");var r=e.indexOf(")");if(-1===r||r<t)throw new Error("'(' found without closing ')");if(r<e.length-1)throw new Error("Characters found after closing ')");return[e.substring(0,t),parseInt(e.substring(t+1,r),10)]},e}();aS.AbstractRecordModel=pS;var fS,lS={};Object.defineProperty(lS,"__esModule",{value:!0}),function(e){e.DECIMAL="DECIMAL",e.INTEGER="INTEGER",e.STRING="STRING"}(fS=lS.Type||(lS.Type={}));var hS=function(){function e(e,t,r,n,o,i){this.name=e,this.type=t,this.min=r,this.max=n,this.scale=i,this.index=o,this.isVariable=r!==n}return e.prototype.getAbsoluteIndex=function(e){if(e<0||-1!==this.max&&e>this.max-1)throw new Error("Invalid index '"+e+"' for field '"+this.name+"'");return this.index+e},e.prototype.toString=function(){var e="Name="+this.name+", Type="+this.type;return this.min===this.max?e+=", Occurs="+this.min:(e+=", Min="+this.min+", Max=",-1===this.max?e+="Unlimited":e+=this.max),this.type===fS.DECIMAL&&(e+=", Scale="+this.scale),"Field ["+e+"]"},e.prototype.modelValue=function(){switch(this.type){case fS.DECIMAL:return function(e){switch(e.scale){case void 0:case 1:return"0.0";case 2:return"0.00";case 3:return"0.000";default:for(var t="0.",r=0;r<e.scale;++r)t+="0";return t}}(this);case fS.INTEGER:return"0";case fS.STRING:default:return""}},e.prototype.toJSON=function(){var e={name:this.name,type:this.type,min:this.min,max:this.max};return this.type===fS.DECIMAL&&(e.scale=this.scale),e},e}();lS.FieldImpl=hS,lS.normalise=function(e,t){switch(e.type){case fS.DECIMAL:var r=parseFloat(t);if(Ty.Number.isNaN(r))throw new Error("Invalid decimal value: '"+t+"'");return r.toFixed(e.scale);case fS.INTEGER:var n=parseInt(t,10),o=n.toString();if(Ty.Number.isNaN(n)||o.indexOf(".")>-1)throw new Error("Invalid integer value: '"+t+"'");return o;case fS.STRING:return t;default:return""}};var dS={},yS=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),vS=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};function _S(e,t,r){var n,o,i=r.length,s=e.lastField(),a=s.max,u=s.index;if(-1!==a&&i>u+a)throw new Error("Too many occurrences of field '"+e.name+"("+t+")."+s.name+"'");if(i<u+s.min)throw new Error("Too few field occurrences in record '"+e.name+"("+t+")'");try{for(var c=vS(e.fields),p=c.next();!p.done;p=c.next()){for(var f=p.value,l=f.index,h=f.min,d=l;d<l+h;++d)SS(e,t,f,d-l,r[d]);if(f.isVariable)for(d=l+h;d<i;d++){SS(e,t,f,d-l,r[d])}}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}}function SS(e,t,r,n,o){try{lS.normalise(r,S_.requireNonNull(o,"FieldData"))}catch(o){throw new Error("Invalid value for field '"+e.name+"("+t+")."+r.name+"("+n+")")}}Object.defineProperty(dS,"__esModule",{value:!0});var ES=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return o&&function(e,t){var r,n,o=t.length,i=e.lastRecord(),s=i.index,a=i.max;if(-1!==a&&o>s+a)throw new Error("Too many occurrences of record '"+i.name+"'");if(o<s+i.min)throw new Error("Too few record occurrences");var u=e.records();try{for(var c=vS(u),p=c.next();!p.done;p=c.next()){for(var f=p.value,l=f.index,h=f.min,d=l;d<l+h;++d)_S(f,d-l,t[d]);if(f.isVariable)for(d=l+h;d<o;++d)_S(f,d-l,t[d])}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}(r,n),i.recordData=n,i}return yS(t,e),t.prototype.model=function(){return Ty.Array.from(this.recordData)},t}(aS.AbstractRecordModel);dS.RecordModelImpl=ES;var mS={};function wS(e,t,r,n,o){var i=!1;r<n?i=gS(e,t,r,n,o):r>0&&e[r-1]===oS.FIELD_DELIMITER&&o.push(""),i||t.push(Ty.Array.from(o)),o.length=0}function gS(e,t,r,n,o){var i=n-r;return 0===o.length&&1===i&&e[r]===oS.FIELD_MU?(t.push([""]),!0):(o.push(e.toString("utf8",r,n)),!1)}Object.defineProperty(mS,"__esModule",{value:!0}),mS.parse=function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=e.length),0===r)return[];if(1===r&&e[t]===oS.RECORD_MU)return[[]];for(var n=[],o=[],i=t,s=t;s<r;++s)e[s]===oS.RECORD_DELIMITER?(wS(e,n,i,s,o),i=s+1):e[s]===oS.FIELD_DELIMITER&&(gS(e,n,i,s,o),i=s+1);return function(e,t,r,n,o){if(n>r)gS(e,t,r,n,o);else{var i=e[n-1];i===oS.RECORD_DELIMITER?t.push([]):i===oS.FIELD_DELIMITER&&o.push("")}o.length&&t.push(Ty.Array.from(o))}(e,n,i,r,o),n};var OS={};(function(e){"use strict";var t,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(OS,"__esModule",{value:!0});var n,o=function(t){function n(){return t.call(this,e.from([]))||this}return r(n,t),n.prototype.changes=function(){return[]},n}(e_.BytesImpl);OS.NO_CHANGE=new o,function(e){e.FIELD_CHANGED="FIELD_CHANGED",e.FIELDS_ADDED="FIELDS_ADDED",e.FIELDS_REMOVED="FIELDS_REMOVED",e.RECORDS_ADDED="RECORDS_ADDED",e.RECORDS_REMOVED="RECORDS_REMOVED"}(n=OS.Type||(OS.Type={}));var i=function(){function e(e,t,r,o,i){this.type=e,this.recordName=t,this.recordIndex=r,this.fieldName=o,this.fieldIndex=i;var s=t+"("+r+")";e!==n.RECORDS_REMOVED&&e!==n.RECORDS_ADDED&&(s+="."+o+"("+i+")"),this.key=s}return e.prototype.toString=function(){return this.type+" "+this.key},e}(),s=function(e){function t(t,r,n,o,i){void 0===r&&(r=0),void 0===n&&(n=t.length);var s=e.call(this,t,r,n)||this;return s.recordChanges=o,s.fieldChanges=i,s}return r(t,e),t.prototype.changes=function(e){var t=this,r=mS.parse(this.$buffer,this.$offset,this.$length),n=0,o=[];return e.records().forEach(function(e){if(r.length<n+e.min)throw new Error("Insufficient records of type "+e.name+" in delta for schema");n=e.isVariable?t.processVariableRecordChanges(e,n,r,o):t.processFixedRecordChanges(e,n,r,o)}),o},t.prototype.processFixedRecordChanges=function(e,t,r,n){for(var o=t,i=0;i<e.min;++i)this.processRecordChanges(o,e,i,r[o],n),o++;return o},t.prototype.processVariableRecordChanges=function(e,t,r,o){var s=r.length,a=e.max;if(-1!==a&&s>t+a)throw new Error("Too many records of type "+e.name+" in delta for schema");for(var u=t,c=this.recordChanges&&this.recordChanges[0]?this.recordChanges[1]:s,p=0;u<c;u++,p++)this.processRecordChanges(u,e,p,r[u],o);return this.recordChanges&&o.push(new i(this.recordChanges[0]?n.RECORDS_ADDED:n.RECORDS_REMOVED,e.name,this.recordChanges[1]-t,"",0)),u},t.prototype.processRecordChanges=function(e,t,r,n,o){var i=this,s=0;t.fields.forEach(function(a){s=a.isVariable?i.processVariableFieldChanges(t,r,e,a,s,n,o):i.processFixedFieldChanges(t,r,a,s,n,o)})},t.prototype.processFixedFieldChanges=function(e,t,r,o,s,a){for(var u=s.length,c=o,p=0;p<r.min;++p){if(c>=u)throw new Error("Insufficient fields of type "+r.name+" in delta for schema record "+e.name);""!==s[c]&&a.push(new i(n.FIELD_CHANGED,e.name,t,r.name,p)),c++}return c},t.prototype.processVariableFieldChanges=function(e,t,r,o,s,a,u){var c=a.length,p=s;if(c<p+o.min)throw new Error("Insufficient fields of type "+o.name+" in delta for schema record "+e.name);for(var f=this.fieldChanges[r],l=f?f[1]:c,h=0;p<l;p++,h++)""!==a[p]&&u.push(new i(n.FIELD_CHANGED,e.name,t,o.name,h));return f&&u.push(new i(f[0]?n.FIELDS_ADDED:n.FIELDS_REMOVED,e.name,t,o.name,f[1])),p},t.prototype.toString=function(){return oS.bytesToString(this.$buffer,this.$offset,this.$length)},t}(e_.BytesImpl);OS.RecordV2DeltaImpl=s}).call(this,r({}).Buffer);var TS={};(function(e){"use strict";var t,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(TS,"__esModule",{value:!0});var n=function(){function e(){this.delta=new ev.BufferOutputStream,this.changed=!1,this.recordChanges=null,this.fieldChanges={}}return e.prototype.write=function(e,t,r){void 0!==t&&void 0!==r?this.delta.writeMany(e,t,r):this.delta.write(e)},e.prototype.getDelta=function(){return this.delta.getBuffer()},e.prototype.size=function(){return this.delta.count},e.prototype.hasChanges=function(){return this.changed},e.prototype.setChanged=function(){this.changed=!0},e.prototype.setRecordsChanged=function(e,t){this.recordChanges=[e,t],this.changed=!0},e.prototype.getRecordChanges=function(){return this.recordChanges},e.prototype.setFieldsAdded=function(e,t){this.fieldChanges[e]=[!0,t],this.changed=!0},e.prototype.setFieldsRemoved=function(e,t){this.fieldChanges[e]=[!1,t],this.changed=!0},e.prototype.getFieldChanges=function(){return this.fieldChanges},e}();function o(e,t,r,n,o,s,a,u){if(0!==a){if(!oS.recordIsSingleEmptyField(o,s,a))return 0===n?(u.write(o,s,a),void u.setFieldsAdded(e,0)):void(oS.recordIsSingleEmptyField(t,r,n)?function(e,t,r,n,o){var i=t[r];i===oS.EMPTY_FIELD?o.write(t,r+1,n-1):(o.write(t,r,n),i!==oS.FIELD_DELIMITER&&o.setChanged());oS.fieldCount(t,r,n)>1&&o.setFieldsAdded(e,1)}(e,o,s,a,u):function(e,t,r,n,o,s,a,u){for(var c=oS.fieldCount(t,r,n),p=oS.fieldCount(o,s,a),f=Math.min(c,p),l=r,h=r,d=s,y=s,v=u.size(),_=0;_<f;++_)h=oS.findDelimiter(t,h,r+n,oS.FIELD_DELIMITER),y=oS.findDelimiter(o,y,s+a,oS.FIELD_DELIMITER),_>0&&u.write(oS.FIELD_DELIMITER),i(t,l,h-l,o,d,y-d,u),l=++h,d=++y;p!==c&&(p>c?(u.write(o,d-1,s+a-d+1),u.setFieldsAdded(e,f)):u.setFieldsRemoved(e,f));1===p&&v===u.size()&&u.write(oS.FIELD_MU)}(e,t,r,n,o,s,a,u));!function(e,t,r,n,o){if(oS.recordIsSingleEmptyField(t,r,n))o.write(oS.FIELD_MU);else{var i=oS.fieldCount(t,r,n);i>1&&o.setFieldsRemoved(e,1),o.write(oS.EMPTY_FIELD),o.setChanged()}}(e,t,r,n,u)}else 0!==n&&u.setFieldsRemoved(e,0)}function i(e,t,r,n,o,i,s){(function(e,t,r,n,o,i){if(r===i){if(0===r||function(e,t,r,n,o){for(var i=0;i<o;++i)if(e[t+i]!==r[n+i])return!1;return!0}(e,t,n,o,r))return!0}else{if(1===r&&e[t]===oS.EMPTY_FIELD&&0===i)return!0;if(1===i&&n[o]===oS.EMPTY_FIELD&&0===r)return!0}return!1})(e,t,r,n,o,i)||(0===i?s.write(oS.EMPTY_FIELD):s.write(n,o,i),s.setChanged())}function s(e){return e instanceof a?e:new a(e)}var a=function(t){function i(e,r,n){return void 0===r&&(r=0),void 0===n&&(n=e.length),t.call(this,e,r,n)||this}return r(i,t),i.toString=function(){return"RecordV2Impl"},i.from=function(e){return s(e)},i.prototype.apply=function(e){return u.apply(this,e)},i.prototype.toString=function(){return JSON.stringify(this.asRecords())},i.prototype.asRecords=function(){return mS.parse(this.$buffer,this.$offset,this.$length)},i.prototype.asFields=function(){return this.asRecords().reduce(function(e,t){return e.concat(t)},[])},i.prototype.asModel=function(e){return new dS.RecordModelImpl(i,e,this.asRecords(),!1)},i.prototype.asValidatedModel=function(e){return new dS.RecordModelImpl(i,e,this.asRecords(),!0)},i.prototype.binaryDiff=function(e){return u.diff(e,this)},i.prototype.diff=function(t){var r=t.$buffer,i=t.$offset,s=t.$length,a=this.$buffer,u=this.$offset,c=this.$length;if(0===c)return 0===s?OS.NO_CHANGE:new OS.RecordV2DeltaImpl(e.from([]),0,0,[!1,0],{});if(oS.isSingleEmptyRecord(a,u,c))return oS.isSingleEmptyRecord(r,i,s)?OS.NO_CHANGE:function(t){switch(t){case 0:return new OS.RecordV2DeltaImpl(e.from([oS.RECORD_MU]),0,1,[!0,0],{});case 1:return new OS.RecordV2DeltaImpl(e.from([oS.RECORD_MU]),0,1,null,{0:[!1,0]});default:return new OS.RecordV2DeltaImpl(e.from([oS.RECORD_MU]),0,1,[!1,1],{0:[!1,0]})}}(oS.recordCount(r,i,s));if(0===s)return function(e,t,r){return new OS.RecordV2DeltaImpl(e,t,r,[!0,0],{})}(a,u,c);if(oS.isSingleEmptyRecord(r,i,s))return function(e,t,r){return 1===oS.recordCount(e,t,r)?new OS.RecordV2DeltaImpl(e,t,r,null,{0:[!0,0]}):new OS.RecordV2DeltaImpl(e,t,r,[!0,1],e[0]===oS.RECORD_DELIMITER?{}:{0:[!0,0]})}(a,u,c);var p=function(e,t,r,i,s,a){for(var u=new n,c=oS.recordCount(e,t,r),p=oS.recordCount(i,s,a),f=Math.min(c,p),l=t,h=t,d=s,y=s,v=0;v<f;++v)h=oS.findDelimiter(e,h,t+r,oS.RECORD_DELIMITER),y=oS.findDelimiter(i,y,s+a,oS.RECORD_DELIMITER),v>0&&u.write(oS.RECORD_DELIMITER),o(v,e,l,h-l,i,d,y-d,u),l=++h,d=++y;return p!==c&&(p>c&&u.write(i,d-1,s+a-d+1),u.setRecordsChanged(p>c,f)),u}(r,i,s,a,u,c);if(p.hasChanges()){var f=p.getDelta();return new OS.RecordV2DeltaImpl(f,0,f.length,p.getRecordChanges(),p.getFieldChanges())}return OS.NO_CHANGE},i}(e_.BytesImpl);TS.RecordV2Impl=a;var u=new Zv.BinaryDeltaTypeImpl(a,s,i_.identity)}).call(this,r({}).Buffer);var IS={};Object.defineProperty(IS,"__esModule",{value:!0});var RS=function(){function e(){this.records=[]}return e.prototype.addFields=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(arguments.length>1?t.unshift(e):t=e,t){var n=this.records.length?this.records[this.records.length-1]:[];this.records[Math.max(this.records.length-1,0)]=n.concat(t)}return this},e.prototype.addRecord=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return arguments.length>1?t.unshift(e):t=e,t?this.records.push([].concat(t)):this.records.push([]),this},e.prototype.clear=function(){return this.records=[],this},e.prototype.build=function(){return new TS.RecordV2Impl(sS.toBuffer(this.records))},e}();IS.RecordV2BuilderImpl=RS;var bS={};Object.defineProperty(bS,"__esModule",{value:!0});var CS=function(){function e(e,t,r,n,o){var i=this;this.name=e,this.min=t,this.max=r,this.index=n,this.isVariable=t!==r,this.fields=o,this.fieldsMap={},o.forEach(function(e){i.fieldsMap[e.name]=e})}return e.prototype.getFields=function(){return[].concat(this.fields)},e.prototype.getField=function(e){var t=this.fieldsMap[e];if(t)return t;throw new Error("Record '"+this.name+"' has no field named '"+e+"'")},e.prototype.lastField=function(){return this.fields[this.fields.length-1]},e.prototype.createModel=function(){var e=[];return this.fields.forEach(function(t){for(var r=0;r<t.min;++r)e.push(t.modelValue())}),e},e.prototype.getAbsoluteIndex=function(e){if(e<0||-1!==this.max&&e>this.max-1)throw new Error("Invalid index '"+e+"' for record '"+this.name+"'");return this.index+e},e.prototype.toString=function(){var e="Name="+this.name;return this.min===this.max?e+=", Occurs="+this.min:(e+=", Min="+this.min+", Max=",-1===this.max?e+="Unlimited":e+=this.max),"Record ["+(e+=", Fields="+this.fields)+"]"},e}();bS.RecordImpl=CS,bS.toJSON=function(e){return{fields:e.fields.map(function(e){return e.toJSON()}),name:e.name,min:e.min,max:e.max}};var PS={},AS=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(PS,"__esModule",{value:!0});var NS=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.recordData=r.createModel(),n}return AS(t,e),t.prototype.model=function(){return this.recordData},t.prototype.set=function(e,t,r,n,o){var i,s;switch(void 0===n&&(n=0),arguments.length){case 2:o=t;var a=this.parseKey(e);e=a.recordName,i=a.recordIndex,s=a.fieldName,n=a.fieldIndex;break;case 3:o=r,s=t,i=0;break;case 5:i=t,s=r;break;default:i=0,s=""}var u=this.schema().getRecord(e),c=this.getRecord(u,i),p=u.getField(s);return c[aS.resolveFieldIndex(p,c,n)]=lS.normalise(p,o),this},t.prototype.add=function(e,t){for(var r,n,o,i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];if(arguments.length>2&&"number"==typeof t)o=t,i=i.slice(2),r=this.schema().getRecord(e),n=this.getRecord(r,o);else{if(r=this.schema().lastRecord(),!(this.recordData.length>r.index))throw new Error("Variable record '"+r.name+"' has no occurrences to add a field to");n=this.recordData[this.recordData.length-1]}return this.addValuesToRecord(r,n,i),this},t.prototype.addRecord=function(){var e=this.schema().lastRecord();if(!e.isVariable)throw new Error("Record '"+e.name+"' is not variable");var t=e.max;if(-1!==t&&this.recordData.length-e.index>=t)throw new Error("Record '"+e.name+"' already has maximum number of occurrences");return this.recordData.push(e.createModel()),this},t.prototype.removeRecord=function(e){var t=this.schema().lastRecord();if(!t.isVariable)throw new Error("Record '"+t.name+"' is not variable");var r=aS.resolveRecordIndex(t,this.recordData,e);if(this.recordData.length-t.index-1<t.min)throw new Error("Removing an occurrence of record '"+t.name+"' would violate the minimum number of occurrences");return this.recordData.splice(r,1),this},t.prototype.removeField=function(e,t,r){var n=this.schema().getRecord(e),o=this.getRecord(n,t),i=n.lastField();if(!i.isVariable)throw new Error("Field '"+i.name+"' is not a variable field");var s=aS.resolveFieldIndex(i,o,r);if(o.length-i.index-1<i.min)throw new Error("Removing an occurrence of field '"+i.name+"' would violate the minimum number of occurrences");return o.splice(s,1),this},t.prototype.addValuesToRecord=function(e,t,r){var n=e.lastField();if(!n.isVariable)throw new Error("Final field of record '"+e.name+"' is not variable");var o=n.max;if(-1!==o&&t.length-n.index+r.length>o)throw new Error("Adding values would exceed maximum number of field occurrences");r.forEach(function(e){t.push(lS.normalise(n,e))})},t}(aS.AbstractRecordModel);PS.MutableRecordModelImpl=NS;var MS={};Object.defineProperty(MS,"__esModule",{value:!0});var LS=function(){function e(e,t){var r=this;this.recordsMap={},this.recordV2Constructor=e,this.recordsArray=t,t.forEach(function(e){r.recordsMap[e.name]=e})}return e.prototype.getRecord=function(e){var t=this.recordsMap[e];if(t)return t;throw new Error("Record '"+e+"' is not known")},e.prototype.getRecords=function(){return[].concat(this.recordsArray)},e.prototype.records=function(){return this.recordsArray},e.prototype.firstRecord=function(){return this.recordsArray[0]},e.prototype.lastRecord=function(){return this.recordsArray[this.recordsArray.length-1]},e.prototype.createMutableModel=function(){return new PS.MutableRecordModelImpl(this.recordV2Constructor,this)},e.prototype.createModel=function(){var e=[];return this.recordsArray.forEach(function(t){var r=t.createModel();if(t.min>0)for(var n=0;n<t.min;++n)e.push([].concat(r))}),e},e.prototype.asJSON=function(){return JSON.stringify({records:this.recordsArray.map(bS.toJSON)})},e.prototype.toString=function(){return"Schema [Records="+this.recordsArray+"]"},e}();MS.SchemaImpl=LS;var DS={},jS=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};function US(e,t,r){if(t<0)throw new Error("'"+e+"' has invalid 'min' value '"+t+"'");if(-1!==r&&(r<1||r<t))throw new Error("'"+e+"' has invalid 'max' value '"+r+"'")}Object.defineProperty(DS,"__esModule",{value:!0});var xS=function(){function e(e){this.records=[],this.recordV2Constructor=e}return e.prototype.record=function(e,t,r){return void 0===t&&(t=1),void 0===r&&(r=t),US(e,t,r),this.checkRecord(e),void 0!==this.currentFields&&this.addRecord(),this.currentName=e,this.currentMin=t,this.currentMax=r,this.currentFields=[],this},e.prototype.string=function(e,t,r){return void 0===t&&(t=1),void 0===r&&(r=t),US(e,t,r),this.checkField(e),this.currentFields.push(new lS.FieldImpl(e,lS.Type.STRING,t,r,this.fieldIndex())),this},e.prototype.integer=function(e,t,r){return void 0===t&&(t=1),void 0===r&&(r=t),US(e,t,r),this.checkField(e),this.currentFields.push(new lS.FieldImpl(e,lS.Type.INTEGER,t,r,this.fieldIndex())),this},e.prototype.decimal=function(e,t,r,n){return void 0===r&&(r=1),void 0===n&&(n=r),US(e,r,n),function(e,t){if(t<1)throw new Error("'"+e+"' has invalid 'scale' value '"+t+"'")}(e,t),this.checkField(e),this.currentFields.push(new lS.FieldImpl(e,lS.Type.DECIMAL,r,n,this.fieldIndex(),t)),this},e.prototype.build=function(){if(void 0!==this.currentFields&&this.addRecord(),0===this.records.length)throw new Error("Schema has no records");return new MS.SchemaImpl(this.recordV2Constructor,this.records)},e.prototype.fieldIndex=function(){var e=this.currentFields;if(0===e.length)return 0;var t=e[e.length-1];return t.index+t.max},e.prototype.addRecord=function(){var e,t=this.currentFields;if(0===t.length)throw new Error("No fields specified for record: '"+this.currentName+"'");if(0===this.records.length)e=0;else{var r=this.records[this.records.length-1];e=r.index+r.max}this.records.push(new bS.RecordImpl(this.currentName,this.currentMin,this.currentMax,e,t))},e.prototype.checkRecord=function(e){var t,r;if(S_.requireNonNull(e,"name"),e===this.currentName)throw new Error("Duplicate record name: '"+e+"'");if(this.records.length)try{for(var n=jS(this.records),o=n.next();!o.done;o=n.next()){if(e===o.value.name)throw new Error("Duplicate record name: '"+e+"'")}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}if(void 0!==this.currentFields&&this.currentMin!==this.currentMax)throw new Error("Record '"+e+"' not allowed after variable multiplicity record: '"+this.currentName+"'")},e.prototype.checkField=function(e){var t,r;if(S_.requireNonNull(e,"name"),void 0===this.currentFields)throw new Error("Cannot add field '"+e+"' as there is no current record");if(this.currentFields.length){try{for(var n=jS(this.currentFields),o=n.next();!o.done;o=n.next()){if(e===o.value.name)throw new Error("Duplicate field name: '"+e+"'")}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}var i=this.currentFields[this.currentFields.length-1];if(i.isVariable)throw new Error("Field '"+e+"' is not allowed after variable multiplicity field '"+i.name+"'")}},e}();DS.SchemaBuilderImpl=xS;var BS={};Object.defineProperty(BS,"__esModule",{value:!0});var kS=function(){function e(e){this.recordV2Constructor=e}return e.prototype.parse=function(e){var t,r=new DS.SchemaBuilderImpl(this.recordV2Constructor);try{t=JSON.parse(e)}catch(e){throw new Error("Invalid Schema JSON string")}if(void 0===t.records)throw new Error("Schema has no records");return t.records.forEach(function(e){void 0!==e.occurs?r.record(e.name,e.occurs):r.record(e.name,e.min,e.max),e.fields&&e.fields.forEach(function(e){var t,n;void 0!==e.occurs?(t=e.occurs,n=e.occurs):(t=e.min,n=e.max);var o=e.type||"STRING";switch(o.toUpperCase()){case"STRING":r.string(e.name,t,n);break;case"INTEGER":r.integer(e.name,t,n);break;case"DECIMAL":var i=e.scale||2;r.decimal(e.name,i,t,n);break;default:throw new Error("Invalid field type value '"+o+"'")}})}),r.build()},e}();BS.SchemaParser=kS;var qS={},VS=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function FS(){}Object.defineProperty(qS,"__esModule",{value:!0});var GS=function(e){function t(t){void 0===t&&(t=FS);var r=e.call(this,"record_v2",TS.RecordV2Impl,TS.RecordV2Impl,TS.RecordV2Impl.from,i_.identity,[],!0)||this;return r.RecordV2=TS.RecordV2Impl,r.validator=t,r}return VS(t,e),t.prototype.from=function(e){return TS.RecordV2Impl.from(e)},t.prototype.validate=function(e){this.validator(S_.requireNonNull(e,"RecordV2 instance"))},t.prototype.parseSchema=function(e){return new BS.SchemaParser(TS.RecordV2Impl).parse(e)},t.prototype.schemaBuilder=function(){return new DS.SchemaBuilderImpl(TS.RecordV2Impl)},t.prototype.valueBuilder=function(){return new IS.RecordV2BuilderImpl},t.prototype.withSchema=function(e){return new t(function(t){return t.asValidatedModel(e)})},t}(n_.AbstractDataType);qS.RecordV2DataTypeImpl=GS;var HS={};Object.defineProperty(HS,"__esModule",{value:!0});var WS=function(){function e(e,t,r){this.metadata=e,this.originalEvent=t,this.value=r,this.sequence=e.sequence,this.timestamp=e.timestamp,this.author=e.author,this.isEditEvent=!e.equals(t),this.isOriginalEvent=!this.isEditEvent}return e.create=function(t,r,n){return new e(t,r,n)},e.prototype.withValue=function(t){return new e(this.metadata,this.originalEvent,t)},e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.metadata.equals(t.metadata)&&this.originalEvent.equals(t.originalEvent)&&this.value===t.value)},e.prototype.toString=function(){return(this.isEditEvent?"Edit of ["+this.originalEvent+"]":"")+"["+this.metadata+"] "+this.value},e}();HS.EventImpl=WS;var YS={};Object.defineProperty(YS,"__esModule",{value:!0});var zS=function(){function e(e,t,r){this.sequence=e,this.timestamp=t,this.author=r}return e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.sequence===t.sequence&&this.timestamp===t.timestamp&&this.author===t.author)},e}();YS.EventMetadataImpl=zS;var JS={},$S=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(JS,"__esModule",{value:!0});var KS=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $S(t,e),t.prototype.read=function(e){var t=jy.readInt64(e),r=jy.readInt64(e),n=jy.readString(e);return new YS.EventMetadataImpl(t.toNumber(),r.toNumber(),n)},t.prototype.write=function(e,t){jy.writeInt64(e,t.sequence),jy.writeInt64(e,t.timestamp),jy.writeString(e,t.author)},t}(By.AbstractSerialiser);JS.EventMetadataImplSerialiser=new KS;var QS,XS={},ZS=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function eE(e,t){var r=new ev.BufferOutputStream;t.isEditEvent?(jy.writeByte(r,QS.EDIT_EVENT),JS.EventMetadataImplSerialiser.write(r,t.originalEvent)):jy.writeByte(r,QS.ORIGINAL_EVENT),JS.EventMetadataImplSerialiser.write(r,t);var n=e(t.value);return jy.writeBytes(r,n.$buffer),r.getBuffer()}function tE(e,t){var r=new Xy.BufferInputStream(t.$buffer),n=jy.readByte(r);switch(n){case QS.ORIGINAL_EVENT:return function(e,t){var r=JS.EventMetadataImplSerialiser.read(t),n=e(jy.readBytes(t));return HS.EventImpl.create(r,r,n)}(e,r);case QS.EDIT_EVENT:return function(e,t){var r=JS.EventMetadataImplSerialiser.read(t),n=JS.EventMetadataImplSerialiser.read(t),o=e(jy.readBytes(t));return HS.EventImpl.create(n,r,o)}(e,r);default:throw new Error("Unrecognised event type: "+n)}}Object.defineProperty(XS,"__esModule",{value:!0}),function(e){e[e.ORIGINAL_EVENT=0]="ORIGINAL_EVENT",e[e.EDIT_EVENT=1]="EDIT_EVENT"}(QS||(QS={}));var rE=function(e){function t(t,r,n,o){var i=e.call(this,t,HS.EventImpl,e_.BytesImpl,function(e){return function(e,t){if(!t)throw new Error("Cannot convert null event to Bytes");return new e_.BytesImpl(eE(e,t))}(o,e)},function(e){return tE(n,e)},[],!0)||this;return i.valueToBytes=o,i.valueTypeName=r,i}return ZS(t,e),t.create=function(e){return new t("timeseriesevent-"+e.name(),e.name(),e.readValue.bind(e),e.toBytes.bind(e))},t.prototype.writeValue=function(e){return eE(this.valueToBytes,e)},t.prototype.validate=function(){},t.prototype.from=function(e){return e instanceof Tv.BufferSlice?e:this.valueToBytes(e.value)},t}(n_.AbstractDataType);XS.TimeSeriesEventDataType=rE;var nE={};Object.defineProperty(nE,"__esModule",{value:!0});var oE=function(){return function(e,t,r){this.id=e,this.stateful=t,this.functional=r}}();nE.TopicTypeEnum={SLAVE:new oE(7,!0,!1),ROUTING:new oE(12,!1,!0),BINARY:new oE(14,!0,!1),JSON:new oE(15,!0,!1),STRING:new oE(17,!0,!1),INT64:new oE(18,!0,!1),DOUBLE:new oE(19,!0,!1),TIME_SERIES:new oE(16,!0,!1),RECORD_V2:new oE(20,!0,!1),UNKNOWN_TOPIC_TYPE:new oE(21,!1,!1)},sv.enumerize(nE.TopicTypeEnum);var iE={};(function(e){"use strict";Object.defineProperty(iE,"__esModule",{value:!0});var t=function(){function t(){this.recordv2Impl=new qS.RecordV2DataTypeImpl,this.binaryImpl=new u_.BinaryDataTypeImpl,this.stringImpl=new eS.StringDataTypeImpl,this.doubleImpl=new Y_.DoubleDataTypeImpl,this.int64Impl=new K_.Int64DataTypeImpl,this.jsonImpl=new F_.JSONDataTypeImpl,this.anyImpl=new yv.AnyDataTypeImpl}return t.prototype.binary=function(){return this.binaryImpl},t.prototype.string=function(){return this.stringImpl},t.prototype.double=function(){return this.doubleImpl},t.prototype.int64=function(){return this.int64Impl},t.prototype.json=function(){return this.jsonImpl},t.prototype.recordv2=function(){return this.recordv2Impl},t.prototype.any=function(){return this.anyImpl},t.prototype.timeseries=function(e){return XS.TimeSeriesEventDataType.create(e)},t.prototype.getByName=function(e){switch(e.toLowerCase()){case"json":return this.json();case"int64":return this.int64();case"binary":return this.binary();case"string":return this.string();case"double":return this.double();case"record_v2":return this.recordv2();default:return}},t.prototype.getByValue=function(t){return t===nE.TopicTypeEnum.BINARY||t instanceof a_.BinaryImpl||e.isBuffer(t)?this.binary():t===nE.TopicTypeEnum.JSON||t instanceof j_.JSONImpl||t.constructor===Object?this.json():t===nE.TopicTypeEnum.STRING||"string"==typeof t?this.string():t===nE.TopicTypeEnum.DOUBLE||"number"==typeof t?this.double():t===nE.TopicTypeEnum.INT64||t instanceof gv.Int64Impl?this.int64():t===nE.TopicTypeEnum.RECORD_V2||t instanceof TS.RecordV2Impl?this.recordv2():void 0},t.prototype.get=function(e){var t;return"string"==typeof e&&(t=this.getByName(e)),t||(t=this.getByValue(e)),t||(t=this.getByClassSafely(e)),t||null},t.prototype.getChecked=function(e){if(!e)throw new Error("No data type for "+e);if(e instanceof qS.RecordV2DataTypeImpl||e instanceof u_.BinaryDataTypeImpl||e instanceof eS.StringDataTypeImpl||e instanceof Y_.DoubleDataTypeImpl||e instanceof K_.Int64DataTypeImpl||e instanceof F_.JSONDataTypeImpl)return e;var t=this.get(e);if(null===t)throw new Error("No data type for "+e);return t},t.prototype.getValueClassChecked=function(e){switch(this.getChecked(e)){case this.jsonImpl:return j_.JSONImpl;case this.binaryImpl:return a_.BinaryImpl;case this.stringImpl:return String;case this.doubleImpl:return Number;case this.int64Impl:return gv.Int64Impl;case this.recordv2Impl:return TS.RecordV2Impl;default:return}},t.prototype.getByClassSafely=function(e){switch(e){case j_.JSONImpl:return this.jsonImpl;case a_.BinaryImpl:return this.binaryImpl;case String:return this.stringImpl;case Number:return this.doubleImpl;case gv.Int64Impl:return this.int64Impl;case TS.RecordV2Impl:return this.recordv2Impl;default:return}},t.prototype.getByClass=function(e){var t=this.getByClassSafely(e);if(t)return t;throw new Error("No data type for "+e)},t}(),r=new t;iE.DataTypes=r}).call(this,{isBuffer:Rv});var sE={},aE=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(sE,"__esModule",{value:!0});var uE=function(){function e(e,t){this.listeners=e.getListeners(),this.errorCallback=e.getErrorCallback(),this.closeCallback=e.getCloseCallback(),t&&(this.allowedEvents=["close","error","complete"].concat(t))}return e.prototype.on=function(e,t){return this.attach(e,t),this},e.prototype.off=function(e,t){return this.remove(e,t),this},e.prototype.close=function(e){return this.closeCallback(e),this},e.prototype.error=function(e){return this.errorCallback(e),this},e.prototype.attach=function(e,t){var r,n;if("object"==typeof e)try{for(var o=aE(Object.keys(e)),i=o.next();!i.done;i=o.next()){var s=i.value;this.attach(s,e[s])}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}else if(t){if(!this.listeners.hasOwnProperty(e)){if(this.allowedEvents&&-1===this.allowedEvents.indexOf(e))throw new Error("Event "+e+" not emitted on this stream, allowed events are "+this.allowedEvents);this.listeners[e]=[]}this.listeners[e].push(t)}},e.prototype.remove=function(e,t){var r,n;if("object"==typeof e)try{for(var o=aE(Object.keys(e)),i=o.next();!i.done;i=o.next()){var s=i.value;this.remove(s,e[s])}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}else this.listeners.hasOwnProperty(e)&&(this.listeners[e]=t?this.listeners[e].filter(function(e){return e!==t}):[])},e}();sE.StreamImpl=uE;var cE,pE,fE,lE=cE={};function hE(){throw new Error("setTimeout has not been defined")}function dE(){throw new Error("clearTimeout has not been defined")}function yE(e){if(pE===setTimeout)return setTimeout(e,0);if((pE===hE||!pE)&&setTimeout)return pE=setTimeout,setTimeout(e,0);try{return pE(e,0)}catch(t){try{return pE.call(null,e,0)}catch(t){return pE.call(this,e,0)}}}!function(){try{pE="function"==typeof setTimeout?setTimeout:hE}catch(e){pE=hE}try{fE="function"==typeof clearTimeout?clearTimeout:dE}catch(e){fE=dE}}();var vE,_E=[],SE=!1,EE=-1;function mE(){SE&&vE&&(SE=!1,vE.length?_E=vE.concat(_E):EE=-1,_E.length&&wE())}function wE(){if(!SE){var e=yE(mE);SE=!0;for(var t=_E.length;t;){for(vE=_E,_E=[];++EE<t;)vE&&vE[EE].run();EE=-1,t=_E.length}vE=null,SE=!1,function(e){if(fE===clearTimeout)return clearTimeout(e);if((fE===dE||!fE)&&clearTimeout)return fE=clearTimeout,clearTimeout(e);try{fE(e)}catch(t){try{return fE.call(null,e)}catch(t){return fE.call(this,e)}}}(e)}}function gE(e,t){this.fun=e,this.array=t}function OE(){}lE.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];_E.push(new gE(e,t)),1!==_E.length||SE||yE(wE)},gE.prototype.run=function(){this.fun.apply(null,this.array)},lE.title="browser",lE.browser=!0,lE.env={},lE.argv=[],lE.version="",lE.versions={},lE.on=OE,lE.addListener=OE,lE.once=OE,lE.off=OE,lE.removeListener=OE,lE.removeAllListeners=OE,lE.emit=OE,lE.prependListener=OE,lE.prependOnceListener=OE,lE.listeners=function(e){return[]},lE.binding=function(e){throw new Error("process.binding is not supported")},lE.cwd=function(){return"/"},lE.chdir=function(e){throw new Error("process.chdir is not supported")},lE.umask=function(){return 0};var TE={};(function(e){"use strict";var t=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(TE,"__esModule",{value:!0});var r=new(function(){function r(){this.pendingEvents=[],this.events=[],this.busy=!1}return r.prototype.addEmitterEvent=function(t){var r=this;this.pendingEvents.push(t),this.busy||(this.busy=!0,e.nextTick(function(){r.drainEmitterQueue()}))},r.prototype.drainEmitterQueue=function(){var r,n,o=this;this.events=this.pendingEvents,this.pendingEvents=[];try{for(var i=t(this.events),s=i.next();!s.done;s=i.next()){var a=s.value;try{a()}catch(e){}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}this.pendingEvents.length>0?e.nextTick(function(){o.drainEmitterQueue()}):this.busy=!1},r}()),n=function(){function e(e){var t=this;if(this.listeners={},this.closed=!1,this.listener=function(){},void 0===e||void 0===e.stream){var r={getListeners:function(){return t.listeners},getErrorCallback:function(){return t.error.bind(t)},getCloseCallback:function(){return t.close.bind(t)}};this.stream=new sE.StreamImpl(r,e&&e.allowedEvents)}else{if(this.stream=e.stream,void 0===e.listeners)throw new Error("Listeners must be defined when supplying a stream");this.listeners=e.listeners}void 0!==e&&void 0!==e.event&&this.stream.on(e.event,e.callback)}return e.create=function(t){var r={},n=function(){},o=function(){};return{getListeners:function(){return r},getErrorCallback:function(){return function(e){n(e)}},getCloseCallback:function(){return function(e){o(e)}},emitter:function(i){var s=new e({stream:i,listeners:r,allowedEvents:t});return n=s.error.bind(s),o=s.close.bind(s),s}}},e.prototype.emit_unsafe=function(e,t){var n=this,o=function(e){i_.callWithArguments(e,t||[])};r.addEmitterEvent(function(){n.listeners.hasOwnProperty(e)&&n.listeners[e].forEach(o)}),this.listener(e,t)},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];!this.closed&&e&&this.emit_unsafe(e,t)},e.prototype.immediate=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this.closed&&e){this.listeners.hasOwnProperty(e)&&this.listeners[e].forEach(function(e){try{i_.callWithArguments(e,t||[])}catch(e){}})}},e.prototype.error=function(e){this.closed||(this.emit_unsafe("error",[e]),this.close(e?e.message:void 0))},e.prototype.close=function(e){this.closed||(this.closed=!0,this.emit_unsafe("close",[e]))},e.prototype.listen=function(e){this.listener=e},e.prototype.get=function(){return this.stream},e}();TE.Emitter=n}).call(this,cE);var IE={};Object.defineProperty(IE,"__esModule",{value:!0});var RE=function(){return function(e,t,r){this.id=e,this.path=t,this.specification=r}}();IE.TopicSpecificationInfo=RE;var bE={};Object.defineProperty(bE,"__esModule",{value:!0}),bE.read=function(e,t){var r=jy.readByte(e);if(void 0===t[r])throw new Error("Unable to decode enum value "+r);return t[t[r]]},bE.write=function(e,t){"number"==typeof t?jy.writeByte(e,t):jy.writeByte(e,t.id)};var CE={};Object.defineProperty(CE,"__esModule",{value:!0});var PE=["PUBLISH_VALUES_ONLY","SCHEMA","VALIDATE_VALUES","SLAVE_MASTER_TOPIC","TIDY_ON_UNSUBSCRIBE","TIME_SERIES_EVENT_VALUE_TYPE","TIME_SERIES_RETAINED_RANGE","TIME_SERIES_SUBSCRIPTION_RANGE","DONT_RETAIN_VALUE","PERSISTENT","REMOVAL","OWNER","COMPRESSION","CONFLATION","PRIORITY"],AE=function(){function e(e,t){void 0===t&&(t={}),this.type=e,this.properties=t}return e.prototype.withProperty=function(t,r){if("string"!=typeof t||PE.indexOf(t.toUpperCase())<0)throw new Error("Invalid key: "+t);if("string"!=typeof r)throw new Error("Invalid value, must be string: "+r);var n={};for(var o in n[t]=r,this.properties)o!==t&&(n[o]=this.properties[o]);return new e(this.type,n)},e.PUBLISH_VALUES_ONLY="PUBLISH_VALUES_ONLY",e.VALIDATE_VALUES="VALIDATE_VALUES",e.SLAVE_MASTER_TOPIC="SLAVE_MASTER_TOPIC",e.TIDY_ON_UNSUBSCRIBE="TIDY_ON_UNSUBSCRIBE",e.TIME_SERIES_EVENT_VALUE_TYPE="TIME_SERIES_EVENT_VALUE_TYPE",e.TIME_SERIES_RETAINED_RANGE="TIME_SERIES_RETAINED_RANGE",e.TIME_SERIES_SUBSCRIPTION_RANGE="TIME_SERIES_SUBSCRIPTION_RANGE",e.SCHEMA="SCHEMA",e.DONT_RETAIN_VALUE="DONT_RETAIN_VALUE",e.PERSISTENT="PERSISTENT",e.REMOVAL="REMOVAL",e.CONFLATION="CONFLATION",e.OWNER="OWNER",e.COMPRESSION="COMPRESSION",e.PRIORITY="PRIORITY",e}();CE.TopicSpecification=AE;var NE={};(function(e){"use strict";var t,r,n;Object.defineProperty(NE,"__esModule",{value:!0}),NE.read=function(o){if(r&&o.buffer.slice(o.pos,o.pos+n).equals(r))return o.readMany(n),t;var i=o.pos,s=bE.read(o,nE.TopicTypeEnum),a=jy.readDictionary(o,jy.readString),u=new CE.TopicSpecification(s,a);return n=o.pos-i,r=e.from(o.buffer.slice(i,o.pos)),t=Object.freeze(u),u},NE.write=function(e,t){bE.write(e,t.type),jy.writeDictionary(e,t.properties,jy.writeString)}}).call(this,r({}).Buffer);var ME={},LE=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ME,"__esModule",{value:!0});var DE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return LE(t,e),t.prototype.read=function(e){var t=jy.readInt32(e),r=jy.readString(e),n=NE.read(e);return new IE.TopicSpecificationInfo(t,r,n)},t.prototype.write=function(e,t){jy.writeInt32(e,t.id),jy.writeString(e,t.path),NE.write(e,t.specification)},t}(By.AbstractSerialiser);ME.TopicSpecificationInfoSerialiser=new DE;var jE={};Object.defineProperty(jE,"__esModule",{value:!0}),jE.memoize=function(e,t,r){void 0===t&&(t={}),void 0===r&&(r=i_.identity);var n=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=r(n),s=t[i];return s||(s=e.apply(e,n),t[i]=s,s)};return n._uncached=e,n};var UE={};function xE(e){return"'"===e||'"'===e}function BE(e){var t=[],r="",n=0,o=!1;e:for(;n<e.length;n++){var i=e[n];if(xE(i)){for(n++,r="",o=!1;n<e.length;n++){var s=e[n];if(o)r+=s,o=!1;else if("\\"===s)o=!0;else{if(s===i){t.push(r);continue e}r+=s}}throw new Error("Mis-quoted input")}}return t}function kE(e){for(var t=0;t<e.length;t++){var r=e.charAt(t);if('"'===r||"\\"===r||"'"===r){for(var n="",o=0;o<e.length;o++){var i=e.charAt(o);switch(i){case"\\":n+="\\\\";break;case'"':n+='\\"';break;case"'":n+="\\'";break;default:n+=i}}return n}}return e}Object.defineProperty(UE,"__esModule",{value:!0}),UE.split=function(e,t){if(""===e)return[];for(var r=[],n=t.length,o=e.lastIndexOf(t);o>-1;)r.push(e.substring(o+n,e.length)),o=(e=e.substring(0,o)).lastIndexOf(t);return r.push(e),r.reverse()},UE.escape=kE,UE.stringToSet=function(e){return new Ty.Set(BE(e))},UE.collectionToString=function(e){var t=[];return e.forEach(function(e){t.push('"'+kE(e)+'"')}),t.join(",")};var qE={};Object.defineProperty(qE,"__esModule",{value:!0}),function(e){e.PATH=">",e.SPLIT_PATH_PATTERN="?",e.FULL_PATH_PATTERN="*",e.SELECTOR_SET="#"}(qE.Prefix||(qE.Prefix={})),function(e){e.PATH=">",e.SPLIT_PATH_PATTERN="?",e.FULL_PATH_PATTERN="*",e.SELECTOR_SET="#"}(qE.Type||(qE.Type={}));var VE={};Object.defineProperty(VE,"__esModule",{value:!0}),VE.PATH_SEPARATOR="/",VE.split=function(e){return e.split(VE.PATH_SEPARATOR)},VE.canonicalise=function(e){if(!e)return"";var t=e.length,r=t>0&&e.charAt(0)===VE.PATH_SEPARATOR?1:0,n=t>1&&e.charAt(t-1)===VE.PATH_SEPARATOR?1:0;return e.substring(r,t-n)};var FE=function(){return function(e){this.includesDescendants=e}}();VE.DescendantQualifier=Object.freeze({MATCH:new FE(!1),DESCENDANTS_OF_MATCH:new FE(!0),MATCH_AND_DESCENDANTS:new FE(!0)});var GE={};Object.defineProperty(GE,"__esModule",{value:!0});var HE=function(){function e(e,t,r){this.type=e,this.prefix=t,this.expression=r}return e.prototype.selects=function(e){var t=VE.canonicalise(e);return 0===t.indexOf(this.prefix)&&this.doSelects(t)},e.prototype.toString=function(){return this.expression},e}();GE.AbstractTopicSelector=HE;var WE={};Object.defineProperty(WE,"__esModule",{value:!0}),WE.regex=function(e,t){if(void 0===t&&(t=""),""===e)throw new Error("Empty regular expression ["+t+"]");try{var r=new RegExp(e);return function(e){var t=r.exec(e);return t&&t[0]===e}}catch(e){throw new Error("Bad regular expression ["+e.message+", "+t+"]")}};var YE={},zE=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(YE,"__esModule",{value:!0});var JE=function(e){function t(t){var r=e.call(this,t.type,t.prefix,t.expression)||this;if(r.pattern=void 0,r.qualifier=t.qualifier,!t.base)throw new Error("Invalid full-path selector");return r.base=t.base,r}return zE(t,e),t.prototype.doSelects=function(e){if(!this.pattern)switch(this.qualifier){case VE.DescendantQualifier.DESCENDANTS_OF_MATCH:this.pattern=WE.regex(this.base+"/.+");break;case VE.DescendantQualifier.MATCH_AND_DESCENDANTS:this.pattern=WE.regex(this.base+"(?:$|/.+)");break;default:case VE.DescendantQualifier.MATCH:this.pattern=WE.regex(this.base)}return!0===this.pattern(e)},t}(GE.AbstractTopicSelector);YE.FullPathSelector=JE;var $E={},KE=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($E,"__esModule",{value:!0});var QE=function(e){function t(t){var r=this,n=t.remainder;if(t.type===qE.Type.PATH){if(""===t.prefix)throw new Error("Topic path must have at least one part: "+n);if(t.prefix.indexOf("//")>-1)throw new Error("Topic path contains empty part: "+n)}return(r=e.call(this,t.type,t.prefix,t.expression)||this).qualifier=t.qualifier,r.path=t.prefix,r}return KE(t,e),t.prototype.doSelects=function(e){var t=this.path===e,r=0===e.indexOf(this.path+"/");switch(this.qualifier){case VE.DescendantQualifier.MATCH:return t;case VE.DescendantQualifier.DESCENDANTS_OF_MATCH:return r;case VE.DescendantQualifier.MATCH_AND_DESCENDANTS:return t||r;default:return!1}},t}(GE.AbstractTopicSelector);$E.PathSelector=QE;var XE={},ZE=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),em=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(XE,"__esModule",{value:!0}),XE.DELIMITER="////";var tm=function(e){function t(r){var n=this,o=[];r.forEach(function(e){e instanceof t?e.selectors.forEach(function(e){o.push(e)}):o.push(e)});var i=o.join(XE.DELIMITER),s=function(e){var t,r;if(0===e.length)return"";var n=Nv.MAX_INT32,o=[];e.forEach(function(e,t){var r=VE.split(e.prefix);n=Math.min(n,r.length),o[t]=r});var i=[];e:for(var s=0;s<n;++s){var a=o[0][s];try{for(var u=em(o),c=u.next();!c.done;c=u.next())if(a!==c.value[s])break e}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}i.push(a),i.push(VE.PATH_SEPARATOR)}return VE.canonicalise(i.join(""))}(o);return(n=e.call(this,qE.Type.SELECTOR_SET,s,qE.Prefix.SELECTOR_SET+i)||this).selectors=o,n}return ZE(t,e),t.prototype.selects=function(e){var t,r;try{for(var n=em(this.selectors),o=n.next();!o.done;o=n.next()){if(o.value.selects(e))return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1},t.prototype.doSelects=function(e){return this.selects(e)},t}(GE.AbstractTopicSelector);XE.SelectorSet=tm;var rm={},nm=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(rm,"__esModule",{value:!0});var om=function(e){function t(t){var r=e.call(this,t.type,t.prefix,t.expression)||this;return r.patterns=void 0,r.qualifier=t.qualifier,r.parts=VE.split(t.base),r.parts.forEach(function(e){if(!e)throw new Error("Invalid split-path selector")}),r}return nm(t,e),t.prototype.doSelects=function(e){this.patterns||(this.patterns=this.parts.map(function(e){return WE.regex(e)}));var t=this.patterns.length,r=e.split(VE.PATH_SEPARATOR);switch(this.qualifier){case VE.DescendantQualifier.MATCH:if(r.length!==t)return!1;break;case VE.DescendantQualifier.DESCENDANTS_OF_MATCH:if(r.length<=t)return!1;break;case VE.DescendantQualifier.MATCH_AND_DESCENDANTS:if(r.length<t)return!1}for(var n=0;n<t;++n)if(!this.patterns[n](r[n]))return!1;return!0},t}(GE.AbstractTopicSelector);rm.SplitPathSelector=om;var im={};(function(e){"use strict";Object.defineProperty(im,"__esModule",{value:!0});var t=VE.DescendantQualifier;function r(e){for(var n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];if(!e)throw new Error("Empty topic selector expression");if(n.length>0&&(e=[e].concat(n)),e instanceof Array){var a=e.map(function(e){return e instanceof GE.AbstractTopicSelector?e:r(e)});return new XE.SelectorSet(a)}if("string"==typeof e){var u=function(e){var r=function(e){switch(e[0]){case qE.Prefix.PATH:return qE.Type.PATH;case qE.Prefix.SPLIT_PATH_PATTERN:return qE.Type.SPLIT_PATH_PATTERN;case qE.Prefix.FULL_PATH_PATTERN:return qE.Type.FULL_PATH_PATTERN;case qE.Prefix.SELECTOR_SET:return qE.Type.SELECTOR_SET;case"$":case"%":case"&":case"<":throw new Error("Invalid expression type: "+e);default:return null}}(e);null===r&&(e=qE.Prefix.PATH+e,r=qE.Type.PATH);var n,s,a=e.substring(1);r===qE.Type.PATH?(s=a,n=t.MATCH):"/"===a[a.length-1]?"/"===a[a.length-2]?(n=t.MATCH_AND_DESCENDANTS,s=VE.canonicalise(a.substring(0,a.length-2))):(n=t.DESCENDANTS_OF_MATCH,s=VE.canonicalise(a.substring(0,a.length-1))):(s=VE.canonicalise(a),n=t.MATCH);var u=r===qE.Type.PATH?VE.canonicalise(a):function(e){for(var t=[],r=[],n=o,s=0,a=e.length;s<a;++s){var u=e[s];if("\\"===u&&s<a-1){var c=e[s+1];if(n===o&&"Q"===c)n=i;else if(n===i&&"E"===c)n=o;else{if(!(c<"a"||c>"z")||!(c<"A"||c>"Z")){t.length=0;break}t.push(c)}s++}else{if(!n(u)){t.length=0;break}u===VE.PATH_SEPARATOR&&(r.push(t.join("")),t.length=0),t.push(u)}}return r.push(t.join("")),VE.canonicalise(r.join(""))}(s);return{type:r,base:s,prefix:u,remainder:a,qualifier:n,expression:r+a}}(e);if(function(e){if(e.type===qE.Type.PATH)return!0;if(e.type===qE.Type.SELECTOR_SET||""===e.prefix)return!1;return e.prefix===e.base}(u))return new $E.PathSelector(u);switch(u.type){case qE.Type.SPLIT_PATH_PATTERN:return new rm.SplitPathSelector(u);case qE.Type.FULL_PATH_PATTERN:return new YE.FullPathSelector(u);case qE.Type.SELECTOR_SET:var c=UE.split(u.remainder,XE.DELIMITER).map(function(e){return r(e)});return new XE.SelectorSet(c)}}if(e instanceof GE.AbstractTopicSelector)return e;throw new Error("Topic selector expression must be a string or array")}var n=["*",".","+","?","^","$","{","}","(",")","[","]","\\","|"];function o(e){return-1===n.indexOf(e)}function i(){return!0}var s=e&&e.env&&"true"===e.env.DISABLE_TOPIC_CACHE?r:jE.memoize(r,{},function(e){return JSON.stringify(e)});im.parseSelector=s}).call(this,cE);var sm={},am=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(sm,"__esModule",{value:!0});var um=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return am(t,e),t.prototype.read=function(e){return im.parseSelector(jy.readString(e))},t.prototype.write=function(e,t){jy.writeString(e,t.expression)},t}(By.AbstractSerialiser);sm.TopicSelectorSerialiser=new um;var cm={};Object.defineProperty(cm,"__esModule",{value:!0});var pm=function(){function e(){}return e.prototype.read=function(e){return jy.readBoolean(e)},e.prototype.write=function(e,t){jy.writeBoolean(e,t)},e}();cm.BooleanSerialiser=new pm;var fm={};Object.defineProperty(fm,"__esModule",{value:!0});var lm=function(){function e(){}return e.prototype.read=function(e){return jy.readBytes(e)},e.prototype.write=function(e,t){jy.writeBytes(e,t)},e}();fm.BytesSerialiser=new lm;var hm={};Object.defineProperty(hm,"__esModule",{value:!0});var dm=function(){function e(){}return e.prototype.read=function(e){return jy.readString(e)},e.prototype.write=function(e,t){jy.writeString(e,t)},e}();hm.StringSerialiser=new dm;var ym={};Object.defineProperty(ym,"__esModule",{value:!0});var vm=function(){function e(e){this.script=S_.requireNonNull(e,"script")}return e.prototype.toString=function(){return"SecurityCommandScript ["+this.script+"]"},e}();ym.SecurityCommandScript=vm;var _m={},Sm=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(_m,"__esModule",{value:!0});var Em=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Sm(t,e),t.prototype.read=function(e){var t=jy.readString(e);return new ym.SecurityCommandScript(t)},t.prototype.write=function(e,t){jy.writeString(e,t.script)},t}(By.AbstractSerialiser);_m.SecurityCommandScriptSerialiser=new Em;var mm={};Object.defineProperty(mm,"__esModule",{value:!0});var wm=function(){function e(e,t,r,n){void 0===e&&(e=[]),void 0===r&&(r=[]),void 0===n&&(n={}),this.principals=e,this.anonymous={action:t,roles:r},this.trustedClientProposedProperties=n}return e.prototype.toString=function(){return"SystemAuthenticationConfiguration [principals="+this.principals+", anonymous="+this.anonymous+"]"},e}();mm.SystemAuthentication=wm,mm.CONNECTION_ACTION={ALLOW:{id:0,value:"allow"},DENY:{id:1,value:"deny"},ABSTAIN:{id:2,value:"abstain"}},sv.enumerize(mm.CONNECTION_ACTION),mm.connectionActionFromString=function(e){return mm.CONNECTION_ACTION[e.toUpperCase()]};var gm={};Object.defineProperty(gm,"__esModule",{value:!0});var Om=function(){return function(e){this.type=e}}();gm.SessionPropertyValidationImpl=Om;var Tm={};Object.defineProperty(Tm,"__esModule",{value:!0}),function(e){e.AUTHENTICATE="AUTHENTICATE",e.VIEW_SESSION="VIEW_SESSION",e.MODIFY_SESSION="MODIFY_SESSION",e.REGISTER_HANDLER="REGISTER_HANDLER",e.VIEW_SERVER="VIEW_SERVER",e.CONTROL_SERVER="CONTROL_SERVER",e.VIEW_SECURITY="VIEW_SECURITY",e.MODIFY_SECURITY="MODIFY_SECURITY",e.UNKNOWN_GLOBAL_PERMISSION="UNKNOWN_GLOBAL_PERMISSION",e.READ_TOPIC_VIEWS="READ_TOPIC_VIEWS",e.MODIFY_TOPIC_VIEWS="MODIFY_TOPIC_VIEWS"}(Tm.GlobalPermission||(Tm.GlobalPermission={})),function(e){e.READ_TOPIC="READ_TOPIC",e.UPDATE_TOPIC="UPDATE_TOPIC",e.MODIFY_TOPIC="MODIFY_TOPIC",e.SEND_TO_MESSAGE_HANDLER="SEND_TO_MESSAGE_HANDLER",e.SEND_TO_SESSION="SEND_TO_SESSION",e.SELECT_TOPIC="SELECT_TOPIC",e.QUERY_OBSOLETE_TIME_SERIES_EVENTS="QUERY_OBSOLETE_TIME_SERIES_EVENTS",e.EDIT_TIME_SERIES_EVENTS="EDIT_TIME_SERIES_EVENTS",e.EDIT_OWN_TIME_SERIES_EVENTS="EDIT_OWN_TIME_SERIES_EVENTS",e.ACQUIRE_LOCK="ACQUIRE_LOCK",e.UNKNOWN_PATH_PERMISSION="UNKNOWN_PATH_PERMISSION",e.UNKNOWN_TOPIC_PERMISSION="UNKNOWN_TOPIC_PERMISSION"}(Tm.PathPermission||(Tm.PathPermission={})),function(e){e[e.REGEX=0]="REGEX",e[e.VALUES=1]="VALUES"}(Tm.ValidationType||(Tm.ValidationType={}));var Im={},Rm=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Im,"__esModule",{value:!0});var bm=function(e){function t(t){var r=e.call(this,Tm.ValidationType.REGEX)||this;return r.regex=t,r}return Rm(t,e),t.prototype.toString=function(){return"SessionPropertyValidation [type="+this.type+", regex="+this.regex+"]"},t}(gm.SessionPropertyValidationImpl);Im.MatchesSessionPropertyValidationImpl=bm;var Cm={},Pm=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Cm,"__esModule",{value:!0});var Am=function(e){function t(t){var r=e.call(this,Tm.ValidationType.VALUES)||this;return r.values=t,r}return Pm(t,e),t.prototype.toString=function(){return"SessionPropertyValidation [type="+this.type+", values="+this.values+"]"},t}(gm.SessionPropertyValidationImpl);Cm.ValuesSessionPropertyValidationImpl=Am;var Nm={},Mm=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Nm,"__esModule",{value:!0});var Lm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Mm(t,e),t.prototype.read=function(e){if(bE.read(e,Tm.ValidationType)===Tm.ValidationType.REGEX)return new Im.MatchesSessionPropertyValidationImpl(jy.readString(e));var t=jy.readCollection(e,jy.readString);return new Cm.ValuesSessionPropertyValidationImpl(t)},t.prototype.write=function(e,t){var r=t.type;if(jy.writeByte(e,r),r===Tm.ValidationType.REGEX){var n=t;jy.writeString(e,n.regex)}else{var o=t;jy.writeCollection(e,o.values,jy.writeString)}},t}(By.AbstractSerialiser);Nm.SessionPropertyValidationSerialiser=new Lm;var Dm={};Object.defineProperty(Dm,"__esModule",{value:!0});var jm=function(){function e(e,t,r){this.name=S_.requireNonNull(e,"name"),this.roles=t||[],this.lockingPrincipal=r}return e.prototype.toString=function(){return"SystemPrincipal ["+this.name+", "+this.roles+"]"},e}();Dm.SystemPrincipalImpl=jm;var Um={},xm=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Um,"__esModule",{value:!0});var Bm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xm(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=jy.readCollection(e,jy.readString),n=jy.readBoolean(e)?jy.readString(e):void 0;return new Dm.SystemPrincipalImpl(t,r,n)},t.prototype.write=function(e,t){jy.writeString(e,t.name),jy.writeCollection(e,t.roles,jy.writeString),jy.writeBoolean(e,!!t.lockingPrincipal),t.lockingPrincipal&&jy.writeString(e,t.lockingPrincipal)},t}(By.AbstractSerialiser);Um.SystemPrincipalSerialiser=new Bm;var km={},qm=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(km,"__esModule",{value:!0});var Vm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qm(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,Um.SystemPrincipalSerialiser.read),r=bE.read(e,mm.CONNECTION_ACTION),n=jy.readCollection(e,jy.readString),o=jy.readDictionary(e,Nm.SessionPropertyValidationSerialiser.read);return new mm.SystemAuthentication(t,r.value,n,o)},t.prototype.write=function(e,t){jy.writeCollection(e,t.principals,Um.SystemPrincipalSerialiser.write);var r=mm.connectionActionFromString(t.anonymous.action);jy.writeByte(e,r.id),jy.writeCollection(e,t.anonymous.roles,jy.writeString),jy.writeDictionary(e,t.trustedClientProposedProperties,Nm.SessionPropertyValidationSerialiser.write)},t}(By.AbstractSerialiser);km.SystemAuthenticationConfigurationSerialiser=new Vm;var Fm,Gm={};Object.defineProperty(Gm,"__esModule",{value:!0}),function(e){e[e.NONE=0]="NONE",e[e.PLAIN=1]="PLAIN",e[e.CUSTOM=2]="CUSTOM"}(Fm||(Fm={})),Gm.read=function(e){switch(bE.read(e,Fm)){case Fm.NONE:return jy.readBytes(e),null;case Fm.PLAIN:return jy.readString(e)||null;case Fm.CUSTOM:return jy.readBytes(e)}},Gm.write=function(e,t){null!=t?"string"==typeof t?(bE.write(e,Fm.PLAIN),jy.writeString(e,t)):(bE.write(e,Fm.CUSTOM),jy.writeBytes(e,t)):(bE.write(e,Fm.NONE),jy.writeInt32(e,0))};var Hm={},Wm=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Hm,"__esModule",{value:!0});var Ym=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Wm(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.principal),Gm.write(e,t.credentials)},t}(By.AbstractSerialiser);Hm.ChangePrincipalRequestSerialiser=new Ym;var zm={};Object.defineProperty(zm,"__esModule",{value:!0});var Jm=function(){return function(e,t){this.filter=e,this.selector=t}}();zm.ClientFilterSubscribeRequest=Jm;var $m={},Km=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($m,"__esModule",{value:!0});var Qm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Km(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=sm.TopicSelectorSerialiser.read(e);return new zm.ClientFilterSubscribeRequest(t,r)},t.prototype.write=function(e,t){jy.writeString(e,t.filter),sm.TopicSelectorSerialiser.write(e,t.selector)},t}(By.AbstractSerialiser);$m.ClientFilterSubscribeRequestSerialiser=new Qm;var Xm={};Object.defineProperty(Xm,"__esModule",{value:!0});var Zm=function(){function e(e,t,r){this.message=S_.requireNonNull(e,"message"),this.line=t||0,this.column=r||0}return e.prototype.toString=function(){return"ErrorReport ["+this.message+" at ["+this.line+":"+this.column+"]]"},e}();Xm.ErrorReportImpl=Zm;var ew={},tw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ew,"__esModule",{value:!0});var rw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tw(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=jy.readInt32(e),n=jy.readInt32(e);return new Xm.ErrorReportImpl(t,r,n)},t.prototype.write=function(e,t){jy.writeString(e,t.message),jy.writeInt32(e,t.line),jy.writeInt32(e,t.column)},t}(By.AbstractSerialiser);ew.ErrorReportSerialiser=new rw;var nw={};Object.defineProperty(nw,"__esModule",{value:!0});var ow=function(){function e(e,t){this.selected=e,this.errors=t}return e.prototype.isSuccess=function(){return 0===this.errors.length},e}();nw.ClientFilterSubscribeResponse=ow;var iw={},sw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(iw,"__esModule",{value:!0});var aw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return sw(t,e),t.prototype.read=function(e){if(jy.readByte(e)){var t=jy.readCollection(e,ew.ErrorReportSerialiser.read);return new nw.ClientFilterSubscribeResponse(0,t)}var r=jy.readInt32(e);return new nw.ClientFilterSubscribeResponse(r,[])},t.prototype.write=function(e,t){t.isSuccess()?(jy.writeByte(e,0),jy.writeInt32(e,t.selected)):(jy.writeByte(e,1),jy.writeCollection(e,t.errors,ew.ErrorReportSerialiser.write))},t}(By.AbstractSerialiser);iw.ClientFilterSubscribeResponseSerialiser=new aw;var uw={};Object.defineProperty(uw,"__esModule",{value:!0});var cw=function(){function e(e,t){this.server=e,this.value=t}return e.fromString=function(t){var r,n=t.split("-");if(2!==n.length)throw new Error("SessionId must consist of two hexadecimal parts, joined with a '-'");try{r=new e(oe.fromString(n[0],!1,16),oe.fromString(n[1],!1,16))}catch(e){throw new Error("SessionId must consist of two hexadecimal parts, joined with a '-'")}return r},e.validate=function(t){if(t instanceof e)return t;if(0===t.length||t.indexOf("-")<0||t.indexOf(" ")>=0)return!1;try{return e.fromString(t)}catch(e){return!1}},e.prototype.toString=function(){var e="0000000000000000"+this.server.toUnsigned().toString(16),t="0000000000000000"+this.value.toUnsigned().toString(16);return(e.substr(e.length-16)+"-"+t.substr(t.length-16)).toLowerCase()},e}();uw.SessionId=cw;var pw={};Object.defineProperty(pw,"__esModule",{value:!0});var fw=function(){function e(){}return e.prototype.read=function(e){var t=jy.readInt64(e),r=jy.readInt64(e);return new uw.SessionId(t,r)},e.prototype.write=function(e,t){jy.writeInt64(e,t.server),jy.writeInt64(e,t.value)},e}();pw.SessionIdSerialiser=new fw;var lw={};Object.defineProperty(lw,"__esModule",{value:!0});var hw=function(){return function(e,t){this.sessionID=e,this.selector=t}}();lw.ClientSubscribeRequest=hw;var dw={},yw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(dw,"__esModule",{value:!0});var vw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yw(t,e),t.prototype.read=function(e){var t=pw.SessionIdSerialiser.read(e),r=sm.TopicSelectorSerialiser.read(e);return new lw.ClientSubscribeRequest(t,r)},t.prototype.write=function(e,t){pw.SessionIdSerialiser.write(e,t.sessionID),sm.TopicSelectorSerialiser.write(e,t.selector)},t}(By.AbstractSerialiser);dw.ClientSubscribeRequestSerialiser=new vw;var _w={},Sw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(_w,"__esModule",{value:!0});var Ew=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Sw(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.filter),jy.writeCollection(e,t.rolesToRemove,jy.writeString),jy.writeCollection(e,t.rolesToAdd,jy.writeString)},t}(By.AbstractSerialiser);_w.ChangeAuthorisationRolesFilterRequestSerialiser=new Ew;var mw={},ww=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(mw,"__esModule",{value:!0});var gw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ww(t,e),t.prototype.write=function(e,t){if(void 0===t.sessionID||null===t.sessionID)throw new Error("Session ID is null or undefined");pw.SessionIdSerialiser.write(e,t.sessionID),jy.writeCollection(e,t.rolesToRemove,jy.writeString),jy.writeCollection(e,t.rolesToAdd,jy.writeString)},t}(By.AbstractSerialiser);mw.ChangeAuthorisationRolesRequestSerialiser=new gw;var Ow={};Object.defineProperty(Ow,"__esModule",{value:!0});var Tw=function(){function e(e){this.sessionID=e}return e.prototype.toString=function(){return"CloseClientRequest ["+this.sessionID+"]"},e}();Ow.CloseClientRequest=Tw;var Iw={},Rw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Iw,"__esModule",{value:!0});var bw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Rw(t,e),t.prototype.read=function(e){var t=pw.SessionIdSerialiser.read(e);return new Ow.CloseClientRequest(t)},t.prototype.write=function(e,t){pw.SessionIdSerialiser.write(e,t.sessionID)},t}(By.AbstractSerialiser);Iw.CloseClientRequestSerialiser=new bw;var Cw={},Pw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Cw,"__esModule",{value:!0});var Aw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pw(t,e),t.prototype.write=function(e,t){if(void 0===t.sessionID||null===t.sessionID)throw new Error("session ID is null or undefined");pw.SessionIdSerialiser.write(e,t.sessionID),void 0!==t.propertyKeys&&null!==t.propertyKeys?jy.writeCollection(e,t.propertyKeys,jy.writeString):jy.writeCollection(e,[],jy.writeString)},t}(By.AbstractSerialiser);Cw.GetSessionPropertiesRequestSerialiser=new Aw;var Nw={};Object.defineProperty(Nw,"__esModule",{value:!0});var Mw=function(){function e(e){this.properties=e}return e.prototype.toString=function(){return"GetSessionPropertiesResponse []"},e}();Nw.GetSessionPropertiesResponse=Mw;var Lw={},Dw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Lw,"__esModule",{value:!0});var jw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Dw(t,e),t.prototype.read=function(e){return jy.readBoolean(e)?new Nw.GetSessionPropertiesResponse(jy.readDictionary(e,jy.readString)):null},t}(By.AbstractSerialiser);Lw.GetSessionPropertiesResponseSerialiser=new jw;var Uw={};Object.defineProperty(Uw,"__esModule",{value:!0});var xw=function(){return function(e){this.name=e}}();Uw.ControlGroup=xw,Uw.DEFAULT=Object.freeze(new xw("default"));var Bw={},kw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Bw,"__esModule",{value:!0});var qw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return kw(t,e),t.prototype.read=function(e){var t=jy.readString(e);return new Uw.ControlGroup(t)},t.prototype.write=function(e,t){jy.writeString(e,t.name)},t}(By.AbstractSerialiser);Bw.ControlGroupSerialiser=new qw;var Vw={},Fw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Vw,"__esModule",{value:!0});var Gw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fw(t,e),t.prototype.write=function(e,t){jy.writeInt32(e,t.definition.id),Bw.ControlGroupSerialiser.write(e,t.group),jy.writeString(e,t.path),jy.writeCollection(e,t.keys,jy.writeString)},t}(By.AbstractSerialiser);Vw.MessageReceiverControlRegistrationParamsSerialiser=new Gw;var Hw={},Ww=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Hw,"__esModule",{value:!0});var Yw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ww(t,e),t.prototype.write=function(e,t){Vw.MessageReceiverControlRegistrationParamsSerialiser.write(e,t.params),Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser);Hw.MessageReceiverControlRegistrationRequestSerialiser=new Yw;var zw={};Object.defineProperty(zw,"__esModule",{value:!0});var Jw=function(){return function(e,t,r,n,o,i){this.cid=e,this.sessionID=t,this.path=r,this.properties=n,this.dataType=o,this.content=i}}();zw.MessagingClientForwardSendRequest=Jw;var $w={},Kw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($w,"__esModule",{value:!0});var Qw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Kw(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e),r=pw.SessionIdSerialiser.read(e),n=jy.readString(e),o=jy.readDictionary(e,jy.readString),i=jy.readString(e),s=jy.readBytes(e);return new zw.MessagingClientForwardSendRequest(t,r,n,o,i,s)},t}(By.AbstractSerialiser);$w.MessagingClientForwardSendRequestSerialiser=new Qw;var Xw={},Zw=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Xw,"__esModule",{value:!0});var eg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zw(t,e),t.prototype.write=function(e,t){pw.SessionIdSerialiser.write(e,t.sessionId),jy.writeString(e,t.path),jy.writeString(e,t.dataType),jy.writeBytes(e,t.request)},t}(By.AbstractSerialiser);Xw.MessagingClientSendRequestSerialiser=new eg;var tg={};Object.defineProperty(tg,"__esModule",{value:!0});var rg=function(){return function(e,t,r,n){this.cid=e,this.sessionID=t,this.response=r,this.errorReason=n}}();tg.MessagingFilterResponse=rg;var ng={};Object.defineProperty(ng,"__esModule",{value:!0});var og=function(){return function(e,t){this.responseDataType=e,this.data=t}}();ng.MessagingResponse=og;var ig={},sg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ig,"__esModule",{value:!0});var ag=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return sg(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=jy.readBytes(e);return new ng.MessagingResponse(t,r)},t.prototype.write=function(e,t){jy.writeString(e,t.responseDataType),jy.writeBytes(e,t.data)},t}(By.AbstractSerialiser);ig.MessagingResponseSerialiser=new ag;var ug={},cg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ug,"__esModule",{value:!0});var pg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cg(t,e),t.prototype.read=function(e){var t=jy.readInt32(e),r=jy.readString(e);return new re.ErrorReason(t,r)},t.prototype.write=function(e,t){jy.writeInt32(e,t.id),jy.writeString(e,t.reason)},t}(By.AbstractSerialiser);ug.ErrorReasonSerialiser=new pg;var fg={},lg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(fg,"__esModule",{value:!0});var hg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lg(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e),r=pw.SessionIdSerialiser.read(e);switch(jy.readByte(e)){case 0:var n=ig.MessagingResponseSerialiser.read(e);return new tg.MessagingFilterResponse(t,r,n);default:var o=ug.ErrorReasonSerialiser.read(e);return new tg.MessagingFilterResponse(t,r,null,o)}},t}(By.AbstractSerialiser);fg.MessagingFilterResponseSerialiser=new hg;var dg={},yg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(dg,"__esModule",{value:!0});var vg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yg(t,e),t.prototype.write=function(e,t){Uy.CIDSerialiser.write(e,t.cid),jy.writeString(e,t.filter),jy.writeString(e,t.path),jy.writeString(e,t.dataType.name()),jy.writeBytes(e,t.request)},t}(By.AbstractSerialiser);dg.MessagingFilterSendRequestSerialiser=new vg;var _g={};Object.defineProperty(_g,"__esModule",{value:!0});var Sg=function(){return function(e,t){this.numberSent=e,this.errors=t,this.isSuccess=0===t.length}}();_g.MessagingFilterSendResponse=Sg;var Eg={},mg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Eg,"__esModule",{value:!0});var wg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mg(t,e),t.prototype.read=function(e){if(0===jy.readByte(e)){var t=jy.readInt32(e);return new _g.MessagingFilterSendResponse(t,[])}var r=jy.readCollection(e,ew.ErrorReportSerialiser.read);return new _g.MessagingFilterSendResponse(0,r)},t}(By.AbstractSerialiser);Eg.MessagingFilterSendResponseSerialiser=new wg;var gg={};Object.defineProperty(gg,"__esModule",{value:!0});var Og=function(){return function(e,t,r){this.path=e,this.dataType=t,this.request=r}}();gg.MessagingSendRequest=Og;var Tg={},Ig=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Tg,"__esModule",{value:!0});var Rg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ig(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=jy.readString(e),n=jy.readBytes(e);return new gg.MessagingSendRequest(t,r,n)},t.prototype.write=function(e,t){jy.writeString(e,t.path),jy.writeString(e,t.dataType),jy.writeBytes(e,t.request)},t}(By.AbstractSerialiser);Tg.MessagingSendRequestSerialiser=new Rg;var bg={};Object.defineProperty(bg,"__esModule",{value:!0}),function(e){e[e.CONNECTION_LOST=0]="CONNECTION_LOST",e[e.IO_EXCEPTION=1]="IO_EXCEPTION",e[e.CLIENT_UNRESPONSIVE=2]="CLIENT_UNRESPONSIVE",e[e.MESSAGE_QUEUE_LIMIT_REACHED=3]="MESSAGE_QUEUE_LIMIT_REACHED",e[e.CLOSED_BY_CLIENT=4]="CLOSED_BY_CLIENT",e[e.MESSAGE_TOO_LARGE=5]="MESSAGE_TOO_LARGE",e[e.INTERNAL_ERROR=6]="INTERNAL_ERROR",e[e.INVALID_INBOUND_MESSAGE=7]="INVALID_INBOUND_MESSAGE",e[e.ABORT=8]="ABORT",e[e.LOST_MESSAGES=9]="LOST_MESSAGES",e[e.SERVER_CLOSING=10]="SERVER_CLOSING",e[e.CLOSED_BY_CONTROLLER=11]="CLOSED_BY_CONTROLLER"}(bg.SessionCloseReason||(bg.SessionCloseReason={}));var Cg={};Object.defineProperty(Cg,"__esModule",{value:!0});var Pg=function(){return function(e,t,r,n,o,i){this.sessionId=e,this.type=t,this.updateType=r,this.oldProperties=n,this.newProperties=o,this.closeReason=i}}();Cg.SessionPropertiesEvent=Pg;var Ag={};Object.defineProperty(Ag,"__esModule",{value:!0}),function(e){e[e.OPEN=0]="OPEN",e[e.UPDATE=1]="UPDATE",e[e.CLOSE=2]="CLOSE"}(Ag.SessionPropertiesEventType||(Ag.SessionPropertiesEventType={}));var Ng,Mg={},Lg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Mg,"__esModule",{value:!0}),function(e){e[e.NEW=1]="NEW",e[e.CHANGE=2]="CHANGE",e[e.REMOVE=3]="REMOVE",e[e.SAME=4]="SAME"}(Ng||(Ng={}));var Dg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Lg(t,e),t.prototype.read=function(e){var t=pw.SessionIdSerialiser.read(e),r=bE.read(e,Ag.SessionPropertiesEventType);switch(r){case Ag.SessionPropertiesEventType.OPEN:var n=jy.readDictionary(e,jy.readString);return new Cg.SessionPropertiesEvent(t,r,void 0,n);case Ag.SessionPropertiesEventType.UPDATE:return function(e,t){for(var r=jy.readByte(e),n={},o={},i=jy.readInt32(e),s=0;s<i;++s){var a=jy.readString(e);switch(bE.read(e,Ng)){case Ng.NEW:n[a]=null,o[a]=jy.readString(e);break;case Ng.CHANGE:n[a]=jy.readString(e),o[a]=jy.readString(e);break;case Ng.REMOVE:n[a]=jy.readString(e);break;case Ng.SAME:o[a]=jy.readString(e);break;default:throw new Error("Invalid update entry type: type")}}return new Cg.SessionPropertiesEvent(t,Ag.SessionPropertiesEventType.UPDATE,r,n,o)}(e,t);case Ag.SessionPropertiesEventType.CLOSE:var o=bE.read(e,bg.SessionCloseReason),i=jy.readDictionary(e,jy.readString);return new Cg.SessionPropertiesEvent(t,r,void 0,i,void 0,o);default:throw new Error("Unknown session properties event type: "+r)}},t}(By.AbstractSerialiser);Mg.SessionPropertiesEventSerialiser=new Dg;var jg={};Object.defineProperty(jg,"__esModule",{value:!0});var Ug=function(){return function(e,t){this.cid=e,this.events=t}}();jg.SessionPropertiesEventBatch=Ug;var xg={},Bg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(xg,"__esModule",{value:!0});var kg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Bg(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e),r=jy.readCollection(e,Mg.SessionPropertiesEventSerialiser.read);return new jg.SessionPropertiesEventBatch(t,r)},t}(By.AbstractSerialiser);xg.SessionPropertiesEventBatchSerialiser=new kg;var qg={},Vg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(qg,"__esModule",{value:!0});var Fg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Vg(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.filter),jy.writeBoolean(e,t.conflate)},t}(By.AbstractSerialiser);qg.SetClientConflationFilterRequestSerialiser=new Fg;var Gg={},Hg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Gg,"__esModule",{value:!0});var Wg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Hg(t,e),t.prototype.write=function(e,t){pw.SessionIdSerialiser.write(e,t.sessionID),jy.writeBoolean(e,t.conflate)},t}(By.AbstractSerialiser);Gg.SetClientConflationRequestSerialiser=new Wg;var Yg={},zg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Yg,"__esModule",{value:!0});var Jg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zg(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.filter),0===Object.keys(t.overwriteProperties).length?jy.writeByte(e,0):(jy.writeByte(e,1),jy.writeDictionary(e,t.overwriteProperties,jy.writeString)),0===Object.keys(t.removeProperties).length?jy.writeByte(e,0):(jy.writeByte(e,1),jy.writeCollection(e,t.removeProperties,jy.writeString))},t}(By.AbstractSerialiser);Yg.SetSessionPropertiesFilterRequestSerialiser=new Jg;var $g={},Kg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($g,"__esModule",{value:!0});var Qg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Kg(t,e),t.prototype.write=function(e,t){t.properties?(jy.writeInt32(e,0),jy.writeCollection(e,t.properties,jy.writeString)):jy.writeInt32(e,1),Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser);$g.SetSessionPropertiesListenerSerialiser=new Qg;var Xg={},Zg=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Xg,"__esModule",{value:!0});var eO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zg(t,e),t.prototype.write=function(e,t){if(void 0===t.sessionID||null===t.sessionID)throw new Error("Session ID is null or undefined");pw.SessionIdSerialiser.write(e,t.sessionID),0===Object.keys(t.overwriteProperties).length?jy.writeByte(e,0):(jy.writeByte(e,1),jy.writeDictionary(e,t.overwriteProperties,jy.writeString)),0===Object.keys(t.removeProperties).length?jy.writeByte(e,0):(jy.writeByte(e,1),jy.writeCollection(e,t.removeProperties,jy.writeString))},t}(By.AbstractSerialiser);Xg.SetSessionPropertiesRequestSerialiser=new eO;var tO={},rO=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(tO,"__esModule",{value:!0});var nO=function(){return function(e,t){var r,n,o,i;this.properties={};try{for(var s=rO(Object.getOwnPropertyNames(e)),a=s.next();!a.done;a=s.next()){var u=a.value;this.properties[u]=e[u]}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}try{for(var c=rO(t),p=c.next();!p.done;p=c.next()){var f=p.value;this.properties[f]=null}}catch(e){o={error:e}}finally{try{p&&!p.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}}}();tO.SetSessionPropertiesResult=nO;var oO={},iO=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(oO,"__esModule",{value:!0});var sO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return iO(t,e),t.prototype.read=function(e){var t,r;return t=0===jy.readByte(e)?{}:jy.readDictionary(e,jy.readString),r=0===jy.readByte(e)?[]:jy.readCollection(e,jy.readString),new tO.SetSessionPropertiesResult(t,r)},t}(By.AbstractSerialiser);oO.SetSessionPropertiesResultSerialiser=new sO;var aO={},uO=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(aO,"__esModule",{value:!0});var cO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return uO(t,e),t.prototype.write=function(e,t){jy.writeInt32(e,t.definition.id),Bw.ControlGroupSerialiser.write(e,t.group),jy.writeString(e,t.path)},t}(By.AbstractSerialiser);aO.TopicControlRegistrationParamsSerialiser=new cO;var pO={},fO=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(pO,"__esModule",{value:!0});var lO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fO(t,e),t.prototype.write=function(e,t){aO.TopicControlRegistrationParamsSerialiser.write(e,t.params),Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser);pO.TopicControlRegistrationRequestSerialiser=new lO;var hO={};Object.defineProperty(hO,"__esModule",{value:!0});var dO=function(){return function(e,t){this.count=S_.requireNonNull(e,"count"),this.errors=S_.requireNonNull(t,"errors")}}();hO.CountOrParserErrors=dO;var yO={},vO=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(yO,"__esModule",{value:!0});var _O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vO(t,e),t.prototype.read=function(e){var t=jy.readInt32(e),r=jy.readCollection(e,ew.ErrorReportSerialiser.read);return new hO.CountOrParserErrors(t,r)},t.prototype.write=function(e,t){jy.writeInt32(e,t.count),jy.writeCollection(e,t.errors,ew.ErrorReportSerialiser.write)},t}(By.AbstractSerialiser);yO.CountOrParserErrorsSerialiser=new _O;var SO={};Object.defineProperty(SO,"__esModule",{value:!0});var EO=function(){function e(e){this.errors=S_.requireNonNull(e,"errors")}return e.prototype.toString=function(){return"ErrorReportList ["+this.errors+"]"},e}();SO.ErrorReportList=EO;var mO={},wO=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(mO,"__esModule",{value:!0});var gO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wO(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,ew.ErrorReportSerialiser.read);return new SO.ErrorReportList(t)},t.prototype.write=function(e,t){jy.writeCollection(e,t.errors,ew.ErrorReportSerialiser.write)},t}(By.AbstractSerialiser);mO.ErrorReportListSerialiser=new gO;var OO={};Object.defineProperty(OO,"__esModule",{value:!0});var TO=function(){return function(e){this.names=e}}();OO.JMXObjectNames=TO;var IO={},RO=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(IO,"__esModule",{value:!0});var bO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return RO(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,jy.readString);return new OO.JMXObjectNames(t)},t.prototype.write=function(e,t){jy.writeCollection(e,t.names,jy.writeString)},t}(By.AbstractSerialiser);IO.JMXObjectNamesSerialiser=new bO;var CO={},PO=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(CO,"__esModule",{value:!0});var AO=new Av.Encoder,NO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return PO(t,e),t.prototype.read=function(e){var t=jy.readBytes(e);return new Pv.Decoder(t).nextValueExpecting(function(e){return e===Sv.types.MAP})},t.prototype.write=function(e,t){AO.encode(t),jy.writeBytes(e,AO.flush())},t}(By.AbstractSerialiser);CO.MBeanValuesSerialiser=new NO;var MO={};Object.defineProperty(MO,"__esModule",{value:!0});var LO=function(){return function(e,t,r,n){this.path=e,this.type=t,this.value=n,this.propertiesIndex=r}}();MO.FetchTopicResult=LO;var DO={};Object.defineProperty(DO,"__esModule",{value:!0});var jO=function(){return function(e,t,r){this.properties=e,this.results=t,this.hasMore=r}}();DO.FetchQueryResult=jO;var UO={},xO=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function BO(e){return jy.readDictionary(e,jy.readString)}function kO(e){var t=jy.readString(e),r=bE.read(e,nE.TopicTypeEnum),n=0!==jy.readByte(e)?jy.readBytes(e):void 0,o=jy.readInt32(e);return new MO.FetchTopicResult(t,r,o,n)}Object.defineProperty(UO,"__esModule",{value:!0});var qO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xO(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,BO),r=jy.readCollection(e,kO),n=jy.readBoolean(e);return new DO.FetchQueryResult(t,r,n)},t}(By.AbstractSerialiser);UO.FetchQueryResultSerialiser=new qO;var VO={};Object.defineProperty(VO,"__esModule",{value:!0}),VO.write=function(e,t){var r=oe.UZERO,n={write:function(e){if(e>=64)throw new Error("Cannot encode enum in long, "+e+" >= 64'");r=r.or(oe.ONE.shiftLeft(e))}};t.forEach(function(e){bE.write(n,e)}),jy.writeInt64(e,r)};var FO={},GO=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function HO(e,t){void 0===t?jy.writeByte(e,0):(jy.writeByte(e,1),jy.writeString(e,t.path),jy.writeBoolean(e,t.includesPath))}Object.defineProperty(FO,"__esModule",{value:!0});var WO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return GO(t,e),t.prototype.write=function(e,t){sm.TopicSelectorSerialiser.write(e,t.selector),function(e,t){HO(e,t.from),HO(e,t.to)}(e,t.range),VO.write(e,t.topicTypes),jy.writeBoolean(e,t.withValues),jy.writeBoolean(e,t.withProperties),jy.writeInt32(e,t.limit),jy.writeInt32(e,t.maximumResultSize),jy.writeInt32(e,t.deepBranchDepth),jy.writeInt32(e,t.deepBranchLimit),jy.writeBoolean(e,t.withUnpublishedDelayedTopics)},t}(By.AbstractSerialiser);FO.FetchQuerySerialiser=new WO;var YO={};Object.defineProperty(YO,"__esModule",{value:!0});var zO=function(){return function(e,t){this.cid=e,this.selector=t}}();YO.FetchRequest=zO;var JO={},$O=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(JO,"__esModule",{value:!0});var KO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $O(t,e),t.prototype.read=function(e){var t=sm.TopicSelectorSerialiser.read(e),r=Uy.CIDSerialiser.read(e);return new YO.FetchRequest(r,t)},t.prototype.write=function(e,t){sm.TopicSelectorSerialiser.write(e,t.selector),Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser);JO.FetchRequestSerialiser=new KO;var QO={};Object.defineProperty(QO,"__esModule",{value:!0});var XO=function(){return function(e,t){this.firstEntry=e,this.entryCount=t}}();QO.EntriesFetchRequest=XO;var ZO={},eT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ZO,"__esModule",{value:!0});var tT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eT(t,e),t.prototype.read=function(e){var t=jy.readInt64(e),r=jy.readInt64(e);return new QO.EntriesFetchRequest(t,r)},t.prototype.write=function(e,t){jy.writeInt64(e,t.firstEntry),jy.writeInt64(e,t.entryCount)},t}(By.AbstractSerialiser);ZO.EntriesFetchRequestSerialiser=new tT;var rT={};Object.defineProperty(rT,"__esModule",{value:!0});var nT=function(){return function(e,t,r,n,o,i){this.firstEntry=e,this.entryCount=t,this.fileId=r,this.maxEntriesAvailable=n,this.firstLineNumber=o,this.entries=i}}();rT.EntriesFetchResponse=nT;var oT={},iT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(oT,"__esModule",{value:!0});var sT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return iT(t,e),t.prototype.read=function(e){var t=jy.readInt64(e),r=jy.readInt64(e),n=jy.readInt64(e),o=jy.readInt64(e),i=jy.readBytes(e),s=jy.readInt64(e);return new rT.EntriesFetchResponse(t,r,s,n,o,i)},t.prototype.write=function(e,t){jy.writeInt64(e,t.firstEntry),jy.writeInt64(e,t.entryCount),jy.writeInt64(e,t.maxEntriesAvailable),jy.writeInt64(e,t.firstLineNumber),jy.writeBytes(e,t.entries),jy.writeInt64(e,t.fileId)},t}(By.AbstractSerialiser);oT.EntriesFetchResponseSerialiser=new sT;var aT={};Object.defineProperty(aT,"__esModule",{value:!0});var uT=function(){return function(e){this.collectors=e}}();aT.SessionMetricCollectorList=uT;var cT={};Object.defineProperty(cT,"__esModule",{value:!0});var pT=function(){return function(e,t){this.name=e,this.exportToPrometheus=t,this.name=e,this.exportToPrometheus=t}}();cT.AbstractMetricCollector=pT;var fT={},lT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(fT,"__esModule",{value:!0});var hT=function(e){function t(t,r,n,o,i){var s=e.call(this,t,r)||this;return s.removeMetricsWithNoMatches=n,s.sessionFilter=o,s.groupByProperties=i,s}return lT(t,e),t}(cT.AbstractMetricCollector);fT.SessionMetricCollector=hT;var dT={},yT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(dT,"__esModule",{value:!0});var vT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yT(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=jy.readBoolean(e),n=jy.readBoolean(e),o=jy.readString(e),i=jy.readCollection(e,jy.readString);return new fT.SessionMetricCollector(t,r,n,o,i)},t.prototype.write=function(e,t){jy.writeString(e,t.name),jy.writeBoolean(e,t.exportToPrometheus),jy.writeBoolean(e,t.removeMetricsWithNoMatches),jy.writeString(e,t.sessionFilter),jy.writeCollection(e,t.groupByProperties,jy.writeString)},t}(By.AbstractSerialiser);dT.SessionMetricCollectorSerialiser=new vT;var _T={},ST=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(_T,"__esModule",{value:!0});var ET=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ST(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,dT.SessionMetricCollectorSerialiser.read);return new aT.SessionMetricCollectorList(t)},t.prototype.write=function(e,t){jy.writeCollection(e,t.collectors,dT.SessionMetricCollectorSerialiser.write)},t}(By.AbstractSerialiser);_T.SessionMetricCollectorListSerialiser=new ET;var mT={};Object.defineProperty(mT,"__esModule",{value:!0});var wT=function(){return function(e){this.collectors=e}}();mT.TopicMetricCollectorList=wT;var gT={},OT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gT,"__esModule",{value:!0});var TT=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return i.topicSelector=n,i.groupByTopicType=o,i}return OT(t,e),t}(cT.AbstractMetricCollector);gT.TopicMetricCollector=TT;var IT={},RT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(IT,"__esModule",{value:!0});var bT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return RT(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=jy.readBoolean(e),n=jy.readString(e),o=jy.readBoolean(e);return new gT.TopicMetricCollector(t,r,n,o)},t.prototype.write=function(e,t){jy.writeString(e,t.name),jy.writeBoolean(e,t.exportToPrometheus),jy.writeString(e,t.topicSelector),jy.writeBoolean(e,t.groupByTopicType)},t}(By.AbstractSerialiser);IT.TopicMetricCollectorSerialiser=new bT;var CT={},PT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(CT,"__esModule",{value:!0});var AT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return PT(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,IT.TopicMetricCollectorSerialiser.read);return new mT.TopicMetricCollectorList(t)},t.prototype.write=function(e,t){jy.writeCollection(e,t.collectors,IT.TopicMetricCollectorSerialiser.write)},t}(By.AbstractSerialiser);CT.TopicMetricCollectorListSerialiser=new AT;var NT={};Object.defineProperty(NT,"__esModule",{value:!0});var MT=function(){return function(e,t){this.metricNames=e,this.values=t}}();NT.MeasuredEntityClassMetrics=MT;var LT={},DT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function jT(e,t){return jy.readMap(e,function(e){return jy.readCollection(e,jy.readString)},t)}function UT(e,t,r){jy.writeMap(e,t,function(e,t){return jy.writeCollection(e,t,jy.writeString)},r)}Object.defineProperty(LT,"__esModule",{value:!0});var xT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return DT(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,jy.readString),r=jT(e,function(e){return jT(e,function(e){return jy.readCollection(e,jy.readInt64)})});return new NT.MeasuredEntityClassMetrics(t,r)},t.prototype.write=function(e,t){jy.writeCollection(e,t.metricNames,jy.writeString),UT(e,t.values,function(e,t){return UT(e,t,function(e,t){return jy.writeCollection(e,t,jy.writeInt64)})})},t}(By.AbstractSerialiser);LT.MeasuredEntityClassMetricsSerialiser=new xT;var BT={},kT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(BT,"__esModule",{value:!0});var qT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return kT(t,e),t.prototype.read=function(e){return jy.readDictionary(e,function(e){return jy.readDictionary(e,jy.readInt64)})},t.prototype.write=function(e,t){jy.writeDictionary(e,t,function(e,t){return jy.writeDictionary(e,t,jy.writeInt64)})},t}(By.AbstractSerialiser);BT.ServerMetricsSerialiser=new qT;var VT={};Object.defineProperty(VT,"__esModule",{value:!0});var FT=function(){return function(e,t,r){this.sessionID=e,this.selector=t,this.cid=r}}();VT.MissingTopicRequest=FT;var GT={},HT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(GT,"__esModule",{value:!0});var WT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return HT(t,e),t.prototype.read=function(e){var t=pw.SessionIdSerialiser.read(e),r=sm.TopicSelectorSerialiser.read(e),n=Uy.CIDSerialiser.read(e);return new VT.MissingTopicRequest(t,r,n)},t.prototype.write=function(e,t){pw.SessionIdSerialiser.write(e,t.sessionID),sm.TopicSelectorSerialiser.write(e,t.selector),Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser);GT.MissingTopicRequestSerialiser=new WT;var YT={};Object.defineProperty(YT,"__esModule",{value:!0});var zT=function(){return function(e){this.status=e}}();YT.CheckRemoteServerResult=zT;var JT={};Object.defineProperty(JT,"__esModule",{value:!0}),function(e){e[e.CONNECTION_TIMEOUT=1]="CONNECTION_TIMEOUT",e[e.INPUT_BUFFER_SIZE=2]="INPUT_BUFFER_SIZE",e[e.MAXIMUM_QUEUE_SIZE=3]="MAXIMUM_QUEUE_SIZE",e[e.OUTPUT_BUFFER_SIZE=4]="OUTPUT_BUFFER_SIZE",e[e.RECONNECTION_TIMEOUT=5]="RECONNECTION_TIMEOUT",e[e.RECOVERY_BUFFER_SIZE=6]="RECOVERY_BUFFER_SIZE",e[e.RETRY_DELAY=7]="RETRY_DELAY",e[e.WRITE_TIMEOUT=8]="WRITE_TIMEOUT"}(JT.ConnectionOption||(JT.ConnectionOption={})),function(e){e[e.INACTIVE=1]="INACTIVE",e[e.CONNECTED=2]="CONNECTED",e[e.RETRYING=3]="RETRYING",e[e.FAILED=4]="FAILED",e[e.MISSING=5]="MISSING"}(JT.ConnectionState||(JT.ConnectionState={}));var $T={};Object.defineProperty($T,"__esModule",{value:!0}),$T.readRemoteServerStatus=function(e){return{connectionState:bE.read(e,JT.ConnectionState),failureMessage:jy.readString(e)}};var KT={},QT=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(KT,"__esModule",{value:!0});var XT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return QT(t,e),t.prototype.read=function(e){var t=$T.readRemoteServerStatus(e);return new YT.CheckRemoteServerResult(t)},t}(By.AbstractSerialiser);KT.CheckRemoteServerResultSerialiser=new XT;var ZT={};Object.defineProperty(ZT,"__esModule",{value:!0}),ZT.readRemoteServer=function(e){return{name:jy.readString(e),url:jy.readString(e),principal:jy.readString(e),connectionOptions:jy.readObject(e,function(e){return bE.read(e,JT.ConnectionOption)},jy.readString)}};var eI={};Object.defineProperty(eI,"__esModule",{value:!0});var tI=function(){return function(e,t){this.server=e,this.errors=t}}();eI.CreateRemoteServerResult=tI;var rI={},nI=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(rI,"__esModule",{value:!0});var oI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nI(t,e),t.prototype.read=function(e){if(0===e.peek()){jy.readByte(e);var t=ZT.readRemoteServer(e);return new eI.CreateRemoteServerResult(t)}var r=mO.ErrorReportListSerialiser.read(e);return new eI.CreateRemoteServerResult(void 0,r)},t}(By.AbstractSerialiser);rI.CreateRemoteServerResultSerialiser=new oI;var iI={};Object.defineProperty(iI,"__esModule",{value:!0});var sI=function(){return function(e){this.result=e}}();iI.ListRemoteServersResult=sI;var aI={},uI=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(aI,"__esModule",{value:!0});var cI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return uI(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,ZT.readRemoteServer);return new iI.ListRemoteServersResult(t)},t}(By.AbstractSerialiser);aI.ListRemoteServersResultSerialiser=new cI;var pI={},fI=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(pI,"__esModule",{value:!0});var lI=function(e,t){return jy.writeByte(e,parseInt(t,10))},hI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fI(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.name),jy.writeString(e,t.url),jy.writeString(e,t.principal),jy.writeObject(e,t.connectionOptions,lI,jy.writeString),Gm.write(e,t.credentials)},t}(By.AbstractSerialiser);pI.RemoteServerDefinitionSerialiser=new hI;var dI={},yI=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(dI,"__esModule",{value:!0});var vI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yI(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.selector.expression)},t}(By.AbstractSerialiser);dI.RemoveTopicSerialiser=new vI;var _I={};Object.defineProperty(_I,"__esModule",{value:!0});var SI=function(){return function(e,t){this.type=e,this.resString=t}}();_I.ReplaceLicenceResponse=SI;var EI={},mI=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(EI,"__esModule",{value:!0});var wI=function(e){function t(){var t=e.call(this)||this;return t.responseCode=[],t.responseCode[0]="The license was replaced successfully.",t.responseCode[1]="The provided license does not match this version of Diffusion.",t.responseCode[2]="Diffusion was unable to find the IP address provided within the license.",t.responseCode[3]="The provided license has expired.",t.responseCode[4]="The date on the provided license is not valid.",t.responseCode[5]="The license file is missing.Please check the read / write permissions of your Diffusion server.",t.responseCode[6]="The licencing service has encountered an unknown error.",t.responseCode[7]="The provided license is not valid for the given IP address(es).",t.responseCode[8]="The provided license is not valid for the given MAC address(es).",t.responseCode[9]="The license file provided cannot be read, and may be corrupt.",t.responseCode[10]="The new license has an non-matching feature set to the current license.\nPlease shut down the server and replace the license manually.",t}return mI(t,e),t.prototype.read=function(e){var t=jy.readByte(e),r=t in this.responseCode?this.responseCode[t]:"An unknown response was received from the server.";return new _I.ReplaceLicenceResponse(t,r)},t}(By.AbstractSerialiser);EI.ReplaceLicenceResponseSerialiser=new wI;var gI={};Object.defineProperty(gI,"__esModule",{value:!0});var OI=function(){return function(e,t){this.definition=e,this.group=t}}();gI.ControlRegistrationParams=OI;var TI={},II=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(TI,"__esModule",{value:!0});var RI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return II(t,e),t.prototype.read=function(e){var t=jy.readInt32(e),r=Bw.ControlGroupSerialiser.read(e);return new gI.ControlRegistrationParams({id:t},r)},t.prototype.write=function(e,t){jy.writeInt32(e,t.definition.id),Bw.ControlGroupSerialiser.write(e,t.group)},t}(By.AbstractSerialiser);TI.ControlRegistrationParamsSerialiser=new RI;var bI={};Object.defineProperty(bI,"__esModule",{value:!0}),function(e){e[e.SUMMARY=0]="SUMMARY",e[e.LOCATION=1]="LOCATION",e[e.CONNECTOR_NAME=2]="CONNECTOR_NAME",e[e.SERVER_NAME=3]="SERVER_NAME"}(bI.DetailType||(bI.DetailType={}));var CI={},PI=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(CI,"__esModule",{value:!0});var AI=function(e){function t(t,r,n){var o=e.call(this,t.definition,t.group)||this;return o.name=r,o.details=n,o}return PI(t,e),t}(gI.ControlRegistrationParams);CI.AuthenticationControlRegistrationParameters=AI;var NI={},MI=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),LI=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(NI,"__esModule",{value:!0});var DI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return MI(t,e),t.prototype.read=function(e){var t=TI.ControlRegistrationParamsSerialiser.read(e),r=jy.readString(e),n=jy.readCollection(e,function(){return bE.read(e,bI.DetailType)});return new CI.AuthenticationControlRegistrationParameters(t,r,n)},t.prototype.write=function(e,t){var r,n;TI.ControlRegistrationParamsSerialiser.write(e,t),jy.writeString(e,t.name),jy.writeByte(e,t.details.length);try{for(var o=LI(t.details),i=o.next();!i.done;i=o.next()){var s=i.value;jy.writeByte(e,s)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},t}(By.AbstractSerialiser);NI.AuthenticationControlRegistrationParametersSerialiser=new DI;var jI={};Object.defineProperty(jI,"__esModule",{value:!0});var UI=function(){return function(e,t){this.params=e,this.cid=t}}();jI.AuthenticationControlRegistrationRequest=UI;var xI={},BI=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(xI,"__esModule",{value:!0});var kI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return BI(t,e),t.prototype.read=function(e){var t=NI.AuthenticationControlRegistrationParametersSerialiser.read(e),r=Uy.CIDSerialiser.read(e);return new jI.AuthenticationControlRegistrationRequest(t,r)},t.prototype.write=function(e,t){NI.AuthenticationControlRegistrationParametersSerialiser.write(e,t.params),Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser);xI.AuthenticationControlRegistrationRequestSerialiser=new kI;var qI={};Object.defineProperty(qI,"__esModule",{value:!0}),function(e){e[e.GLOBAL=1]="GLOBAL",e[e.LOCAL=2]="LOCAL",e[e.LOOPBACK=3]="LOOPBACK",e[e.UNKNOWN=4]="UNKNOWN"}(qI.AddressType||(qI.AddressType={}));var VI={};Object.defineProperty(VI,"__esModule",{value:!0}),VI.read=function(e){var t=jy.readString(e),r=jy.readString(e)||t,n=jy.readString(e)||r;return{type:bE.read(e,qI.AddressType),address:t,hostname:r,resolved:n,details:{country:jy.readString(e),language:jy.readString(e)},coordinates:{latitude:Nv.intBitsToFloat(jy.readInt32(e)),longitude:Nv.intBitsToFloat(jy.readInt32(e))}}};var FI={};Object.defineProperty(FI,"__esModule",{value:!0}),function(e){e[e.JAVASCRIPT_BROWSER=0]="JAVASCRIPT_BROWSER",e[e.ANDROID=3]="ANDROID",e[e.IOS=4]="IOS",e[e.JAVA=8]="JAVA",e[e.DOTNET=9]="DOTNET",e[e.C=10]="C",e[e.OTHER=12]="OTHER"}(FI.ClientType||(FI.ClientType={})),function(e){e[e.WEBSOCKET=0]="WEBSOCKET",e[e.HTTP_LONG_POLL=1]="HTTP_LONG_POLL",e[e.IFRAME_LONG_POLL=2]="IFRAME_LONG_POLL",e[e.IFRAME_STREAMING=3]="IFRAME_STREAMING",e[e.DPT=4]="DPT",e[e.HTTPC=5]="HTTPC",e[e.HTTPC_DUPLEX=6]="HTTPC_DUPLEX",e[e.OTHER=7]="OTHER"}(FI.TransportType||(FI.TransportType={}));var GI={};Object.defineProperty(GI,"__esModule",{value:!0}),GI.read=function(e){return{principal:jy.readString(e),clientType:bE.read(e,FI.ClientType),transportType:bE.read(e,FI.TransportType)}};var HI={};function WI(e){var t=jy.readByte(e);switch(t){case 0:return!1;case 1:return!0;default:throw new Error("Invalid option byte: "+t)}}Object.defineProperty(HI,"__esModule",{value:!0}),HI.read=function(e){var t={available:[]};return WI(e)?(WI(e)&&(t.available.push(bI.DetailType.SUMMARY),t.summary=GI.read(e)),WI(e)&&(t.available.push(bI.DetailType.LOCATION),t.location=VI.read(e)),WI(e)&&(t.available.push(bI.DetailType.CONNECTOR_NAME),t.connector=jy.readString(e)),WI(e)&&(t.available.push(bI.DetailType.SERVER_NAME),t.server=jy.readString(e)),t):t};var YI={};Object.defineProperty(YI,"__esModule",{value:!0});var zI=function(){return function(e,t,r,n){this.principal=e,this.credentials=t,this.details=r,this.cid=n}}();YI.AuthenticationRequest=zI;var JI={},$I=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(JI,"__esModule",{value:!0});var KI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $I(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=Gm.read(e),n=HI.read(e),o=Uy.CIDSerialiser.read(e);return new YI.AuthenticationRequest(t,r,n,o)},t}(By.AbstractSerialiser);JI.AuthenticationRequestSerialiser=new KI;var QI,XI={};Object.defineProperty(XI,"__esModule",{value:!0}),function(e){e[e.DENY=0]="DENY",e[e.ABSTAIN=1]="ABSTAIN",e[e.ALLOW=2]="ALLOW",e[e.ALLOW_WITH_RESULT=3]="ALLOW_WITH_RESULT"}(QI=XI.TypeCode||(XI.TypeCode={}));var ZI=function(){return function(e,t){this.type=e,this.result=t}}();XI.allow=function(e){return new ZI(QI.ALLOW_WITH_RESULT,function(e){return{roles:e.roles||[],properties:e.properties||{}}}(e))},XI.DENY=Object.freeze(new ZI(QI.DENY)),XI.ALLOW=Object.freeze(new ZI(QI.ALLOW)),XI.ABSTAIN=Object.freeze(new ZI(QI.ABSTAIN));var eR={},tR=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(eR,"__esModule",{value:!0});var rR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tR(t,e),t.prototype.read=function(e){switch(bE.read(e,XI.TypeCode)){case XI.TypeCode.ABSTAIN:return XI.ABSTAIN;case XI.TypeCode.ALLOW:return XI.ALLOW;case XI.TypeCode.ALLOW_WITH_RESULT:return XI.allow({roles:jy.readCollection(e,jy.readString),properties:jy.readDictionary(e,jy.readString)});default:return XI.DENY}},t.prototype.write=function(e,t){if(bE.write(e,t.type),t.type===XI.TypeCode.ALLOW_WITH_RESULT){var r=t.result;jy.writeCollection(e,r.roles,jy.writeString),jy.writeDictionary(e,r.properties,jy.writeString)}},t}(By.AbstractSerialiser);eR.AuthenticationResponseSerialiser=new rR;var nR={},oR=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(nR,"__esModule",{value:!0});var iR=function(e){function t(t,r,n){var o=e.call(this,r,n)||this;return o.name=t,o}return oR(t,e),t}(gI.ControlRegistrationParams);nR.AuthenticatorRegistrationParameters=iR;var sR={},aR=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(sR,"__esModule",{value:!0});var uR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aR(t,e),t.prototype.read=function(e){var t=TI.ControlRegistrationParamsSerialiser.read(e),r=jy.readString(e);return new nR.AuthenticatorRegistrationParameters(r,t.definition,t.group)},t.prototype.write=function(e,t){TI.ControlRegistrationParamsSerialiser.write(e,t),jy.writeString(e,t.name)},t}(By.AbstractSerialiser);sR.AuthenticatorRegistrationParametersSerialiser=new uR;var cR={};Object.defineProperty(cR,"__esModule",{value:!0});var pR=function(){return function(e,t){this.params=e,this.cid=t}}();cR.AuthenticatorRegistrationRequest=pR;var fR={},lR=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(fR,"__esModule",{value:!0});var hR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lR(t,e),t.prototype.read=function(e){var t=sR.AuthenticatorRegistrationParametersSerialiser.read(e),r=Uy.CIDSerialiser.read(e);return new cR.AuthenticatorRegistrationRequest(t,r)},t.prototype.write=function(e,t){sR.AuthenticatorRegistrationParametersSerialiser.write(e,t.params),Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser);fR.AuthenticatorRegistrationRequestSerialiser=new hR;var dR={};Object.defineProperty(dR,"__esModule",{value:!0});var yR=function(){return function(e,t,r,n,o){this.principal=e,this.credentials=t,this.sessionProperties=r,this.proposedProperties=n,this.cid=o}}();dR.AuthenticatorRequest=yR;var vR={},_R=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vR,"__esModule",{value:!0});var SR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _R(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=Gm.read(e),n=jy.readDictionary(e,jy.readString),o=jy.readDictionary(e,jy.readString),i=Uy.CIDSerialiser.read(e);return new dR.AuthenticatorRequest(t,r,n,o,i)},t}(By.AbstractSerialiser);vR.AuthenticatorRequestSerialiser=new SR;var ER,mR={};Object.defineProperty(mR,"__esModule",{value:!0}),function(e){e[e.DENY=0]="DENY",e[e.ABSTAIN=1]="ABSTAIN",e[e.ALLOW=2]="ALLOW"}(ER=mR.TypeCode||(mR.TypeCode={}));var wR=function(){return function(e,t){this.type=e,this.properties=t}}();mR.AuthenticatorResponse=wR,mR.DENY=Object.freeze(new wR(ER.DENY)),mR.ABSTAIN=Object.freeze(new wR(ER.ABSTAIN));var gR={},OR=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gR,"__esModule",{value:!0});var TR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return OR(t,e),t.prototype.read=function(e){switch(bE.read(e,mR.TypeCode)){case mR.TypeCode.ABSTAIN:return mR.ABSTAIN;case mR.TypeCode.ALLOW:var t=jy.readDictionary(e,jy.readString);return new mR.AuthenticatorResponse(mR.TypeCode.ALLOW,t);default:return mR.DENY}},t.prototype.write=function(e,t){bE.write(e,t.type),t.type===mR.TypeCode.ALLOW&&jy.writeDictionary(e,t.properties||{},jy.writeString)},t}(By.AbstractSerialiser);gR.AuthenticatorResponseSerialiser=new TR;var IR={};Object.defineProperty(IR,"__esModule",{value:!0}),function(e){e[e.AUTHENTICATE=0]="AUTHENTICATE",e[e.VIEW_SESSION=1]="VIEW_SESSION",e[e.MODIFY_SESSION=2]="MODIFY_SESSION",e[e.REGISTER_HANDLER=3]="REGISTER_HANDLER",e[e.VIEW_SERVER=4]="VIEW_SERVER",e[e.CONTROL_SERVER=5]="CONTROL_SERVER",e[e.VIEW_SECURITY=6]="VIEW_SECURITY",e[e.MODIFY_SECURITY=7]="MODIFY_SECURITY",e[e.UNKNOWN_GLOBAL_PERMISSION=8]="UNKNOWN_GLOBAL_PERMISSION",e[e.READ_TOPIC_VIEWS=9]="READ_TOPIC_VIEWS",e[e.MODIFY_TOPIC_VIEWS=10]="MODIFY_TOPIC_VIEWS"}(IR.GlobalPermissionCode||(IR.GlobalPermissionCode={})),function(e){e[e.READ_TOPIC=0]="READ_TOPIC",e[e.UPDATE_TOPIC=1]="UPDATE_TOPIC",e[e.MODIFY_TOPIC=2]="MODIFY_TOPIC",e[e.SEND_TO_MESSAGE_HANDLER=3]="SEND_TO_MESSAGE_HANDLER",e[e.SEND_TO_SESSION=4]="SEND_TO_SESSION",e[e.SELECT_TOPIC=5]="SELECT_TOPIC",e[e.QUERY_OBSOLETE_TIME_SERIES_EVENTS=6]="QUERY_OBSOLETE_TIME_SERIES_EVENTS",e[e.EDIT_TIME_SERIES_EVENTS=7]="EDIT_TIME_SERIES_EVENTS",e[e.EDIT_OWN_TIME_SERIES_EVENTS=8]="EDIT_OWN_TIME_SERIES_EVENTS",e[e.ACQUIRE_LOCK=9]="ACQUIRE_LOCK",e[e.UNKNOWN_TOPIC_PERMISSION=10]="UNKNOWN_TOPIC_PERMISSION",e[e.UNKNOWN_PATH_PERMISSION=10]="UNKNOWN_PATH_PERMISSION"}(IR.PathPermissionCode||(IR.PathPermissionCode={}));var RR={};Object.defineProperty(RR,"__esModule",{value:!0});var bR=function(){return function(e){this.permissions=e}}();RR.ListGlobalPermissionsResult=bR;var CR={},PR=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(CR,"__esModule",{value:!0});var AR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return PR(t,e),t.prototype.read=function(e){return new RR.ListGlobalPermissionsResult(jy.readCollection(e,function(){var t=IR.GlobalPermissionCode[e.read()];return Tm.GlobalPermission[t]}))},t}(By.AbstractSerialiser);CR.ListGlobalPermissionsResultSerialiser=new AR;var NR={};Object.defineProperty(NR,"__esModule",{value:!0});var MR=function(){return function(e){this.permissions=e}}();NR.ListPathPermissionsResult=MR;var LR={},DR=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(LR,"__esModule",{value:!0});var jR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return DR(t,e),t.prototype.read=function(e){return new NR.ListPathPermissionsResult(jy.readCollection(e,function(){var t=IR.PathPermissionCode[e.read()];return Tm.PathPermission[t]}))},t}(By.AbstractSerialiser);LR.ListPathPermissionsResultSerialiser=new jR;var UR={};Object.defineProperty(UR,"__esModule",{value:!0});var xR=function(){function e(e,t,r,n){this.anonymous=e,this.named=t,this.roles=r,this.isolatedPaths=n}return e.prototype.toString=function(){return"SecurityConfiguration [anonymous=${this.anonymous}, named=${this.named}, roles=${this.roles}, isolatedPaths=${this.isolatedPaths}]"},e}();UR.SecurityConfigurationImpl=xR;var BR={};Object.defineProperty(BR,"__esModule",{value:!0});var kR=function(){return function(e,t,r,n,o,i){this.name=e,this.global=t,this.default=r,this.topic=n,this.roles=o,this.lockingPrincipal=i}}();BR.RoleImpl=kR;var qR={};Object.defineProperty(qR,"__esModule",{value:!0}),qR.read=function(e){var t=jy.readString(e),r=jy.readCollection(e,function(){return bE.read(e,IR.GlobalPermissionCode)}).map(function(e){return IR.GlobalPermissionCode[e]}),n=jy.readCollection(e,function(){return bE.read(e,IR.PathPermissionCode)}).map(function(e){return IR.PathPermissionCode[e]}),o=jy.readDictionary(e,function(){return jy.readCollection(e,function(){return bE.read(e,IR.PathPermissionCode)}).map(function(e){return IR.PathPermissionCode[e]})}),i=jy.readCollection(e,jy.readString),s=jy.readBoolean(e)?jy.readString(e):void 0;return new BR.RoleImpl(t,r,n,o,i,s)};var VR={},FR=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(VR,"__esModule",{value:!0});var GR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return FR(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,jy.readString),r=jy.readCollection(e,jy.readString),n=jy.readCollection(e,qR.read),o=jy.readCollection(e,jy.readString);return new UR.SecurityConfigurationImpl(t,r,n,o)},t}(By.AbstractSerialiser);VR.SecurityConfigurationSerialiser=new GR;var HR,WR={};Object.defineProperty(WR,"__esModule",{value:!0}),function(e){e[e.UNLOCK_ON_SESSION_LOSS=0]="UNLOCK_ON_SESSION_LOSS",e[e.UNLOCK_ON_CONNECTION_LOSS=1]="UNLOCK_ON_CONNECTION_LOSS"}(HR=WR.SessionLockScope||(WR.SessionLockScope={})),WR.SessionLockOptions={SessionLockScope:HR};var YR={};Object.defineProperty(YR,"__esModule",{value:!0});var zR=function(){return function(e,t,r){this.lockName=e,this.sequence=t,this.scope=r}}();YR.SessionLockAcquisition=zR;var JR={},$R=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(JR,"__esModule",{value:!0});var KR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $R(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=jy.readInt64(e),n=bE.read(e,WR.SessionLockScope);return new YR.SessionLockAcquisition(t,r,n)},t.prototype.write=function(e,t){jy.writeString(e,t.lockName),jy.writeInt64(e,t.sequence),bE.write(e,t.scope)},t}(By.AbstractSerialiser);JR.SessionLockAcquisitionSerialiser=new KR;var QR={},XR=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(QR,"__esModule",{value:!0});var ZR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return XR(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.lockName),jy.writeInt64(e,t.requestId),bE.write(e,t.scope)},t}(By.AbstractSerialiser);QR.SessionLockRequestSerialiser=new ZR;var eb={};function tb(e,t){if(null==e||e<0)throw new Error(t+" is negative: "+e);return e}Object.defineProperty(eb,"__esModule",{value:!0});var rb=function(){return function(e,t,r,n){this.id=e,this.anchorOperator=t,this.spanOperator=r,this.unitsSuffix=n}}();eb.Types={ABSOLUTE_START:new rb(0,"fromStart","toStart",""),ABSOLUTE_SEQUENCE:new rb(1,"from","to",""),ABSOLUTE_TIME:new rb(2,"from","to"," ms"),OFFSET_SEQUENCE:new rb(3,"fromLast","untilLast",""),OFFSET_TIME:new rb(4,"fromLast","untilLast"," ms"),NEXT_COUNT:new rb(5,null,"next",""),NEXT_TIME:new rb(6,null,"next"," ms"),PREVIOUS_COUNT:new rb(7,null,"previous",""),PREVIOUS_TIME:new rb(8,null,"previous"," ms")},sv.enumerize(eb.Types);var nb=function(){function e(e,t){this.value=e,this.type=t}return e.at=function(t){return t instanceof Date?new e(S_.requireNonNull(t,"Date").getTime(),eb.Types.ABSOLUTE_TIME):new e(tb(t,"Sequence"),eb.Types.ABSOLUTE_SEQUENCE)},e.atStart=function(){return ob},e.offset=function(t){return new e(tb(t,"Count"),eb.Types.OFFSET_SEQUENCE)},e.offsetMillis=function(t){return new e(tb(t,"Timespan"),eb.Types.OFFSET_TIME)},e.next=function(t){return new e(tb(t,"Count"),eb.Types.NEXT_COUNT)},e.nextMillis=function(t){return new e(tb(t,"Timespan"),eb.Types.NEXT_TIME)},e.previous=function(t){return new e(tb(t,"Count"),eb.Types.PREVIOUS_COUNT)},e.previousMillis=function(t){return new e(tb(t,"Timespan"),eb.Types.PREVIOUS_TIME)},e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.value===t.value&&this.type===t.type)},e}();eb.Point=nb;var ob=new nb(0,eb.Types.ABSOLUTE_START),ib={};Object.defineProperty(ib,"__esModule",{value:!0});var sb=function(){function e(e,t){this.anchor=e,this.span=t}return e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.anchor.equals(t.anchor)&&this.span.equals(t.span))},e.prototype.from=function(t){return new e(eb.Point.at(t),this.span)},e.prototype.fromStart=function(){return new e(eb.Point.atStart(),this.span)},e.prototype.fromLast=function(t){return new e(eb.Point.offset(t),this.span)},e.prototype.fromLastMillis=function(t){return new e(eb.Point.offsetMillis(t),this.span)},e.prototype.to=function(t){return new e(this.anchor,eb.Point.at(t))},e.prototype.toStart=function(){return new e(this.anchor,eb.Point.atStart())},e.prototype.untilLast=function(t){return new e(this.anchor,eb.Point.offset(t))},e.prototype.untilLastMillis=function(t){return new e(this.anchor,eb.Point.offsetMillis(t))},e.prototype.next=function(t){return new e(this.anchor,eb.Point.next(t))},e.prototype.nextMillis=function(t){return new e(this.anchor,eb.Point.nextMillis(t))},e.prototype.previous=function(t){return new e(this.anchor,eb.Point.previous(t))},e.prototype.previousMillis=function(t){return new e(this.anchor,eb.Point.previousMillis(t))},e}();ib.Range=sb,ib.DEFAULT_RANGE=new sb(eb.Point.atStart(),eb.Point.offset(0));var ab={};Object.defineProperty(ab,"__esModule",{value:!0});var ub=function(){function e(e,t){this.id=e,this.name=t}return e.prototype.toString=function(){return this.name},e}();ab.StreamStructures={VALUE_EVENT_STREAM:new ub(1,"VALUE_EVENT_STREAM"),EDIT_EVENT_STREAM:new ub(2,"EDIT_EVENT_STREAM")},sv.enumerize(ab.StreamStructures),Object.freeze(ab.StreamStructures);var cb=function(){return function(e,t){this.id=e,this.streamStructure=t}}();ab.QueryTypes={VALUES:new cb(0,ab.StreamStructures.VALUE_EVENT_STREAM),ALL_EDITS:new cb(1,ab.StreamStructures.EDIT_EVENT_STREAM),LATEST_EDITS:new cb(2,ab.StreamStructures.EDIT_EVENT_STREAM)},sv.enumerize(ab.QueryTypes),Object.freeze(ab.QueryTypes);var pb=function(){function e(e,t,r,n){this.queryType=e,this.viewRange=t,this.editRange=r,this.limit=n}return e.prototype.withViewRange=function(t){return new e(this.queryType,t,this.editRange,this.limit)},e.prototype.withEditRange=function(t){return new e(this.queryType,this.viewRange,t,this.limit)},e.prototype.withLimit=function(t){return new e(this.queryType,this.viewRange,this.editRange,function(e,t){if(e<0)throw new Error(t+'" is negative: '+e);return e}(t,"limit"))},e.prototype.withQueryType=function(t){return new e(t,this.viewRange,this.editRange,this.limit)},e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.queryType===t.queryType&&this.viewRange.equals(t.viewRange)&&this.editRange.equals(t.editRange)&&this.limit===t.limit)},e}();ab.RangeQueryParameters=pb,ab.DEFAULT_RANGE_QUERY=Object.freeze(new pb(ab.QueryTypes.VALUES,ib.DEFAULT_RANGE,ib.DEFAULT_RANGE,Nv.MAX_SAFE_INTEGER));var fb={};function lb(e){var t=jy.readInt64(e),r=bE.read(e,eb.Types);return new eb.Point(t,r)}function hb(e){var t=lb(e),r=lb(e);return new ib.Range(t,r)}function db(e,t){jy.writeInt64(e,t.value),bE.write(e,t.type)}function yb(e,t){db(e,t.anchor),db(e,t.span)}Object.defineProperty(fb,"__esModule",{value:!0}),fb.read=function(e){var t=bE.read(e,ab.QueryTypes),r=hb(e),n=hb(e),o=jy.readInt64(e);return new ab.RangeQueryParameters(t,r,n,o)},fb.write=function(e,t){bE.write(e,t.queryType),yb(e,t.viewRange),yb(e,t.editRange),jy.writeInt64(e,t.limit)};var vb={};Object.defineProperty(vb,"__esModule",{value:!0});var _b=function(){return function(e,t){this.topicPath=e,this.parameters=t}}();vb.RangeQueryRequest=_b;var Sb={},Eb=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Sb,"__esModule",{value:!0});var mb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Eb(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=fb.read(e);return new vb.RangeQueryRequest(t,r)},t.prototype.write=function(e,t){jy.writeString(e,t.topicPath),fb.write(e,t.parameters)},t}(By.AbstractSerialiser);Sb.RangeQueryRequestSerialiser=new mb;var wb={};function gb(e){return!!e}function Ob(e,t){return e.originalEvent.sequence!==t.originalEvent.sequence?e.originalEvent.sequence-t.originalEvent.sequence:e.sequence-t.sequence}Object.defineProperty(wb,"__esModule",{value:!0});var Tb=function(){function e(e,t,r,n){this.events=n,this.selectedCount=e.toNumber(),this.isComplete=e.equals(t),this.streamStructure=r}return e.prototype.merge=function(t){var r,n,o=this.events.concat(t.events).sort(Ob).map((r=this.events.concat(t.events),n={},r.forEach(function(e){var t=e.originalEvent.sequence.toString(10);(!n[t]||n[t].sequence.toNumber()<e.sequence.toNumber())&&(n[t]=e)}),function(e){var t=e.originalEvent.sequence.toString(10),r=n[t];return r?e.isEditEvent?e.sequence.equals(r.sequence)?(delete n[t],e):null:(delete n[t],r):null})).filter(gb),i=oe.fromNumber(o.length);return new e(i,i,ab.StreamStructures.VALUE_EVENT_STREAM,o)},e}();wb.QueryResultImpl=Tb;var Ib={};Object.defineProperty(Ib,"__esModule",{value:!0});var Rb=function(){function e(e,t,r){this.valueDataType=e,this.selectedCount=t,this.events=r}return e.prototype.createQueryResult=function(e,t){var r=this;if(!this.valueDataType.canReadAs(e))throw new Error("Time series topic has an incompatible event data type: "+this.valueDataType);return new wb.QueryResultImpl(this.selectedCount,oe.fromNumber(this.events.length),t,this.events.map(function(t){return t.withValue(r.valueDataType.readAs(e,t.value))}))},e}();Ib.RangeQueryResult=Rb;var bb={},Cb=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(bb,"__esModule",{value:!0});var Pb=function(){return function(e,t){this.sequence=e,this.timestamp=t}}();function Ab(e,t,r){var n=jy.readInt64(e).add(t.sequence),o=jy.readInt64(e).add(t.timestamp),i=jy.readBytes(e),s=r[i.toString()],a=s||i.toString("utf-8");return new YS.EventMetadataImpl(n.toNumber(),o.toNumber(),a)}function Nb(e,t,r){var n=Ab(e,t,r);return HS.EventImpl.create(n,n,jy.readBytes(e))}function Mb(e,t,r){var n=Ab(e,t,r),o=Ab(e,t,r);return HS.EventImpl.create(o,n,jy.readBytes(e))}function Lb(e,t){t[jy.readBytes(e).toString()]=jy.readString(e)}var Db=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cb(t,e),t.prototype.read=function(e){var t=iE.DataTypes.get(jy.readString(e));if(null===t)throw new Error("Received unexpected data type");for(var r,n=jy.readInt64(e),o=new Pb(oe.ZERO,oe.ZERO),i={},s=[],a=jy.readInt32(e),u=0;u<a;++u)switch(jy.readByte(e)){case 0:s.push(Nb(e,o,i));break;case 1:s.push(Mb(e,o,i));break;case 2:r=e,o=new Pb(jy.readInt64(r),jy.readInt64(r));break;case 3:Lb(e,i);break;default:Lb(e,i)}return new Ib.RangeQueryResult(t,n,s)},t}(By.AbstractSerialiser);bb.RangeQueryResultSerialiser=new Db;var jb={},Ub=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(jb,"__esModule",{value:!0});var xb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ub(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.path),jy.writeString(e,t.dataType.name()),jy.writeBytes(e,t.value)},t}(By.AbstractSerialiser);jb.TimeSeriesAppendRequestSerialiser=new xb;var Bb={},kb=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Bb,"__esModule",{value:!0});var qb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return kb(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.path),jy.writeString(e,t.dataType.name()),jy.writeInt64(e,t.sequence),jy.writeBytes(e,t.value)},t}(By.AbstractSerialiser);Bb.TimeSeriesEditRequestSerialiser=new qb;var Vb={},Fb=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Vb,"__esModule",{value:!0});var Gb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fb(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.path),NE.write(e,t.specification)},t}(By.AbstractSerialiser);Vb.TopicAddRequestSerialiser=new Gb;var Hb={};Object.defineProperty(Hb,"__esModule",{value:!0}),function(e){e[e.OK=0]="OK",e[e.EXISTS=1]="EXISTS"}(Hb.TopicAddResponseStatus||(Hb.TopicAddResponseStatus={}));var Wb=function(){return function(e){this.status=e}}();Hb.TopicAddResponse=Wb;var Yb={},zb=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Yb,"__esModule",{value:!0});var Jb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zb(t,e),t.prototype.read=function(e){var t=jy.readByte(e);return new Hb.TopicAddResponse(t)},t}(By.AbstractSerialiser);Yb.TopicAddResponseSerialiser=new Jb;var $b={},Kb=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($b,"__esModule",{value:!0});var Qb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Kb(t,e),t.prototype.write=function(e,t){Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser);$b.TopicNotificationDeregistrationRequestSerialiser=new Qb;var Xb={};Object.defineProperty(Xb,"__esModule",{value:!0}),function(e){e[e.ADDED=0]="ADDED",e[e.SELECTED=1]="SELECTED",e[e.REMOVED=2]="REMOVED",e[e.DESELECTED=3]="DESELECTED"}(Xb.TopicNotificationType||(Xb.TopicNotificationType={}));var Zb={};Object.defineProperty(Zb,"__esModule",{value:!0});var eC=function(){return function(e,t,r){this.cid=e,this.path=t,this.type=r,this.isDescendantEvent=!0}}();Zb.TopicNotificationDescendantEvent=eC;var tC={},rC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(tC,"__esModule",{value:!0});var nC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return rC(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e),r=jy.readString(e),n=bE.read(e,Xb.TopicNotificationType);return new Zb.TopicNotificationDescendantEvent(t,r,n)},t}(By.AbstractSerialiser);tC.TopicNotificationDescendantEventSerialiser=new nC;var oC={},iC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(oC,"__esModule",{value:!0});var sC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return iC(t,e),t.prototype.write=function(e,t){Uy.CIDSerialiser.write(e,t.cid),sm.TopicSelectorSerialiser.write(e,t.selector)},t}(By.AbstractSerialiser);oC.TopicNotificationDeselectionSerialiser=new sC;var aC={};Object.defineProperty(aC,"__esModule",{value:!0});var uC=function(){return function(e,t,r,n){this.cid=e,this.path=t,this.type=r,this.specification=n,this.isDescendantEvent=!1}}();aC.TopicNotificationEvent=uC;var cC={},pC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(cC,"__esModule",{value:!0});var fC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pC(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e),r=jy.readString(e),n=bE.read(e,Xb.TopicNotificationType),o=NE.read(e);return new aC.TopicNotificationEvent(t,r,n,o)},t}(By.AbstractSerialiser);cC.TopicNotificationEventSerialiser=new fC;var lC={},hC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(lC,"__esModule",{value:!0});var dC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return hC(t,e),t.prototype.write=function(e,t){Uy.CIDSerialiser.write(e,t.cid),sm.TopicSelectorSerialiser.write(e,t.selector)},t}(By.AbstractSerialiser);lC.TopicNotificationSelectionSerialiser=new dC;var yC={},vC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(yC,"__esModule",{value:!0}),function(e){e[e.UNCONSTRAINED=0]="UNCONSTRAINED",e[e.CONJUNCTION=1]="CONJUNCTION",e[e.BINARY_VALUE=2]="BINARY_VALUE",e[e.NO_VALUE=3]="NO_VALUE",e[e.LOCKED=4]="LOCKED",e[e.NO_TOPIC=5]="NO_TOPIC",e[e.PARTIAL_JSON=6]="PARTIAL_JSON"}(yC.ConstraintType||(yC.ConstraintType={}));var _C=function(){function e(){}return e.prototype.and=function(e){if(!Ty.Array.isArray(e)&&"CONJUNCTION"===e.getConstraintType())return e.and(this);var t=Ty.Array.isArray(e)?e.concat(this):[this,e];return IC(t),new EC(t)},e}(),SC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vC(t,e),t.prototype.getConstraintType=function(){return"UNCONSTRAINED"},t}(_C);yC.Unconstrained=SC;var EC=function(){function e(e){IC(e),this.constraints=e}return e.prototype.and=function(t){if(!Ty.Array.isArray(t)&&"CONJUNCTION"===t.getConstraintType())return t.and(this.constraints);var r=this.constraints.concat(t);return IC(r),new e(r)},e.prototype.getConstraints=function(){return this.constraints.slice()},e.prototype.getConstraintType=function(){return"CONJUNCTION"},e}(),mC=function(e){function t(t){var r=e.call(this)||this;return r.bytes=t,r}return vC(t,e),t.prototype.getBytes=function(){return this.bytes},t.prototype.getConstraintType=function(){return"BINARY_VALUE"},t}(_C);yC.BinaryValue=mC;var wC=function(e){function t(t){var r=e.call(this)||this;return r.lock=t,r.lockName=t.getName(),r.sequence=t.getSequence(),r}return vC(t,e),t.prototype.getLockName=function(){return this.lockName},t.prototype.getSequence=function(){return this.sequence},t.prototype.getConstraintType=function(){return"LOCKED"},t}(_C);yC.Locked=wC;var gC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vC(t,e),t.prototype.getConstraintType=function(){return"NO_TOPIC"},t}(_C);yC.NoTopic=gC;var OC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vC(t,e),t.prototype.getConstraintType=function(){return"NO_VALUE"},t}(_C);yC.NoValue=OC;var TC=function(e){function t(t,r){void 0===t&&(t={}),void 0===r&&(r=new Ty.Set);var n=e.call(this)||this;return n.withValues=t,n.withoutValues=r,n}return vC(t,e),t.prototype.getWithValues=function(){return Ty.Object.assign({},this.withValues)},t.prototype.getWithoutValues=function(){return new Ty.Set(this.withoutValues)},t.prototype.with=function(e,r,n){var o=void 0!==n?n:iE.DataTypes.getByValue(r);if(void 0===o)throw new Error("Datatype invalid or could not be inferred");S_.requireNonNull(r,"value"),f_.JSONPointer.parse(S_.requireNonNull(e,"pointer"));var i={};return i[e.toString()]=o.toBytes(r),new t(Ty.Object.assign({},this.withValues,i),this.withoutValues)},t.prototype.without=function(e){f_.JSONPointer.parse(S_.requireNonNull(e,"pointer"));var r=new Ty.Set(this.withoutValues);return r.add(e.toString()),new t(this.withValues,r)},t.prototype.getConstraintType=function(){return"PARTIAL_JSON"},t}(_C);function IC(e){var t;e.forEach(function(e){if(function(e){switch(e.getConstraintType()){case"BINARY_VALUE":case"NO_VALUE":case"NO_TOPIC":case"PARTIAL_JSON":return!0;default:return!1}}(e)){if(void 0!==t)throw new Error("Multiple value constraints found: "+t+" and "+e);t=e}})}yC.PartialJSONImpl=TC;var RC={};Object.defineProperty(RC,"__esModule",{value:!0}),RC.write=function(e,t){jy.writeBytes(e,t.getBytes().asBuffer())};var bC={};Object.defineProperty(bC,"__esModule",{value:!0}),bC.write=function(e,t,r){jy.writeCollection(e,t.getConstraints(),r)};var CC={};Object.defineProperty(CC,"__esModule",{value:!0}),CC.write=function(e,t){jy.writeString(e,t.getLockName()),jy.writeInt64(e,t.getSequence())};var PC={};Object.defineProperty(PC,"__esModule",{value:!0}),PC.write=function(){};var AC={};Object.defineProperty(AC,"__esModule",{value:!0}),AC.write=function(){};var NC={};Object.defineProperty(NC,"__esModule",{value:!0}),NC.write=function(e,t){jy.writeObject(e,t.getWithValues(),jy.writeString,function(e,t){jy.writeBytes(e,t.asBuffer())}),jy.writeCollection(e,Ty.Array.from(t.getWithoutValues()),jy.writeString)};var MC={};Object.defineProperty(MC,"__esModule",{value:!0}),MC.write=function(){};var LC={};Object.defineProperty(LC,"__esModule",{value:!0});var DC={UNCONSTRAINED:MC,CONJUNCTION:bC,BINARY_VALUE:RC,NO_VALUE:AC,LOCKED:CC,NO_TOPIC:PC,PARTIAL_JSON:NC};LC.write=function e(t,r){if(void 0===r.getConstraintType||void 0===yC.ConstraintType[r.getConstraintType()])throw new Error("Unknown constraint type");jy.writeByte(t,yC.ConstraintType[r.getConstraintType()]),DC[r.getConstraintType()].write(t,r,e)};var jC={},UC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(jC,"__esModule",{value:!0});var xC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return UC(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.path),NE.write(e,t.topicSpecification),jy.writeBytes(e,t.value),LC.write(e,t.constraint)},t}(By.AbstractSerialiser);jC.AddAndSetTopicRequestSerialiser=new xC;var BC,kC={};Object.defineProperty(kC,"__esModule",{value:!0}),function(e){e[e.CREATED=1]="CREATED",e[e.EXISTS=2]="EXISTS"}(BC=kC.TopicCreationResult||(kC.TopicCreationResult={})),kC.TopicUpdateNamespace={TopicCreationResult:BC};var qC={};Object.defineProperty(qC,"__esModule",{value:!0});var VC=function(){return function(e){this.result=e}}();qC.AddTopicResult=VC;var FC,GC={},HC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(GC,"__esModule",{value:!0}),function(e){e[e.CREATED=0]="CREATED",e[e.EXISTS=1]="EXISTS"}(FC||(FC={}));var WC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return HC(t,e),t.prototype.read=function(e){var t=bE.read(e,FC)===FC.CREATED?kC.TopicCreationResult.CREATED:kC.TopicCreationResult.EXISTS;return new qC.AddTopicResult(t)},t}(By.AbstractSerialiser);GC.AddTopicResultSerialiser=new WC;var YC={},zC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(YC,"__esModule",{value:!0});var JC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zC(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.path),jy.writeString(e,t.patch),LC.write(e,t.constraint)},t}(By.AbstractSerialiser);YC.ApplyJsonPatchRequestSerialiser=new JC;var $C={},KC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($C,"__esModule",{value:!0});var QC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return KC(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.path),bE.write(e,t.topicType),jy.writeBytes(e,t.value),LC.write(e,t.constraint)},t}(By.AbstractSerialiser);$C.CreateUpdateStreamAndSetRequestSerialiser=new QC;var XC={},ZC=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(XC,"__esModule",{value:!0});var eP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ZC(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.path),bE.write(e,t.topicType),LC.write(e,t.constraint)},t}(By.AbstractSerialiser);XC.CreateUpdateStreamRequestSerialiser=new eP;var tP={};Object.defineProperty(tP,"__esModule",{value:!0});var rP=function(){return function(e){this.failedOperation=e<0?void 0:e}}();tP.JsonPatchResult=rP;var nP={},oP=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(nP,"__esModule",{value:!0});var iP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oP(t,e),t.prototype.read=function(e){var t=jy.readInt32(e);return new tP.JsonPatchResult(t)},t}(By.AbstractSerialiser);nP.JsonPatchResultSerialiser=new iP;var sP={},aP=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(sP,"__esModule",{value:!0});var uP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aP(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.path),bE.write(e,t.topicType),jy.writeBytes(e,t.value),LC.write(e,t.constraint)},t}(By.AbstractSerialiser);sP.SetTopicRequestSerialiser=new uP;var cP={},pP=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(cP,"__esModule",{value:!0});var fP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pP(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.path),NE.write(e,t.topicSpecification),LC.write(e,t.constraint)},t}(By.AbstractSerialiser);cP.UpdateStreamAddTopicRequestSerialiser=new fP;var lP={};Object.defineProperty(lP,"__esModule",{value:!0});var hP=function(){return function(e,t){this.creationResult=e,this.streamId=t}}();lP.UpdateStreamAddTopicResponse=hP;var dP={};Object.defineProperty(dP,"__esModule",{value:!0});var yP=function(){return function(e,t,r,n,o){this.topicId=e,this.instanceId=t,this.clustered=r,this.partitionId=n,this.generationId=o}}();dP.UpdateStreamId=yP;var vP={},_P=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vP,"__esModule",{value:!0});var SP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _P(t,e),t.prototype.read=function(e){var t=jy.readInt32(e),r=jy.readInt32(e),n=jy.readInt32(e),o=jy.readInt32(e),i=0!==n;return new dP.UpdateStreamId(t,r,i,i?n-1:0,i?o:0)},t.prototype.write=function(e,t){jy.writeInt32(e,t.topicId),jy.writeInt32(e,t.instanceId),t.clustered?(jy.writeInt32(e,t.partitionId+1),jy.writeInt32(e,t.generationId)):(jy.writeInt32(e,0),jy.writeInt32(e,0))},t}(By.AbstractSerialiser);vP.UpdateStreamIdSerialiser=new SP;var EP={},mP=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(EP,"__esModule",{value:!0});var wP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mP(t,e),t.prototype.read=function(e){var t=GC.AddTopicResultSerialiser.read(e),r=vP.UpdateStreamIdSerialiser.read(e);return new lP.UpdateStreamAddTopicResponse(t.result,r)},t}(By.AbstractSerialiser);EP.UpdateStreamAddTopicResponseSerialiser=new wP;var gP={},OP=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gP,"__esModule",{value:!0});var TP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return OP(t,e),t.prototype.write=function(e,t){vP.UpdateStreamIdSerialiser.write(e,t.streamId),jy.writeBytes(e,t.update)},t}(By.AbstractSerialiser);gP.UpdateStreamRequestSerialiser=new TP;var IP={};Object.defineProperty(IP,"__esModule",{value:!0});var RP=function(){return function(e,t){this.view=e,this.errors=t}}();IP.CreateTopicViewResult=RP;var bP={};Object.defineProperty(bP,"__esModule",{value:!0}),bP.readTopicView=function(e){return{name:jy.readString(e),specification:jy.readString(e),roles:new Ty.Set(jy.readCollection(e,jy.readString))}};var CP={},PP=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(CP,"__esModule",{value:!0});var AP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return PP(t,e),t.prototype.read=function(e){if(0===e.peek()){jy.readByte(e);var t=bP.readTopicView(e);return new IP.CreateTopicViewResult(t)}var r=mO.ErrorReportListSerialiser.read(e);return new IP.CreateTopicViewResult(void 0,r)},t}(By.AbstractSerialiser);CP.CreateTopicViewResultSerialiser=new AP;var NP={};Object.defineProperty(NP,"__esModule",{value:!0});var MP=function(){return function(e){this.result=e}}();NP.ListTopicViewsResult=MP;var LP={},DP=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(LP,"__esModule",{value:!0});var jP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return DP(t,e),t.prototype.read=function(e){var t=jy.readCollection(e,bP.readTopicView);return new NP.ListTopicViewsResult(t)},t}(By.AbstractSerialiser);LP.ListTopicViewsResultSerialiser=new jP;var UP={},xP=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(UP,"__esModule",{value:!0});var BP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xP(t,e),t.prototype.write=function(e,t){jy.writeString(e,t.name),jy.writeString(e,t.specification)},t}(By.AbstractSerialiser);UP.NamedTopicViewSpecificationSerialiser=new BP;var kP={};Object.defineProperty(kP,"__esModule",{value:!0}),kP.read=function(e){return jy.readInt32(e)},kP.write=function(e,t){jy.writeInt32(e,t)};var qP={};Object.defineProperty(qP,"__esModule",{value:!0});var VP=function(){function e(){}return e.getAllTypes=function(){return new Ty.Set([nE.TopicTypeEnum.JSON,nE.TopicTypeEnum.BINARY,nE.TopicTypeEnum.RECORD_V2,nE.TopicTypeEnum.DOUBLE,nE.TopicTypeEnum.INT64,nE.TopicTypeEnum.STRING,nE.TopicTypeEnum.TIME_SERIES])},e}();qP.FetchRequest=VP;var FP={};Object.defineProperty(FP,"__esModule",{value:!0});var GP=function(){return function(e,t){this.id=e,this.reason=t}}();FP.UnsubscribeReasonEnum={SUBSCRIPTION_REFRESH:new GP(void 0,"The server has re-subscribed this session"),STREAM_CHANGE:new GP(void 0,"A more specific stream has been registered to the same path"),REQUESTED:new GP(0,"The unsubscription was requested by this client"),CONTROL:new GP(1,"The server or another client unsubscribed this client"),REMOVED:new GP(2,"The topic was removed"),AUTHORIZATION:new GP(3,"Not authorized to subscribe to this topic"),UNKNOWN_UNSUBSCRIBE_REASON:new GP(4,"Unknown unsubscribe reason"),BACK_PRESSURE:new GP(5,"The server has unsubscribed due to a backlog of messages")},sv.enumerize(FP.UnsubscribeReasonEnum),Object.freeze(FP.UnsubscribeReasonEnum);var HP=function(){return function(e,t){this.id=e,this.reason=t}}();FP.UpdateFailReasonEnum={INCOMPATIBLE_UPDATE:new HP(1,"Update type is incompatible with topic type"),UPDATE_FAILED:new HP(2,"Update failed - possible content incompatibility"),INVALID_UPDATER:new HP(3,"Updater is invalid for updating"),MISSING_TOPIC:new HP(4,"Topic does not exist"),EXCLUSIVE_UPDATER_CONFLICT:new HP(7,"An exclusive update source is already registered for the topic branch"),DELTA_WITHOUT_VALUE:new HP(8,"An attempt has been made to apply a delta to a topic that does not yet have a value"),CLUSTER_REPARTITION:new HP(9,"When trying to update the topic the cluster was migrating the partition that owns the topic"),INCOMPATIBLE_STATE:new HP(10,"An update could not be performed because the topic is managed bya component (e.g fan-out) that prohibits updates from the caller"),UNSATISFIED_CONSTRAINT:new HP(-1,"The topic update failed because the constraint was not satisfied"),INVALID_UPDATE_STREAM:new HP(-2,"The topic update failed because the update stream is no longer valid")},sv.enumerize(FP.UpdateFailReasonEnum),Object.freeze(FP.UpdateFailReasonEnum);var WP=function(){return function(e,t){this.id=e,this.reason=t}}();FP.TopicAddFailReasonEnum={EXISTS:new WP(1,"The topic already exists with the same details"),EXISTS_MISMATCH:new WP(2,"The topic already exists, with different details"),INVALID_PATH:new WP(3,"The topic path is invalid"),INVALID_DETAILS:new WP(4,"The topic details are invalid"),USER_CODE_ERROR:new WP(5,"A user supplied class could not be found or instantiated"),TOPIC_NOT_FOUND:new WP(6,"A referenced topic could not be found"),PERMISSIONS_FAILURE:new WP(7,"Invalid permissions to add a topic at the specified path"),INITIALISE_ERROR:new WP(8,"The topic could not be initialised, supplied value may be of the wrong format"),UNEXPECTED_ERROR:new WP(9,"An unexpected error occured while creating the topic"),CLUSTER_REPARTITION:new WP(10,"When trying to create the topic the cluster was migrating the partition that owns the topic"),EXCEEDED_LICENSE_LIMIT:new WP(11,"Adding the topic failed because of a license limit"),INCOMPATIBLE_PARENT:new WP(12,"Adding the topic failed because an incompatible topic is already bound to the parent path"),INCOMPATIBLE_MASTER:new WP(13,"Adding a slave topic failed because an incompatible topic is already bound to the specified master path."),EXISTS_INCOMPATIBLE:new WP(14,"Adding the topic failed because a topic is already bound to the specifiedpath but the caller does not have the rights to manage it"),INVALID_NAME:new WP(15,"The supplied topic path is invalid.")},sv.enumerize(FP.TopicAddFailReasonEnum),Object.freeze(FP.TopicAddFailReasonEnum),FP.topicsNamespace={FetchRequest:qP.FetchRequest,TopicType:nE.TopicTypeEnum,TopicSpecification:CE.TopicSpecification,UnsubscribeReason:FP.UnsubscribeReasonEnum,UpdateFailReason:FP.UpdateFailReasonEnum,TopicAddFailReason:FP.TopicAddFailReasonEnum};var YP={};Object.defineProperty(YP,"__esModule",{value:!0});var zP=function(){return function(e,t){this.id=e,this.reason=t}}();YP.UnsubscriptionNotification=zP;var JP={},$P=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(JP,"__esModule",{value:!0});var KP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $P(t,e),t.prototype.read=function(e){var t=kP.read(e),r=bE.read(e,FP.UnsubscribeReasonEnum);return new YP.UnsubscriptionNotification(t,r)},t.prototype.write=function(e,t){if(kP.write(e,t.id),void 0===t.reason.id)throw new Error("Cannot serialise UnsubscribeReason ${value.reason.reason}");bE.write(e,t.reason)},t}(By.AbstractSerialiser);JP.UnsubscriptionNotificationSerialiser=new KP;var QP={};Object.defineProperty(QP,"__esModule",{value:!0});var XP=function(){return function(e,t,r,n){this.cid=e,this.path=t,this.id=r,this.bytes=n}}();QP.UpdateSourceDeltaRequest=XP;var ZP={},eA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ZP,"__esModule",{value:!0});var tA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eA(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e),r=jy.readString(e),n=jy.readInt32(e),o=jy.readBytes(e);return new QP.UpdateSourceDeltaRequest(t,r,n,o)},t.prototype.write=function(e,t){Uy.CIDSerialiser.write(e,t.cid),jy.writeString(e,t.path),jy.writeInt32(e,t.id),jy.writeBytes(e,t.bytes)},t}(By.AbstractSerialiser);ZP.UpdateSourceDeltaRequestSerialiser=new tA;var rA={};Object.defineProperty(rA,"__esModule",{value:!0});var nA=function(){return function(e){this.cid=e}}();rA.UpdateSourceDeregistrationRequest=nA;var oA={},iA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(oA,"__esModule",{value:!0});var sA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return iA(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e);return new rA.UpdateSourceDeregistrationRequest(t)},t.prototype.write=function(e,t){Uy.CIDSerialiser.write(e,t.cid)},t}(By.AbstractSerialiser);oA.UpdateSourceDeregistrationRequestSerialiser=new sA;var aA={};Object.defineProperty(aA,"__esModule",{value:!0});var uA=function(){return function(e,t){this.cid=e,this.path=t}}();aA.UpdateSourceRegistrationRequest=uA;var cA={},pA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(cA,"__esModule",{value:!0});var fA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pA(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e),r=jy.readString(e);return new aA.UpdateSourceRegistrationRequest(t,r)},t.prototype.write=function(e,t){Uy.CIDSerialiser.write(e,t.cid),jy.writeString(e,t.path)},t}(By.AbstractSerialiser);cA.UpdateSourceRegistrationRequestSerialiser=new fA;var lA={};Object.defineProperty(lA,"__esModule",{value:!0});var hA=function(){return function(e,t,r){this.cid=e,this.path=t,this.bytes=r}}();lA.UpdateSourceSetRequest=hA;var dA={},yA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(dA,"__esModule",{value:!0});var vA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yA(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e),r=jy.readString(e),n=jy.readBytes(e);return new lA.UpdateSourceSetRequest(t,r,n)},t.prototype.write=function(e,t){Uy.CIDSerialiser.write(e,t.cid),jy.writeString(e,t.path),jy.writeBytes(e,t.bytes)},t}(By.AbstractSerialiser);dA.UpdateSourceSetRequestSerialiser=new vA;var _A={};Object.defineProperty(_A,"__esModule",{value:!0});var SA=function(){return function(e,t,r){this.cid=e,this.old=t,this.current=r}}();_A.UpdateSourceStateRequest=SA;var EA={};Object.defineProperty(EA,"__esModule",{value:!0}),function(e){e[e.INIT=0]="INIT",e[e.ACTIVE=1]="ACTIVE",e[e.CLOSED=2]="CLOSED",e[e.STANDBY=3]="STANDBY"}(EA.UpdateSourceState||(EA.UpdateSourceState={}));var mA={};Object.defineProperty(mA,"__esModule",{value:!0});var wA=function(){return function(e){this.state=e}}();mA.UpdateSourceState=wA;var gA={},OA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gA,"__esModule",{value:!0});var TA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return OA(t,e),t.prototype.read=function(e){var t=bE.read(e,EA.UpdateSourceState);return new mA.UpdateSourceState(t)},t}(By.AbstractSerialiser);gA.UpdateSourceStateSerialiser=new TA;var IA={},RA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(IA,"__esModule",{value:!0});var bA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return RA(t,e),t.prototype.read=function(e){var t=Uy.CIDSerialiser.read(e),r=gA.UpdateSourceStateSerialiser.read(e),n=gA.UpdateSourceStateSerialiser.read(e);return new _A.UpdateSourceStateRequest(t,r.state,n.state)},t}(By.AbstractSerialiser);IA.UpdateSourceStateRequestSerialiser=new bA;var CA={};Object.defineProperty(CA,"__esModule",{value:!0}),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.INCOMPATIBLE_UPDATE=1]="INCOMPATIBLE_UPDATE",e[e.UPDATE_FAILED=2]="UPDATE_FAILED",e[e.INVALID_UPDATER=3]="INVALID_UPDATER",e[e.MISSING_TOPIC=4]="MISSING_TOPIC",e[e.INVALID_ADDRESS=5]="INVALID_ADDRESS",e[e.DUPLICATES=6]="DUPLICATES",e[e.EXCLUSIVE_UPDATER_CONFLICT=7]="EXCLUSIVE_UPDATER_CONFLICT",e[e.DELTA_WITHOUT_VALUE=8]="DELTA_WITHOUT_VALUE",e[e.CLUSTER_REPARTITION=9]="CLUSTER_REPARTITION",e[e.INCOMPATIBLE_STATE=10]="INCOMPATIBLE_STATE"}(CA.ResponseCode||(CA.ResponseCode={}));var PA=function(){return function(e){this.error=e}}();CA.UpdateSourceUpdateResponse=PA;var AA={},NA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(AA,"__esModule",{value:!0});var MA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return NA(t,e),t.prototype.read=function(e){var t=bE.read(e,CA.ResponseCode);return new CA.UpdateSourceUpdateResponse(t===CA.ResponseCode.SUCCESS?null:t)},t}(By.AbstractSerialiser);AA.UpdateSourceUpdateResponseSerialiser=new MA;var LA={};Object.defineProperty(LA,"__esModule",{value:!0}),LA.UpdateTopicResponseEnum={SUCCESS:{id:0,reason:null},INCOMPATIBLE_UPDATE:{id:1,reason:FP.UpdateFailReasonEnum.INCOMPATIBLE_UPDATE},UPDATE_FAILED:{id:2,reason:FP.UpdateFailReasonEnum.UPDATE_FAILED},INVALID_UPDATER:{id:3,reason:FP.UpdateFailReasonEnum.INVALID_UPDATER},MISSING_TOPIC:{id:4,reason:FP.UpdateFailReasonEnum.MISSING_TOPIC},EXCLUSIVE_UPDATER_CONFLICT:{id:7,reason:FP.UpdateFailReasonEnum.EXCLUSIVE_UPDATER_CONFLICT},DELTA_WITHOUT_VALUE:{id:8,reason:FP.UpdateFailReasonEnum.DELTA_WITHOUT_VALUE},CLUSTER_REPARTITION:{id:9,reason:FP.UpdateFailReasonEnum.CLUSTER_REPARTITION},INCOMPATIBLE_STATE:{id:10,reason:FP.UpdateFailReasonEnum.INCOMPATIBLE_STATE},UNSATISFIED_CONSTRAINT:{id:-1,reason:FP.UpdateFailReasonEnum.UNSATISFIED_CONSTRAINT},INVALID_UPDATE_STREAM:{id:-2,reason:FP.UpdateFailReasonEnum.INVALID_UPDATE_STREAM}},sv.enumerize(LA.UpdateTopicResponseEnum),Object.freeze(LA.UpdateTopicResponseEnum);var DA=function(){return function(e,t){this.reason=e,this.isError=t}}();LA.UpdateTopicResponse=DA;var jA={},UA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(jA,"__esModule",{value:!0});var xA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return UA(t,e),t.prototype.read=function(e){var t=bE.read(e,LA.UpdateTopicResponseEnum);return new LA.UpdateTopicResponse(t.reason,t!==LA.UpdateTopicResponseEnum.SUCCESS)},t}(By.AbstractSerialiser);jA.UpdateTopicResponseSerialiser=new xA;var BA={};Object.defineProperty(BA,"__esModule",{value:!0});var kA=function(){return function(e,t){this.path=e,this.bytes=t}}();BA.UpdateTopicSetRequest=kA;var qA={},VA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(qA,"__esModule",{value:!0});var FA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return VA(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=jy.readBytes(e);return new BA.UpdateTopicSetRequest(t,r)},t.prototype.write=function(e,t){jy.writeString(e,t.path),jy.writeBytes(e,t.bytes)},t}(By.AbstractSerialiser);qA.UpdateTopicSetRequestSerialiser=new FA;var GA={};Object.defineProperty(GA,"__esModule",{value:!0}),function(e){e[e.REMOVE_TOPICS=0]="REMOVE_TOPICS"}(GA.Will||(GA.Will={}));var HA=function(){return function(e,t){this.path=e,this.will=t}}();GA.TopicWillParameters=HA;var WA={},YA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(WA,"__esModule",{value:!0});var zA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return YA(t,e),t.prototype.read=function(e){var t=jy.readString(e),r=bE.read(e,GA.Will);return new GA.TopicWillParameters(t,r)},t.prototype.write=function(e,t){jy.writeString(e,t.path),bE.write(e,t.will)},t}(By.AbstractSerialiser);WA.TopicWillParametersSerialiser=new zA;var JA={};Object.defineProperty(JA,"__esModule",{value:!0}),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.GROUP_CONFLICT=1]="GROUP_CONFLICT",e[e.TOPIC_TREE_CONFLICT=2]="TOPIC_TREE_CONFLICT"}(JA.WillRegistrationResultEnum||(JA.WillRegistrationResultEnum={}));var $A=function(){return function(e){this.result=e}}();JA.WillRegistrationResult=$A;var KA={},QA=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(KA,"__esModule",{value:!0});var XA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return QA(t,e),t.prototype.read=function(e){var t=bE.read(e,JA.WillRegistrationResultEnum);return new JA.WillRegistrationResult(t)},t.prototype.write=function(e,t){bE.write(e,t.result)},t}(By.AbstractSerialiser);KA.WillRegistrationResultSerialiser=new XA;var ZA={};Object.defineProperty(ZA,"__esModule",{value:!0});var eN={read:function(){return null},write:function(){}};ZA.FETCH={id:2,request:JO.FetchRequestSerialiser,response:eN},ZA.SUBSCRIBE={id:3,request:sm.TopicSelectorSerialiser,response:eN},ZA.UNSUBSCRIBE={id:4,request:sm.TopicSelectorSerialiser,response:eN},ZA.SUBSCRIBE_CLIENT={id:10,request:dw.ClientSubscribeRequestSerialiser,response:eN},ZA.UNSUBSCRIBE_CLIENT={id:11,request:dw.ClientSubscribeRequestSerialiser,response:eN},ZA.CLOSE_CLIENT={id:14,request:Iw.CloseClientRequestSerialiser,response:eN},ZA.SET_CLIENT_CONFLATION={id:15,request:Gg.SetClientConflationRequestSerialiser,response:eN},ZA.UNSUBSCRIPTION_NOTIFICATION={id:42,request:JP.UnsubscriptionNotificationSerialiser,response:eN},ZA.MISSING_TOPIC={id:50,request:GT.MissingTopicRequestSerialiser,response:cm.BooleanSerialiser},ZA.TOPIC_SCOPED_WILL_REGISTRATION={id:53,request:WA.TopicWillParametersSerialiser,response:KA.WillRegistrationResultSerialiser},ZA.TOPIC_SCOPED_WILL_DEREGISTRATION={id:54,request:WA.TopicWillParametersSerialiser,response:eN},ZA.SYSTEM_PING={id:55,request:eN,response:eN},ZA.USER_PING={id:56,request:eN,response:eN},ZA.CHANGE_PRINCIPAL={id:5,request:Hm.ChangePrincipalRequestSerialiser,response:cm.BooleanSerialiser},ZA.GET_SYSTEM_AUTHENTICATION={id:57,request:eN,response:km.SystemAuthenticationConfigurationSerialiser},ZA.UPDATE_SYSTEM_AUTHENTICATION={id:58,request:_m.SecurityCommandScriptSerialiser,response:mO.ErrorReportListSerialiser},ZA.GET_SECURITY_CONFIGURATION={id:59,request:eN,response:VR.SecurityConfigurationSerialiser},ZA.UPDATE_SECURITY_CONFIGURATION={id:60,request:_m.SecurityCommandScriptSerialiser,response:mO.ErrorReportListSerialiser},ZA.TOPIC_CONTROL_REGISTRATION={id:20,request:pO.TopicControlRegistrationRequestSerialiser,response:eN},ZA.TOPIC_CONTROL_DEREGISTRATION={id:21,request:aO.TopicControlRegistrationParamsSerialiser,response:eN},ZA.AUTHENTICATION_CONTROL_REGISTRATION={id:22,request:xI.AuthenticationControlRegistrationRequestSerialiser,response:eN},ZA.AUTHENTICATION_CONTROL_DEREGISTRATION={id:23,request:NI.AuthenticationControlRegistrationParametersSerialiser,response:eN},ZA.AUTHENTICATION={id:24,request:JI.AuthenticationRequestSerialiser,response:eR.AuthenticationResponseSerialiser},ZA.AUTHENTICATOR_REGISTRATION={id:119,request:fR.AuthenticatorRegistrationRequestSerialiser,response:eN},ZA.AUTHENTICATOR={id:120,request:vR.AuthenticatorRequestSerialiser,response:gR.AuthenticatorResponseSerialiser},ZA.AUTHENTICATOR_DEREGISTRATION={id:121,request:sR.AuthenticatorRegistrationParametersSerialiser,response:eN},ZA.UPDATE_SOURCE_REGISTRATION={id:30,request:cA.UpdateSourceRegistrationRequestSerialiser,response:gA.UpdateSourceStateSerialiser},ZA.UPDATE_SOURCE_DEREGISTRATION={id:31,request:oA.UpdateSourceDeregistrationRequestSerialiser,response:eN},ZA.UPDATE_SOURCE_STATE={id:32,request:IA.UpdateSourceStateRequestSerialiser,response:eN},ZA.MESSAGE_RECEIVER_CONTROL_REGISTRATION={id:63,request:Hw.MessageReceiverControlRegistrationRequestSerialiser,response:eN},ZA.MESSAGE_RECEIVER_CONTROL_DEREGISTRATION={id:64,request:Vw.MessageReceiverControlRegistrationParamsSerialiser,response:eN},ZA.FILTER_SUBSCRIBE={id:65,request:$m.ClientFilterSubscribeRequestSerialiser,response:iw.ClientFilterSubscribeResponseSerialiser},ZA.FILTER_UNSUBSCRIBE={id:66,request:$m.ClientFilterSubscribeRequestSerialiser,response:iw.ClientFilterSubscribeResponseSerialiser},ZA.GET_SESSION_PROPERTIES={id:67,request:Cw.GetSessionPropertiesRequestSerialiser,response:Lw.GetSessionPropertiesResponseSerialiser},ZA.SET_SESSION_PROPERTIES={id:105,request:Xg.SetSessionPropertiesRequestSerialiser,response:oO.SetSessionPropertiesResultSerialiser},ZA.SET_SESSION_PROPERTIES_FILTER={id:106,request:Yg.SetSessionPropertiesFilterRequestSerialiser,response:yO.CountOrParserErrorsSerialiser},ZA.MESSAGING_SEND={id:85,request:Tg.MessagingSendRequestSerialiser,response:ig.MessagingResponseSerialiser},ZA.MESSAGING_RECEIVER_SERVER={id:86,request:Xw.MessagingClientSendRequestSerialiser,response:ig.MessagingResponseSerialiser},ZA.NOTIFY_SUBSCRIPTION={id:87,request:ME.TopicSpecificationInfoSerialiser,response:eN},ZA.MESSAGING_RECEIVER_CLIENT={id:88,request:$w.MessagingClientForwardSendRequestSerialiser,response:ig.MessagingResponseSerialiser},ZA.MESSAGING_FILTER_SEND={id:102,request:dg.MessagingFilterSendRequestSerialiser,response:Eg.MessagingFilterSendResponseSerialiser},ZA.FILTER_RESPONSE={id:103,request:fg.MessagingFilterResponseSerialiser,response:eN},ZA.TOPIC_NOTIFICATION_DEREGISTRATION={id:91,request:$b.TopicNotificationDeregistrationRequestSerialiser,response:eN},ZA.TOPIC_NOTIFICATION_EVENTS={id:92,request:cC.TopicNotificationEventSerialiser,response:eN},ZA.TOPIC_DESCENDANT_EVENTS={id:93,request:tC.TopicNotificationDescendantEventSerialiser,response:eN},ZA.TOPIC_NOTIFICATION_SELECTION={id:94,request:lC.TopicNotificationSelectionSerialiser,response:eN},ZA.TOPIC_NOTIFICATION_DESELECTION={id:95,request:oC.TopicNotificationDeselectionSerialiser,response:eN},ZA.MESSAGING_RECEIVER_CONTROL_REGISTRATION={id:97,request:Hw.MessageReceiverControlRegistrationRequestSerialiser,response:eN},ZA.MESSAGING_RECEIVER_CONTROL_DEREGISTRATION={id:98,request:Vw.MessageReceiverControlRegistrationParamsSerialiser,response:eN},ZA.UPDATE_SOURCE_SET={id:77,request:dA.UpdateSourceSetRequestSerialiser,response:AA.UpdateSourceUpdateResponseSerialiser},ZA.UPDATE_SOURCE_DELTA={id:78,request:ZP.UpdateSourceDeltaRequestSerialiser,response:AA.UpdateSourceUpdateResponseSerialiser},ZA.UPDATE_TOPIC_SET={id:79,request:qA.UpdateTopicSetRequestSerialiser,response:jA.UpdateTopicResponseSerialiser},ZA.SESSION_PROPERTIES_REGISTRATION_2={id:81,request:$g.SetSessionPropertiesListenerSerialiser,response:eN},ZA.SESSION_PROPERTIES_EVENT_2={id:82,request:xg.SessionPropertiesEventBatchSerialiser,response:eN},ZA.TOPIC_REMOVAL={id:83,request:dI.RemoveTopicSerialiser,response:eN},ZA.RANGE_QUERY={id:84,request:Sb.RangeQueryRequestSerialiser,response:bb.RangeQueryResultSerialiser},ZA.TIME_SERIES_APPEND={id:99,request:jb.TimeSeriesAppendRequestSerialiser,response:JS.EventMetadataImplSerialiser},ZA.TIME_SERIES_EDIT={id:100,request:Bb.TimeSeriesEditRequestSerialiser,response:JS.EventMetadataImplSerialiser},ZA.TOPIC_ADD={id:112,request:Vb.TopicAddRequestSerialiser,response:Yb.TopicAddResponseSerialiser},ZA.ACQUIRE_SESSION_LOCK={id:114,request:QR.SessionLockRequestSerialiser,response:JR.SessionLockAcquisitionSerialiser},ZA.RELEASE_SESSION_LOCK={id:116,request:JR.SessionLockAcquisitionSerialiser,response:cm.BooleanSerialiser},ZA.FETCH_QUERY={id:117,request:FO.FetchQuerySerialiser,response:UO.FetchQueryResultSerialiser},ZA.SET_TOPIC={id:118,request:sP.SetTopicRequestSerialiser,response:eN},ZA.ADD_AND_SET_TOPIC={id:122,request:jC.AddAndSetTopicRequestSerialiser,response:GC.AddTopicResultSerialiser},ZA.APPLY_JSON_PATCH={id:151,request:YC.ApplyJsonPatchRequestSerialiser,response:nP.JsonPatchResultSerialiser},ZA.CHANGE_AUTHORISATION_ROLES={id:123,request:mw.ChangeAuthorisationRolesRequestSerialiser,response:eN},ZA.CHANGE_AUTHORISATION_ROLES_FILTER={id:124,request:_w.ChangeAuthorisationRolesFilterRequestSerialiser,response:yO.CountOrParserErrorsSerialiser},ZA.CREATE_UPDATE_STREAM={id:125,request:XC.CreateUpdateStreamRequestSerialiser,response:vP.UpdateStreamIdSerialiser},ZA.CREATE_UPDATE_STREAM_AND_SET={id:126,request:$C.CreateUpdateStreamAndSetRequestSerialiser,response:vP.UpdateStreamIdSerialiser},ZA.CHECK_UPDATE_STREAM={id:127,request:vP.UpdateStreamIdSerialiser,response:eN},ZA.STREAM_SET_TOPIC_SERVICE={id:128,request:gP.UpdateStreamRequestSerialiser,response:eN},ZA.STREAM_APPLY_DELTA_SERVICE={id:129,request:gP.UpdateStreamRequestSerialiser,response:eN},ZA.STREAM_ADD_TOPIC_SERVICE={id:130,request:cP.UpdateStreamAddTopicRequestSerialiser,response:EP.UpdateStreamAddTopicResponseSerialiser},ZA.STREAM_ADD_AND_SET_TOPIC_SERVICE={id:131,request:jC.AddAndSetTopicRequestSerialiser,response:EP.UpdateStreamAddTopicResponseSerialiser},ZA.FETCH_LOG_ENTRIES_SERVICE={id:132,request:ZO.EntriesFetchRequestSerialiser,response:oT.EntriesFetchResponseSerialiser},ZA.PUT_SESSION_METRIC_COLLECTOR={id:135,request:dT.SessionMetricCollectorSerialiser,response:mO.ErrorReportListSerialiser},ZA.REMOVE_SESSION_METRIC_COLLECTOR={id:136,request:hm.StringSerialiser,response:eN},ZA.FETCH_SESSION_METRIC_COLLECTORS={id:137,request:eN,response:_T.SessionMetricCollectorListSerialiser},ZA.CREATE_TOPIC_VIEW={id:138,request:UP.NamedTopicViewSpecificationSerialiser,response:CP.CreateTopicViewResultSerialiser},ZA.REMOVE_TOPIC_VIEW={id:139,request:hm.StringSerialiser,response:eN},ZA.LIST_TOPIC_VIEWS={id:141,request:eN,response:LP.ListTopicViewsResultSerialiser},ZA.GET_SERVER_METRICS={id:142,request:eN,response:BT.ServerMetricsSerialiser},ZA.LIST_GLOBAL_PERMISSIONS={id:143,request:eN,response:CR.ListGlobalPermissionsResultSerialiser},ZA.LIST_PATH_PERMISSIONS={id:144,request:hm.StringSerialiser,response:LR.ListPathPermissionsResultSerialiser},ZA.GET_MEASURED_ENTITY_CLASS_METRICS={id:145,request:hm.StringSerialiser,response:LT.MeasuredEntityClassMetricsSerialiser},ZA.PUT_TOPIC_METRIC_COLLECTOR={id:146,request:IT.TopicMetricCollectorSerialiser,response:eN},ZA.REMOVE_TOPIC_METRIC_COLLECTOR={id:147,request:hm.StringSerialiser,response:eN},ZA.FETCH_TOPIC_METRIC_COLLECTORS={id:148,request:eN,response:CT.TopicMetricCollectorListSerialiser},ZA.FETCH_JMX_VALUES={id:149,request:IO.JMXObjectNamesSerialiser,response:CO.MBeanValuesSerialiser},ZA.CREATE_REMOTE_SERVER={id:157,request:pI.RemoteServerDefinitionSerialiser,response:rI.CreateRemoteServerResultSerialiser},ZA.REMOVE_REMOTE_SERVER={id:158,request:hm.StringSerialiser,response:eN},ZA.UPDATE_LICENSE={id:159,request:fm.BytesSerialiser,response:EI.ReplaceLicenceResponseSerialiser},ZA.CLOSE_CLIENT_FILTER={id:162,request:hm.StringSerialiser,response:yO.CountOrParserErrorsSerialiser},ZA.SET_CLIENT_CONFLATION_FILTER={id:163,request:qg.SetClientConflationFilterRequestSerialiser,response:yO.CountOrParserErrorsSerialiser},ZA.LIST_REMOTE_SERVERS={id:164,request:eN,response:aI.ListRemoteServersResultSerialiser},ZA.CHECK_REMOTE_SERVER={id:165,request:hm.StringSerialiser,response:KT.CheckRemoteServerResultSerialiser};var tN={};Object.defineProperty(tN,"__esModule",{value:!0}),tN.responseSuccess=function(e,t){return!e};var rN={};Object.defineProperty(rN,"__esModule",{value:!0});var nN=$y.create("diffusion.locks.SessionLocks"),oN=function(){function e(e,t,r){var n=this;this.owned=!0,this.acquisition=e,this.unlockSessionLock=r,t.setOwned=function(e){n.owned=e}}return e.prototype.toString=function(){return"SessionLock [name="+this.acquisition.lockName+", sequence="+this.acquisition.sequence+", scope="+this.acquisition.scope+", owned="+this.owned+"]"},e.prototype.getName=function(){return this.acquisition.lockName},e.prototype.getSequence=function(){return this.acquisition.sequence},e.prototype.isOwned=function(){return this.owned},e.prototype.getScope=function(){return this.acquisition.scope},e.prototype.unlock=function(){return this.owned?(this.owned=!1,this.unlockSessionLock(this.acquisition)):Ty.Promise.resolve(!1)},e}(),iN=function(){function e(e,t){var r=this;this.locks={},this.nextRequestId=0,this.serviceLocator=e.getServiceLocator(),this.ACQUIRE_SESSION_LOCK=this.serviceLocator.obtain(ZA.ACQUIRE_SESSION_LOCK),this.RELEASE_SESSION_LOCK=this.serviceLocator.obtain(ZA.RELEASE_SESSION_LOCK),t.on("change",function(t,n){var o=null,i=function(e){e.ownedSetter.setOwned(!1),e.onRemoveLock()};n===te.InternalSessionState.DISCONNECTED?(Ty.Object.values(r.locks).filter(function(e){return e.lock.getScope()===WR.SessionLockScope.UNLOCK_ON_CONNECTION_LOSS}).forEach(i),o=e.getConversationSet().newConversation({onOpen:function(){},onResponse:function(){return!0},onDiscard:function(){Ty.Object.values(r.locks).forEach(i),r.locks={}}})):n===te.InternalSessionState.CONNECTED?null!==o&&(e.getConversationSet().respondIfPresent(o,null),o=null):n===te.InternalSessionState.CLOSED&&(Ty.Object.values(r.locks).forEach(i),r.locks={})})}return e.prototype.handleAcquisistion=function(e,t,r){var n,o=this.locks[e];return void 0!==o?o.lock.getSequence().equals(t.sequence)?n=o.lock:(o.ownedSetter.setOwned(!1),n=this.createLock(e,t,r)):n=this.createLock(e,t,r),n},e.prototype.createLock=function(e,t,r){var n={setOwned:function(){throw Error("Session lock ownedSetter must be implemented")}},o=new oN(t,n,this.unlock.bind(this)),i=r?{lock:o,ownedSetter:{setOwned:function(e){n.setOwned(e),r.onOwned(e)}},onRemoveLock:function(){r.onRemoveLock()}}:{lock:o,ownedSetter:n,onRemoveLock:function(){}};return this.locks[e]=i,o},e.prototype.unlock=function(e){var t=this;return new Ty.Promise(function(r,n){t.RELEASE_SESSION_LOCK.send(e,function(o,i){o?(nN.debug("Release session lock failed"),n(o)):(void 0!==t.locks[e.lockName]&&t.locks[e.lockName].lock.getSequence().toString(10)===e.sequence.toString(10)&&delete t.locks[e.lockName],r(i))})})},e.prototype.lock=function(e,t,r){var n=this;return void 0===t&&(t=WR.SessionLockScope.UNLOCK_ON_SESSION_LOSS),new Ty.Promise(function(o,i){if(void 0!==n.locks[e]&&n.locks[e].lock.isOwned())r?i(new Error("Cannot register the same lock in different shared sessions")):o(n.locks[e].lock);else{var s=n.nextRequestId++;n.ACQUIRE_SESSION_LOCK.send({lockName:e,requestId:s,scope:t},function(t,s){if(tN.responseSuccess(t,s)){var a=n.handleAcquisistion(e,s,r);o(a)}else nN.debug("Acquire session lock failed"),i(t)})}})},e}();rN.InternalSessionLocks=iN;var sN={};function aN(){return{type:tv.PROTOCOL.TYPE,version:tv.PROTOCOL.CURRENT_VERSION,capabilities:tv.PROTOCOL.CAPABILITIES}}Object.defineProperty(sN,"__esModule",{value:!0}),sN.connect=aN,sN.reconnect=function(e,t,r){return Ty.Object.assign(aN(),{token:e,availableClientSequence:t,lastServerSequence:r})};var uN={};function cN(e,t){return{id:e,message:t}}Object.defineProperty(uN,"__esModule",{value:!0}),uN.responseCodes={OK:cN(100,"Connected successfully"),DOWNGRADE:cN(102,"Server does not support the requested protocol level"),RECONNECTED:cN(105,"Reconnected successfully"),RECONNECTED_WITH_MESSAGE_LOSS:cN(106,"Reconnected with message loss"),LICENSE_EXCEEDED:cN(113,"Connection rejected due to license limit"),RECONNECTION_UNSUPPORTED:cN(114,"Reconnection not supported by connector"),CONNECTION_PROTOCOL_ERROR:cN(115,"Connection failed - protocol error"),AUTHENTICATION_FAILED:cN(116,"Connection failed - authentication failed"),UNKNOWN_SESSION:cN(117,"Reconnection failed - the session is unknown"),RECONNECTION_FAILED_MESSAGE_LOSS:cN(118,"Reconnection failed due to message loss"),REJECTED_SERVER_INITIALISING:cN(119,"Connection rejected because the server is not ready")},sv.enumerize(uN.responseCodes),uN.isSuccess=function(e){switch(e){case uN.responseCodes.OK:case uN.responseCodes.RECONNECTED:case uN.responseCodes.RECONNECTED_WITH_MESSAGE_LOSS:return!0;default:return!1}};var pN={};function fN(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=e.length);for(var o=r;o<n;++o)e[o]=t}Object.defineProperty(pN,"__esModule",{value:!0}),pN.remove=function(e,t){var r=e.indexOf(t);return r>-1&&(e.splice(r,1),!0)},pN.fill=fN,pN.ofSize=function(e,t){var r=[];return r.length=e,void 0!==t&&fN(r,t),r};var lN={};Object.defineProperty(lN,"__esModule",{value:!0});var hN=function(){function e(e){this.streams=new Ty.Map,this.fallbacks=[],this.topicCache=e}return e.prototype.add=function(e,t){var r=this.streams.get(e);r?r.push(t):this.streams.set(e,[t]),this.topicCache.newStream(e,t,this),t.onOpen()},e.prototype.addFallback=function(e){this.fallbacks.push(e)},e.prototype.getFallbacks=function(e){return this.fallbacks.filter(function(t){return t.selects(e)})},e.prototype.remove=function(e){var t=this;pN.remove(this.fallbacks,e),this.streams.forEach(function(r,n){pN.remove(r,e)&&t.topicCache.removeStream(e,t),0===r.length&&t.streams.delete(n)})},e.prototype.streamsFor=function(e,t){var r=[];return this.streams.forEach(function(n,o){o.selects(e)&&(r=r.concat(n.filter(function(e){return e.selects(t)}).map(function(e){return e.adapter?e.adapter(t):e})))}),r},e.prototype.close=function(){this.topicCache.clear(),this.streams.forEach(function(e){e.forEach(function(e){e.onSubscriptionError(av.ErrorReason.SESSION_CLOSED)})}),this.fallbacks.forEach(function(e){e.onSubscriptionError(av.ErrorReason.SESSION_CLOSED)})},e}();lN.StreamRegistryImpl=hN;var dN={};Object.defineProperty(dN,"__esModule",{value:!0});var yN=function(){function e(e,t,r){this.streams=e,this.path=t,this.specification=r}return e.prototype.proxies=function(e,t){return 0===this.streams.length?t.getFallbacks(e):this.streams},e.prototype.getTopicPath=function(){return this.path},e.prototype.getTopicSpecification=function(){return this.specification},e.prototype.notifyInitialSubscription=function(e){var t=this;this.proxies(this.specification,e).forEach(function(e){e.onSubscription(t.path,t.specification)})},e.prototype.notifySubscription=function(e){e.onSubscription(this.path,this.specification),this.notifyValueToNewStream(this.path,this.specification,e)},e.prototype.notifyUnsubscription=function(e,t){var r=this;this.proxies(this.specification,t).forEach(function(t){t.onUnsubscription(r.path,r.specification,e)})},e.prototype.notifyValue=function(e,t,r,n,o){var i=this;this.proxies(this.specification,o).forEach(function(o){o.onValue(i.path,i.specification,e,t,r,n)})},e.prototype.notifyDelta=function(e,t,r,n,o,i){var s=this;this.proxies(this.specification,i).forEach(function(i){i.onDelta(s.path,s.specification,e,t,r,n,o)})},e.prototype.addStream=function(e,t){var r=this;0===this.streams.length&&t.getFallbacks(this.specification).forEach(function(e){e.onUnsubscription(r.path,r.specification,FP.UnsubscribeReasonEnum.STREAM_CHANGE)}),this.streams.indexOf(e)<0&&(this.streams.push(e),this.notifySubscription(e))},e.prototype.removeStream=function(e,t){var r=this;pN.remove(this.streams,e),0===this.streams.length&&t.getFallbacks(this.specification).forEach(function(e){r.notifySubscription(e)})},e.prototype.removeAllStreams=function(){this.streams.length=0},e}();dN.TopicCacheEntry=yN;var vN={},_N=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vN,"__esModule",{value:!0});var SN=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n)||this;return i.datatype=o,n.properties&&n.properties.DONT_RETAIN_VALUE&&(i.dontRetainValue=JSON.parse(n.properties.DONT_RETAIN_VALUE)),i}return _N(t,e),t.prototype.handleValue=function(e,t,r){var n=this.value,o=this.buffer||null;try{var i=this.datatype.readValue(e);this.notifyValue(o,e,n,i,t),this.dontRetainValue||(this.value=i,this.buffer=e)}catch(e){r(e)}},t.prototype.handleDelta=function(e,t,r){var n=this.value,o=this.buffer||null;try{var i=this.datatype.deltaType("binary"),s=i.readDelta(e),a=i.applyImpl(n,s,this.buffer?new Tv.BufferSlice(this.buffer):void 0),u=a.value,c=a.cbor;this.value=u,this.buffer=c.$buffer,this.notifyDelta(o,c.$buffer,s,n,this.value,t)}catch(e){r(e)}},t.prototype.notifyValueToNewStream=function(e,t,r){this.buffer&&r.onValue(e,t,null,this.buffer,null,this.value)},t}(dN.TopicCacheEntry);vN.DatatypeCacheEntry=SN;var EN={},mN=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(EN,"__esModule",{value:!0});var wN=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return mN(t,e),t.prototype.handleValue=function(e,t){this.notifyValue(null,e,null,e,t)},t.prototype.handleDelta=function(e,t){this.notifyDelta(null,e,null,null,e,t)},t.prototype.notifyValueToNewStream=function(){},t}(dN.TopicCacheEntry);EN.NoValueEntry=wN;var gN={},ON=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gN,"__esModule",{value:!0});var TN=function(e){function t(t,r,n,o){return e.call(this,t,r,n,XS.TimeSeriesEventDataType.create(o))||this}return ON(t,e),t}(vN.DatatypeCacheEntry);gN.TimeSeriesCacheEntry=TN;var IN={},RN=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(IN,"__esModule",{value:!0});var bN=function(){function e(e){this.byPath={},this.byId={},this.datatypes=e}return e.prototype.handleSubscription=function(e,t){var r,n=e.path,o=t.streamsFor(n,e.specification);switch(e.specification.type){case nE.TopicTypeEnum.JSON:case nE.TopicTypeEnum.BINARY:case nE.TopicTypeEnum.STRING:case nE.TopicTypeEnum.DOUBLE:case nE.TopicTypeEnum.INT64:case nE.TopicTypeEnum.RECORD_V2:var i=this.datatypes.get(e.specification.type);if(null===i)throw new Error("Invalid topic type");r=new vN.DatatypeCacheEntry(o,n,e.specification,i);break;case nE.TopicTypeEnum.TIME_SERIES:var s=this.datatypes.get(e.specification.properties.TIME_SERIES_EVENT_VALUE_TYPE);if(null===s)throw new Error("Invalid timeseries event type");r=new gN.TimeSeriesCacheEntry(o,n,e.specification,s);break;default:r=new EN.NoValueEntry(o,n,e.specification)}var a=this.byPath[n];if(this.byPath[n]=r,a)throw new Error("Existing cache entry for "+n);var u=this.byId[e.id];if(this.byId[e.id]=r,u)throw new Error("Existing cache entry for "+e.id);r.notifyInitialSubscription(t)},e.prototype.notifyUnsubscriptionOfAllTopics=function(e){for(var t in this.byId)this.byId[t].notifyUnsubscription(FP.UnsubscribeReasonEnum.SUBSCRIPTION_REFRESH,e);this.byPath={},this.byId={}},e.prototype.handleValue=function(e,t,r,n){var o=n.getErrorHandler(),i=this.byId[e];i?i.handleValue(t,r,o):o(new Error("Data loss on topic with ID: "+e+" - possibly due to reconnection"))},e.prototype.handleDelta=function(e,t,r,n){var o=n.getErrorHandler(),i=this.byId[e];i?i.handleDelta(t,r,o):o(new Error("Data loss on topic with ID: "+e+" - possibly due to reconnection"))},e.prototype.handleUnsubscription=function(e,t,r){var n=this.byId[e];if(delete this.byId[e],n){var o=n.getTopicPath();delete this.byPath[o],n.notifyUnsubscription(t,r)}},e.prototype.newStream=function(e,t,r){for(var n in this.byPath)if(this.byPath.hasOwnProperty(n)){var o=this.byPath[n],i=o.getTopicSpecification();e.selects(n)&&t.selects(i)&&o.addStream(t.adapter?t.adapter(i):t,r)}},e.prototype.removeStream=function(e,t){for(var r in this.byPath)this.byPath.hasOwnProperty(r)&&this.byPath[r].removeStream(e,t)},e.prototype.removeAllStreams=function(){var e,t;try{for(var r=RN(Object.getOwnPropertyNames(this.byPath)),n=r.next();!n.done;n=r.next()){var o=n.value;this.byPath[o].removeAllStreams()}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.clear=function(){this.byPath={},this.byId={}},e}();IN.TopicCache=bN;var CN={};Object.defineProperty(CN,"__esModule",{value:!0}),CN.cidFromHeaders=function(e){if(!e||0===e.length)throw new Error("Empty headers, expected at least 1");return Pe.ConversationId.fromString(e[e.length-1])};var PN={};Object.defineProperty(PN,"__esModule",{value:!0});var AN=$y.create("V4 Client Routing"),NN=function(){function e(e,t,r,n,o){this.errorHandler=e,this.serviceAdapter=t,this.conversationSet=r,this.cache=n,this.registry=o}return e.prototype.route=function(e){switch(e.type){case iv.types.FETCH_REPLY:var t=CN.cidFromHeaders(e.headers);this.conversationSet.respondIfPresent(t,e);break;case iv.types.SERVICE_REQUEST:case iv.types.SERVICE_RESPONSE:case iv.types.SERVICE_ERROR:this.serviceAdapter.onMessage(e.type,e.getInputStream());break;case iv.types.TOPIC_VALUE:this.cache.handleValue(e.id,e.data,this.registry,this.errorHandler);break;case iv.types.TOPIC_DELTA:this.cache.handleDelta(e.id,e.data,this.registry,this.errorHandler);break;default:AN.debug("Unhandled V4 message: "+e.type,e)}},e.prototype.subscribe=function(e){this.cache.handleSubscription(e,this.registry)},e.prototype.unsubscribe=function(e,t){this.cache.handleUnsubscription(e,t,this.registry)},e}();PN.TopicRouting=NN;var MN={};Object.defineProperty(MN,"__esModule",{value:!0}),MN.TOKEN_LENGTH=24;var LN=function(){function e(e){this.external=e}return e.prototype.toString=function(){return this.external.toString("ascii")},e}();MN.SessionToken=LN;var DN={};Object.defineProperty(DN,"__esModule",{value:!0}),DN.readSessionToken=function(e){return new MN.SessionToken(e.readMany(MN.TOKEN_LENGTH))};var jN={},UN=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(jN,"__esModule",{value:!0});var xN,BN=$y.create("Cascading");!function(e){e[e.UNRECOGNISED_PROTOCOL_BYTE=0]="UNRECOGNISED_PROTOCOL_BYTE",e[e.PROTOCOL_VERSION_MISMATCH=1]="PROTOCOL_VERSION_MISMATCH"}(xN=jN.DeserialisationErrorReason||(jN.DeserialisationErrorReason={}));var kN=function(e){function t(t,r){var n=e.call(this,t)||this;return n.reason=r,n}return UN(t,e),t}(Error);jN.deserialise=function(e){var t=new Xy.BufferInputStream(e),r=t.read();if(r!==tv.PROTOCOL.PROTOCOL_BYTE)throw new kN("Unrecognised protocol byte: "+r,xN.UNRECOGNISED_PROTOCOL_BYTE);var n=t.read();if(n!==tv.PROTOCOL.CURRENT_VERSION){if(BN.debug("Server responded with protocol version "+n+". Client version is "+tv.PROTOCOL.CURRENT_VERSION+"."),n<tv.PROTOCOL.CURRENT_VERSION)throw new kN("Unrecognised protocol version: "+n,xN.PROTOCOL_VERSION_MISMATCH);if(n>tv.PROTOCOL.CURRENT_VERSION)throw new kN("Unsupported protocol version: "+n,xN.PROTOCOL_VERSION_MISMATCH)}var o=bE.read(t,uN.responseCodes);if(uN.isSuccess(o)){var i=new uw.SessionId(t.readUInt64(),t.readUInt64()),s=DN.readSessionToken(t),a=t.readInt64(),u=0,c=-1;return o===uN.responseCodes.RECONNECTED?u=t.readInt32():c=t.readInt32(),{response:o,identity:i,token:s,systemPingPeriod:a,version:n,success:!0,sequence:u,maximumMessageSize:c}}return{response:o,version:n,identity:null,token:null,systemPingPeriod:null,success:!1,sequence:0,maximumMessageSize:-1}};var qN={};Object.defineProperty(qN,"__esModule",{value:!0});var VN=$y.create("Parsing");qN.connectionResponse=function(e,t,r){VN.trace("Received connection handshake response");try{return e(jN.deserialise(r))}catch(e){return t(e),null}};var FN={};Object.defineProperty(FN,"__esModule",{value:!0});var GN=$y.create("Transports");function HN(){return"function"==typeof WebSocket?(GN.debug("Using native websocket"),{factory:WebSocket,enabled:!0,allowsOptions:!1}):"function"==typeof Yr?(GN.debug("Using Node WS library"),{factory:Yr,enabled:!0,allowsOptions:!0}):(GN.debug("Websocket transport not available"),{enabled:!1,allowsOptions:!1})}function WN(){return"function"==typeof XMLHttpRequest?(GN.debug("Using native XHR"),{factory:XMLHttpRequest,enabled:!0,allowsOptions:!1}):(GN.debug("XHR transport not available"),{enabled:!1,allowsOptions:!1})}FN.Subtransports=Object.freeze({WS:HN(),XHR:WN(),WEBSOCKET:HN(),HTTP_POLLING:WN()});var YN={};(function(e){"use strict";Object.defineProperty(YN,"__esModule",{value:!0}),YN.encodeAsString=function(e){var t=new ev.BufferOutputStream;return Gm.write(t,e),t.getBase64()}}).call(this,r({}).Buffer);var zN={};(function(e){"use strict";var t,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(zN,"__esModule",{value:!0});var n=$y.create("Websocket transport");var o=function(t){function o(e,r,n){var o=this,i=TE.Emitter.create();return(o=t.call(this,i)||this).emitter=i.emitter(o),o.opts=e,o.ws=r,o.allowsOptions=n,o}return r(o,t),o.prototype.handler=function(t){t.data.length>this.opts.maxMessageSize?this.emitter.error(new Error("Received message of size: "+t.data.length+", exceeding max message size: "+this.opts.maxMessageSize)):this.emitter.immediate("data",e.from(t.data))},o.prototype.connect=function(t,r){var o=this;if(void 0!==this.opts.httpProxyAgent&&!this.allowsOptions)throw new Error("httpProxyAgent option is not allowed");try{var i=function(e,t){var r=(t.secure?"wss":"ws")+"://"+t.host+":"+t.port+t.path;return r+="?ty="+e.type,r+="&v="+e.version,r+="&ca="+e.capabilities,r+="&r="+t.reconnect.timeout,e.token&&(r+="&c="+encodeURIComponent(e.token),r+="&cs="+e.availableClientSequence,r+="&ss="+e.lastServerSequence),t.properties&&(r+="&sp="+encodeURIComponent(JSON.stringify(t.properties))),t.principal&&(r+="&username="+encodeURIComponent(t.principal),r+="&password="+encodeURIComponent(YN.encodeAsString(t.credentials))),r}(t,this.opts);this.socket=void 0===this.opts.httpProxyAgent?new this.ws(i):new this.ws(i,{agent:this.opts.httpProxyAgent}),n.debug("Created websocket",i)}catch(e){throw new Error("Unable to construct WebSocket "+e)}this.socket.binaryType="arraybuffer",this.socket.onmessage=function(t){o.socket.onmessage=o.handler.bind(o),o.socket.onerror=function(e){o.emitter.error(e)},r(e.from(t.data))},this.socket.onclose=function(e){o.emitter.close(e)},this.socket.onerror=function(e){o.emitter.close(e)}},o.prototype.dispatch=function(e){n.debug("Sending websocket message",e);try{return this.socket.send(e),!0}catch(e){return n.error("Websocket send error",e),!1}},o.prototype.close=function(){return n.debug("Closing websocket"),this.socket.close(1e3),this},o}(sE.StreamImpl);zN.WSTransport=o}).call(this,r({}).Buffer);var JN={};Object.defineProperty(JN,"__esModule",{value:!0});var $N=function(){function e(){this.messages=[]}return e.prototype.length=function(){return this.messages.length},e.prototype.add=function(e){this.messages.push(e)},e.prototype.drain=function(){return this.messages.splice(0,this.messages.length)},e.prototype.isEmpty=function(){return 0===this.messages.length},e}();JN.Queue=$N;var KN={};(function(e){"use strict";var t,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),n=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(KN,"__esModule",{value:!0});var o=$y.create("XHR transport");var i=function(t){function i(e,r){var n=this,o=TE.Emitter.create();return(n=t.call(this,o)||this).emitter=o.emitter(n),n.opts=e,n.protocolVersion=null,n.pollSequence=0,n.pingSequence=0,n.pollRequest=null,n.aborted=!1,n.isSending=!1,n.queue=new JN.Queue,n.xhr=r,n}return r(i,t),i.prototype.connect=function(t,r){var n=this;try{var i=function(e,t){var r=(t.secure?"https":"http")+"://"+t.host+":"+t.port+t.path,n={m:"0",ty:"B",ca:e.capabilities,r:t.reconnect.timeout,v:e.version};return void 0!==e.token&&(n.c=e.token,n.cs=e.availableClientSequence,n.ss=e.lastServerSequence),t.properties&&(n.sp=encodeURIComponent(JSON.stringify(t.properties))),t.principal&&(n.username=encodeURIComponent(t.principal),n.password=YN.encodeAsString(t.credentials)),{uri:r,headers:n}}(t,this.opts);this.protocolVersion=i.headers.v,this.URI=i.uri;var s=this.createRequest(i.headers,i.uri);o.debug("Created XHR",i.uri),s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){var t=s.responseText,i=r(e.from(t,"binary"));if(!i)return;n.token=i.token;var a=i.response;uN.isSuccess(a)?n.poll():(o.debug(a.id+" - "+a.message),n.emitter.close())}else n.emitter.close()},s.send(null)}catch(e){throw new Error("Unable to create polling transport "+e)}},i.prototype.close=function(){return o.trace("Closing XHR transport"),this.pollRequest&&(this.aborted=!0,this.pollRequest.abort()),this.queue=new JN.Queue,this.emitter.close(),this},i.prototype.createRequest=function(e,t){var r,i,s=new this.xhr;s.open("POST",t,!0),s.overrideMimeType("text/plain; charset=x-user-defined");try{for(var a=n(Object.getOwnPropertyNames(e)),u=a.next();!u.done;u=a.next()){var c=u.value;try{s.setRequestHeader(c,e[c])}catch(t){o.warn("Can't set header "+c+":"+e.join(":"))}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return s},i.prototype.poll=function(){var t=this,r=this.createRequest({m:"1",c:this.token,s:this.pollSequence++,v:this.protocolVersion},this.URI);r.onreadystatechange=function(){if(4===r.readyState)if("reconnect"===r.getResponseHeader("diffusion-connection"))t.emitter.close();else if(200===r.status){t.aborted||t.poll();for(var n=r.responseText,o=new Xy.BufferInputStream(e.from(n,"base64"));o.pos!==o.count;){var i=o.readInt32();if(i>t.opts.maxMessageSize)return void t.emitter.error(new Error("Received message of size: "+i+", exceeding max message size: "+t.opts.maxMessageSize));var s=o.read(),a=o.readMany(i),u=e.alloc(a.length+1);u.writeUInt8(s,0),a.copy(u,1),t.emitter.emit("data",u)}}else t.emitter.close()},this.pollRequest=r,r.send(null)},i.prototype.dispatch=function(e){return!this.aborted&&(this.queue.add(e),!!this.isSending||void this.flush())},i.prototype.flush=function(){var e=this;if(!this.queue.isEmpty()){var t=function(e){var t,r,o=new ev.BufferOutputStream;try{for(var i=n(e),s=i.next();!s.done;s=i.next()){var a=s.value;o.writeInt32(a.length-1),o.writeMany(a,0,a.length)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return o.getBuffer()}(this.queue.drain()),r=this.createRequest({m:"2",c:this.token,s:this.pingSequence++,v:this.protocolVersion},this.URI);r.onreadystatechange=function(){4===r.readyState&&("reconnect"===r.getResponseHeader("diffusion-connection")?e.emitter.close():200===r.status?(e.isSending=!1,e.flush()):e.emitter.close())},this.isSending=!0,r.send(t.toString("base64"))}},i}(sE.StreamImpl);KN.XHRTransport=i}).call(this,r({}).Buffer);var QN={},XN=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(QN,"__esModule",{value:!0});var ZN=$y.create("Cascading"),eM=Object.freeze({WS:zN.WSTransport,XHR:KN.XHRTransport,WEBSOCKET:zN.WSTransport,HTTP_POLLING:KN.XHRTransport});var tM=function(e){function t(t,r,n,o){var i=this,s=TE.Emitter.create();return(i=e.call(this,s)||this).emitter=s.emitter(i),i.transports=n,i.cascadeNotifications=o,i.name=null,i.req=null,i.responseReceived=!1,i.transportFactory=function(e,t,r){var n=eM[r],o=e[r];if(n&&o&&o.enabled)return new n(t,o.factory,o.allowsOptions);throw new Error("Unknown transport name: "+r)}.bind(null,t,r),i.transport=i.selectTransport(),i.onData=i.onData.bind(i),i.onClose=i.onClose.bind(i),i.onError=i.onError.bind(i),i.onConnectionResponse=i.onConnectionResponse.bind(i),i.onParsingError=i.onParsingError.bind(i),i}return XN(t,e),t.prototype.onData=function(e){this.emitter.immediate("data",e)},t.prototype.onClose=function(e){!this.responseReceived&&this.cascade(!0)||this.emitter.emit("close",e)},t.prototype.onError=function(e){this.emitter.emit("error",e)},t.prototype.onConnectionResponse=function(e){return this.responseReceived=!0,function(e){return e===uN.responseCodes.ERROR}(e.response)&&this.cascade()?null:this.onHandshakeSuccess(e)},t.prototype.onParsingError=function(e){if(this.responseReceived=!0,!this.cascade())return this.onHandshakeError(e)},t.prototype.closeQuietly=function(){this.transport&&(this.transport.off("data",this.onData),this.transport.off("close",this.onClose),this.transport.off("error",this.onError),this.transport.close(),this.transport=null)},t.prototype.selectTransport=function(e){return void 0===e&&(e=!1),0===this.transports.length?(this.name=null,this.transport=null,ZN.debug("Transports exhausted"),this.cascadeNotifications.emit("transports-exhausted"),e||this.emitter.emit("close"),null):(this.name=this.transports.shift(),this.transport=this.transportFactory(this.name),ZN.debug("Selecting transport",this.name),this.cascadeNotifications.emit("transport-selected",this.name),this.transport)},t.prototype.internalConnect=function(){if(null===this.transport)throw new Error("Unable to connect when no transport is set");this.responseReceived=!1,ZN.debug("Attempting to connect"),this.cascadeNotifications.emit("cascading-connect"),this.transport.on("data",this.onData),this.transport.on("close",this.onClose),this.transport.on("error",this.onError);try{this.transport.connect(this.req,qN.connectionResponse.bind(null,this.onConnectionResponse,this.onParsingError))}catch(e){if(!this.cascade())throw e}return!0},t.prototype.cascade=function(e){return this.closeQuietly(),!!this.selectTransport(e)&&(this.cascadeNotifications.emit("cascade"),this.internalConnect())},t.prototype.connect=function(e,t,r){this.req=e,this.onHandshakeSuccess=t,this.onHandshakeError=r,this.internalConnect()},t.prototype.dispatch=function(e){if(null===this.transport)throw new Error("Unable to send message when no transport is set");this.transport.dispatch(e)},t.prototype.close=function(){return null!==this.transport&&(this.responseReceived=!0,this.transport.close(),this.transport=null),this},t}(sE.StreamImpl),rM=function(e){function t(t){var r=this,n=TE.Emitter.create();return(r=e.call(this,n)||this).emitter=n.emitter(r),r.subtransports=t,r}return XN(t,e),t.create=function(e){return new t(e||FN.Subtransports)},t.prototype.get=function(e){var t,r,n=(t=e.transports,r=this.subtransports,t.filter(function(e){return e&&eM.hasOwnProperty(e)&&r[e].enabled}));return 0===n.length?(ZN.warn("No valid transports found"),null):new tM(this.subtransports,e,n,this.emitter)},t}(sE.StreamImpl);QN.Transports=rM;var nM={},oM=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(nM,"__esModule",{value:!0});var iM=function(e){function t(t,r){var n=this,o=TE.Emitter.create();return(n=e.call(this,o)||this).emitter=o.emitter(n),n.states=r,n.current=r[t],n.state=t,n}return oM(t,e),t.prototype.change=function(e){return this.state===e||!(!this.states[e]||!("*"===this.current||this.current.indexOf(e)>-1))&&(this.emitter.emit("change",this.state,e),this.current=this.states[e],this.state=e,!0)},t}(sE.StreamImpl);nM.FSM=iM;var sM={};Object.defineProperty(sM,"__esModule",{value:!0});var aM=function(){function e(e,t,r){this.id=e,this.message=t,this.canReconnect=r}return e.prototype.toString=function(){return"id: "+this.message},e}();sM.CloseReasonImpl=aM;var uM={};Object.defineProperty(uM,"__esModule",{value:!0}),uM.CloseReasonEnum={CLOSED_BY_CLIENT:new sM.CloseReasonImpl(0,"The session was closed by the client",!1),CLOSED_BY_SERVER:new sM.CloseReasonImpl(1,"The session was closed by the server",!1),RECONNECT_ABORTED:new sM.CloseReasonImpl(2,"Client aborted a reconnect attempt",!1),CONNECTION_TIMEOUT:new sM.CloseReasonImpl(3,"The connection attempt timed out",!1),HANDSHAKE_REJECTED:new sM.CloseReasonImpl(4,"The connection handshake was rejected by the server",!1),HANDSHAKE_ERROR:new sM.CloseReasonImpl(5,"There was an error parsing the handshake response",!1),TRANSPORT_ERROR:new sM.CloseReasonImpl(6,"There was an unexpected error with the connection",!0),CONNECTION_ERROR:new sM.CloseReasonImpl(7,"The client could not establish a connection to the server",!0),IDLE_CONNECTION:new sM.CloseReasonImpl(8,"The activity monitor detected the connection was idle",!0),LOST_MESSAGES:new sM.CloseReasonImpl(16,"Loss of messages has been detected",!1),PROTOCOL_VERSION_MISMATCH:new sM.CloseReasonImpl(17,"There was a mismatch in the protocol versions",!1),LICENSE_EXCEEDED:new sM.CloseReasonImpl(18,"The license limit was exceeded",!1),ACCESS_DENIED:new sM.CloseReasonImpl(99,"The connection attempt was rejected by the server because authentication failed",!1)},sv.enumerize(uM.CloseReasonEnum);var cM={},pM=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(cM,"__esModule",{value:!0});var fM=te.InternalSessionState.INITIALISING,lM=te.InternalSessionState.CONNECTING,hM=te.InternalSessionState.CONNECTED,dM=te.InternalSessionState.DISCONNECTED,yM=te.InternalSessionState.RECONNECTING,vM=te.InternalSessionState.CLOSING,_M=te.InternalSessionState.CLOSED,SM=$y.create("Internal Session"),EM=function(e){function t(t,r,n,o){var i,s=this,a=TE.Emitter.create();return(s=e.call(this,a)||this).emitter=a.emitter(s),s.principal="",s.conversationSetFactory=t,s.conversationSet=t(),s.serviceRegistry=r,s.opts=o,s.fsm=new nM.FSM(fM,((i={})[fM]=[lM],i[lM]=[hM,vM],i[hM]=[dM,vM,_M],i[dM]=[yM,vM],i[yM]=[hM,vM],i[vM]=[_M],i[_M]=[],i)),s.fsm.on("change",function(e,t){SM.debug("State changed: "+e+" -> "+t)}),s.transports=QN.Transports.create(),s.transports.on({"transport-selected":function(e){s.emitter.emit("transport-selected",e)},cascade:function(){s.emitter.emit("cascade")}}),s.connection=n(s.transports,s.opts.reconnect.timeout,256),s.serviceAdapter=new uv.ServiceAdapter(s,function(e){s.connection.send(e)}),s.serviceLocator=new lv.ServiceLocatorImpl(s,s.serviceAdapter),s.topicCache=new IN.TopicCache(iE.DataTypes),s.topicStreamRegistry=new lN.StreamRegistryImpl(s.topicCache),s.topicRouting=new PN.TopicRouting(s,s.serviceAdapter,s.conversationSet,s.topicCache,s.topicStreamRegistry),s.serviceRegistry.addListener(s.serviceAdapter.addService.bind(s.serviceAdapter)),s.sessionLocks=new rN.InternalSessionLocks(s,s.fsm),s.attempts=0,s}return pM(t,e),t.prototype.getOptions=function(){return this.opts},t.prototype.getState=function(){return this.fsm.state},t.prototype.onStateChange=function(e){this.fsm.on("change",e)},t.prototype.getConversationSet=function(){return this.conversationSet},t.prototype.isConnected=function(){return this.fsm.state===hM},t.prototype.getServiceRegistry=function(){return this.serviceRegistry},t.prototype.getSessionId=function(){return this.sessionID},t.prototype.getServerMaximumMessageSize=function(){return this.serverMaximumMessageSize},t.prototype.checkConnected=function(e){return!!this.isConnected()||(e(new Error("The session is not connected. Operations are not possible at this time.")),!1)},t.prototype.internalClose=function(e){this.fsm.change(_M)?(this.topicStreamRegistry.close(),this.conversationSet.discardAll(e),this.emitter.close(e)):SM.debug("Unable to handle session close, session state: ",this.fsm.state)},t.prototype.reconnect=function(e,t){if(this.fsm.change(yM)){SM.info("Reconnect attempt ("+ ++this.attempts+")");var r=sN.reconnect(t,this.connection.getAvailableSequence(),this.connection.lastReceivedSequence);this.connection.connect(r,e,e.reconnect.timeout)}else SM.debug("Unable to attempt reconnect, session state: ",this.fsm.state)},t.prototype.abort=function(e){void 0===e&&(e=uM.CloseReasonEnum.RECONNECT_ABORTED),this.fsm.change(vM)?(SM.debug("Aborting reconnect"),this.internalClose(e)):SM.debug("Unable to abort reconnect, session state: ",this.fsm.state)},t.prototype.replaceConversationSet=function(e){var t=this.conversationSet;this.conversationSet=this.conversationSetFactory(),t.discardAll(e),SM.debug("Replaced conversation set",e)},t.prototype.connect=function(){var e=this;if(this.fsm.change(lM)){var t,r=sN.connect();this.connection.on("data",this.topicRouting.route.bind(this.topicRouting)),this.connection.on("close",this.internalClose.bind(this)),this.sessionActivityMonitor=this.opts.activityMonitor?Z.create(K.connectionActivityMonitorFactory):Z.NOOP,this.connection.on("disconnect",function(r){SM.debug("Connection disconnected, reason: ",r),e.fsm.change(dM)||e.fsm.state===yM?(e.sessionActivityMonitor.onConnectionClosed(),e.opts.reconnect.timeout>0&&r.canReconnect?(e.fsm.state===dM&&(e.emitter.emit("disconnect",r),t=setTimeout(function(){e.fsm.state!==hM&&e.abort(uM.CloseReasonEnum.CONNECTION_TIMEOUT)},e.opts.reconnect.timeout)),e.opts.reconnect.strategy(e.reconnect.bind(e,e.opts,e.token),e.abort.bind(e),r)):e.abort(r)):e.fsm.change(vM)?e.internalClose(r):(e.sessionActivityMonitor.onConnectionClosed(),SM.debug("Unable to handle session disconnect, session state: ",e.fsm.state))}),this.connection.on("connect",function(r){e.fsm.change(hM)?(e.token=r.token,r.response===uN.responseCodes.OK?(e.sessionID=r.identity,e.serverMaximumMessageSize=r.maximumMessageSize,e.sessionActivityMonitor.onNewConnection(e.connection,r),e.emitter.emit("connect",r.identity)):r.response!==uN.responseCodes.RECONNECTED&&r.response!==uN.responseCodes.RECONNECTED_WITH_MESSAGE_LOSS||(e.attempts=0,clearTimeout(t),r.response===uN.responseCodes.RECONNECTED_WITH_MESSAGE_LOSS?(e.connection.resetSequences(),e.replaceConversationSet(new Error("Peer is disconnected")),e.topicCache.notifyUnsubscriptionOfAllTopics(e.topicStreamRegistry),SM.info("Reconnected session, but messages may have been lost")):SM.info("Reconnected session"),e.sessionActivityMonitor.onNewConnection(e.connection,r),e.emitter.emit("reconnect"))):SM.trace("Unknown connection response: ",r)}),SM.debug("Connecting with options:",this.opts),SM.trace("Connecting with request:",r);try{this.connection.connect(r,this.opts)}catch(e){SM.warn("Connection error",e),this.emitter.emit("error",e),this.fsm.change(vM)&&this.internalClose(uM.CloseReasonEnum.CONNECTION_ERROR)}this.opts.principal&&(this.principal=this.opts.principal)}else SM.warn("Unable to connect, session state: ",this.fsm.state),this.emitter.emit("error",new Error("Unable to connect, session state: "+this.fsm.state))},t.prototype.close=function(){return this.fsm.change(vM)?(this.sessionActivityMonitor.onConnectionClosed(),this.connection.close(uM.CloseReasonEnum.CLOSED_BY_CLIENT)):SM.debug("Unable to close, session state: ",this.fsm.state),this},t.prototype.getErrorHandler=function(){return function(e){SM.error("Session error:",e.message)}},t.prototype.getServiceLocator=function(){return this.serviceLocator},t.prototype.getServiceAdapter=function(){return this.serviceAdapter},t.prototype.getPrincipal=function(){return this.principal},t.prototype.setPrincipal=function(e){this.principal=e},t.prototype.getStreamRegistry=function(){return this.topicStreamRegistry},t.prototype.getRouting=function(){return this.topicRouting},t.prototype.onSystemPing=function(){this.sessionActivityMonitor.onSystemPing()},t.prototype.lock=function(e,t,r){return this.sessionLocks.lock(e,t,r)},t.prototype.unlock=function(e){return this.sessionLocks.unlock(e)},t.prototype.isShared=function(){return!1},t}(sE.StreamImpl);cM.InternalSessionImpl=EM;var mM={};Object.defineProperty(mM,"__esModule",{value:!0});var wM=function(){function e(){this.services=new Ty.Map,this.listeners=[]}return e.prototype.add=function(e,t){if(this.services.has(e))throw new Error("Service already exists for "+e);this.services.set(e,t),this.listeners.forEach(function(r){r(e,t)})},e.prototype.addListener=function(e){this.listeners.push(e),this.services.forEach(function(t,r){e(r,t)})},e}();mM.ServiceRegistryImpl=wM;var gM={};Object.defineProperty(gM,"__esModule",{value:!0}),gM.monitoredPingService={onRequest:function(e,t,r){r.respond(),e.onSystemPing()}};var OM={};Object.defineProperty(OM,"__esModule",{value:!0}),OM.notifySubscriptionService={onRequest:function(e,t,r){r.respond(),e.getRouting().subscribe(t)}};var TM={};Object.defineProperty(TM,"__esModule",{value:!0}),TM.notifyUnsubscriptionService={onRequest:function(e,t,r){r.respond(),e.getRouting().unsubscribe(t.id,t.reason)}};var IM={};Object.defineProperty(IM,"__esModule",{value:!0}),IM.pingService={onRequest:function(e,t,r){r.respond()}};var RM={},bM=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),CM=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(RM,"__esModule",{value:!0});var PM,AM,NM=(PM=new oe(0),function(){return PM=PM.add(1),new Pe.ConversationId(PM)});!function(e){e[e.ALREADY_FINISHED=0]="ALREADY_FINISHED",e[e.HANDLED_AND_ACTIVE=1]="HANDLED_AND_ACTIVE",e[e.HANDLED_AND_FINISHED=2]="HANDLED_AND_FINISHED"}(AM=RM.Result||(RM.Result={}));var MM=$y.create("Conversation Set"),LM=function(e){function t(t){var r=e.call(this,t)||this;return r.name="NoSuchConversationError",r}return bM(t,e),t}(Error),DM=function(){function e(e,t){this.reserved=!1,this.closed=!1,this.handler=e,this.completedExceptionally=t}return e.prototype.open=function(e){this.handler.onOpen(e)},e.prototype.respond=function(e,t){if(this.closed)return AM.ALREADY_FINISHED;var r,n=this.reserved;this.reserved=!0;try{r=this.handler.onResponse(e,t)}catch(t){throw this.completedExceptionally(e,this,t),t}return this.closed?(MM.debug("Conversation already closed",e),AM.HANDLED_AND_FINISHED):r?(MM.debug("Response handler closed conversation",e),this.closed=!0,AM.HANDLED_AND_FINISHED):this.pendingDiscard?(MM.debug("Conversation closed with pending reason",e),this.notifyDiscard(e,this.pendingDiscard),AM.HANDLED_AND_FINISHED):(this.reserved=n,AM.HANDLED_AND_ACTIVE)},e.prototype.discard=function(e,t){this.reserved?this.pendingDiscard=t:this.notifyDiscard(e,t)},e.prototype.close=function(){this.closed=!0},e.prototype.notifyDiscard=function(e,t){if(!this.closed){this.closed=!0;try{this.handler.onDiscard(e,t)}catch(t){throw MM.error("Application handler threw exception [cid="+e+"]",t.stack),t}}},e}(),jM=function(){function e(e){this.nextCID=e,this.conversations={}}return e.prototype.completedExceptionally=function(e,t,r){MM.debug("Application handler threw exception [cid="+e+"]",r.stack),t.close(),delete this.conversations[e.toString()]},e.prototype.newConversation=function(e){var t=new DM(e,this.completedExceptionally.bind(this)),r=this.nextCID();this.conversations[r.toString()]=t;try{t.open(r)}catch(e){throw this.completedExceptionally(r,t,e),e}return void 0!==this.discardReason&&this.discard(r,this.discardReason),r},e.prototype.respond=function(e,t){var r=this.conversations[e.toString()];if(void 0===r)throw MM.debug("No conversation for cid: "+e+", response: ",t),new LM("No such conversation");switch(r.respond(e,t)){case AM.ALREADY_FINISHED:throw new LM("No such conversation");case AM.HANDLED_AND_ACTIVE:break;default:delete this.conversations[e.toString()]}},e.prototype.respondIfPresent=function(e,t){try{this.respond(e,t)}catch(e){if("NoSuchConversationError"!==e.name)throw e}},e.prototype.discard=function(e,t){var r=this.conversations[e.toString()];delete this.conversations[e.toString()],r&&r.discard(e,t)},e.prototype.discardAll=function(e){var t,r;if(void 0===this.discardReason){this.discardReason=e;try{for(var n=CM(Object.keys(this.conversations)),o=n.next();!o.done;o=n.next()){var i=o.value;this.discard(Pe.ConversationId.fromString(i),e)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}}},e.prototype.size=function(){return Object.keys(this.conversations).length},e}();RM.create=function(){return new jM(NM)};var UM={};Object.defineProperty(UM,"__esModule",{value:!0});var xM=10;function BM(e){return e>>xM}function kM(e,t){return e&t-1}var qM=function(){function e(e,t){this.messagesLength=Nv.findNextPowerOfTwo(e),this.indexCapacity=Nv.findNextPowerOfTwo(t),this.messagesMask=i_.curryR(kM,this.messagesLength),this.indexMask=i_.curryR(kM,this.indexCapacity),this.messages=pN.ofSize(this.messagesLength),this.indices=pN.ofSize(this.indexCapacity,-1),this.times=pN.ofSize(this.indexCapacity),this.timesHead=0,this.timesTail=0,this.messagesTail=this.messagesMask(0),this.messagesSize=0}return e.prototype.size=function(){return this.messagesSize},e.prototype.put=function(e){if(this.messages[this.messagesTail]=e,this.messagesTail=this.messagesMask(this.messagesTail+1),this.messagesSize<this.messagesLength)this.messagesSize=this.messagesSize+1;else for(;this.indices[this.timesHead]===this.messagesTail;)this.indices[this.timesHead]=-1,this.timesHead=this.indexMask(this.timesHead+1)},e.prototype.recover=function(e,t){if(e<0||e>this.messagesSize)return!1;for(var r=e;r>=1;--r)t(this.messages[this.messagesMask(this.messagesTail-r)]);return!0},e.prototype.clear=function(){pN.fill(this.messages,null),pN.fill(this.indices,-1),this.timesHead=0,this.timesTail=0,this.messagesSize=0},e.prototype.removeElements=function(e){var t,r=this.messagesMask(this.messagesTail-this.messagesSize);r<e?(pN.fill(this.messages,null,r,e),t=this.messagesSize-e+r):r>e?(pN.fill(this.messages,null,r,this.messagesLength),pN.fill(this.messages,null,0,e),t=this.messagesSize-r+e):(pN.fill(this.messages,null),t=0),this.messagesSize=t},e.prototype.markTime=function(e){if(this.messagesSize>0){var t=this.timesHead,r=this.timesTail,n=this.indices[t],o=BM(e);if(n>=0){var i=this.indexMask(r-1);if(this.indices[i]===this.messagesTail)return;if(this.times[i]===o)return void(this.indices[i]=this.messagesTail)}this.timesTail=this.indexMask(r+1),this.times[r]=o,this.indices[r]=this.messagesTail,t===r&&n>=0&&(this.removeElements(n),this.timesHead=this.timesTail)}},e.prototype.flush=function(e){if(!(0===this.messagesSize||this.indices[this.timesHead]<0)){var t=this.timesTail,r=BM(e);do{var n=t;if(t=this.indexMask(t-1),this.times[t]<=r)return this.removeElements(this.indices[t]),this.timesHead<=n?pN.fill(this.indices,-1,this.timesHead,n):(pN.fill(this.indices,-1,this.timesHead,this.indexCapacity),pN.fill(this.indices,-1,0,n)),void(this.timesHead=n)}while(t!==this.timesHead)}},e}();UM.RecoveryBuffer=qM;var VM={};(function(e){"use strict";var t,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(VM,"__esModule",{value:!0});var n=$y.create("Connection"),o=e.DIFFUSION_CLOSE_TIMEOUT||1e3,i=e.DIFFUSION_CONNECT_TIMEOUT||1e4,s=e.DIFFUSION_RECOVERY_BUFFER_INDEX_SIZE||8,a=function(e){function t(t,r,o){var i=this,a=TE.Emitter.create();return(i=e.call(this,a)||this).emitter=a.emitter(i),i.fsm=new nM.FSM("disconnected",{connecting:["connected","disconnected","closed"],connected:["disconnecting","disconnected","closed"],disconnecting:["disconnected"],disconnected:["connecting","closed"],closed:[]}),i.transports=t,i.reconnectTimeout=r,i.lastSentSequence=0,i.lastReceivedSequence=0,i.recoveryBuffer=new UM.RecoveryBuffer(o,s),i.fsm.on("change",function(e,t){n.debug("State changed: "+e+" -> "+t)}),i}return r(t,e),t.prototype.onData=function(e){var t=this;n.debug("Received message from transport",e),iv.parse(e,function(e,r){if(!e&&r){if(r.type===iv.types.ABORT_NOTIFICATION)return void t.transport.close();t.lastReceivedSequence++,t.emitter.emit("data",r)}else n.warn("Unable to parse message",e),t.fsm.change("closed")&&(t.closeReason=uM.CloseReasonEnum.CONNECTION_ERROR,t.transport.close())})},t.prototype.onClose=function(){this.fsm.change("disconnected")||this.fsm.change("closed")?(clearInterval(this.scheduledRecoveryBufferTrim),clearTimeout(this.scheduledClose),n.trace("Transport closed: ",this.closeReason),"disconnected"===this.fsm.state?this.emitter.emit("disconnect",this.closeReason):this.emitter.close(this.closeReason)):n.debug("Unable to disconnect, current state: ",this.fsm.state)},t.prototype.onError=function(e){n.error("Error from transport",e),this.fsm.change("closed")&&(this.closeReason=uM.CloseReasonEnum.TRANSPORT_ERROR,this.transport.close())},t.prototype.onHandshakeSuccess=function(e){if(e.response===uN.responseCodes.RECONNECTED){var t=this.lastSentSequence-e.sequence+1;if(!this.recoveryBuffer.recover(t,this.dispatch.bind(this))){var r=this.lastSentSequence-this.recoveryBuffer.size()-e.sequence+1;return n.warn("Unable to reconnect due to lost messages ("+r+")"),this.fsm.change("disconnected")&&(this.closeReason=uM.CloseReasonEnum.LOST_MESSAGES,this.transport.close()),e}this.recoveryBuffer.clear(),this.lastSentSequence=e.sequence-1}if(e.success&&this.fsm.change("connected"))n.trace("Connection response: ",e.response),this.closeReason=uM.CloseReasonEnum.TRANSPORT_ERROR,this.emitter.emit("connect",e);else{switch(n.error("Connection failed: ",e.response),e.response){case uN.responseCodes.AUTHENTICATION_FAILED:this.closeReason=uM.CloseReasonEnum.ACCESS_DENIED;break;case uN.responseCodes.LICENSE_EXCEEDED:this.closeReason=uM.CloseReasonEnum.LICENSE_EXCEEDED;break;case uN.responseCodes.DOWNGRADE:this.closeReason=uM.CloseReasonEnum.PROTOCOL_VERSION_MISMATCH;break;default:this.closeReason=uM.CloseReasonEnum.HANDSHAKE_REJECTED}this.transport.close()}return clearTimeout(this.scheduledClose),e},t.prototype.onHandshakeError=function(e){e.reason===jN.DeserialisationErrorReason.PROTOCOL_VERSION_MISMATCH?this.closeReason=uM.CloseReasonEnum.PROTOCOL_VERSION_MISMATCH:this.closeReason=uM.CloseReasonEnum.HANDSHAKE_ERROR,clearTimeout(this.scheduledClose),n.trace("Unable to deserialise handshake response",e)},t.prototype.connect=function(e,t,r){var o=this;if(void 0===r&&(r=i),"disconnected"===this.fsm.state){if(this.fsm.change("connecting")){if(this.closeReason=uM.CloseReasonEnum.CONNECTION_ERROR,this.transport=this.transports.get(t),null===this.transport)throw new Error("No valid transports requested");this.transport.on("data",this.onData.bind(this)),this.transport.on("close",this.onClose.bind(this)),this.transport.on("error",this.onError.bind(this)),this.transport.connect(e,this.onHandshakeSuccess.bind(this),this.onHandshakeError.bind(this)),this.scheduledClose=setTimeout(function(){n.debug("Timed out connection attempt after "+r),o.closeReason=uM.CloseReasonEnum.CONNECTION_TIMEOUT,o.transport.close()},r),this.scheduledRecoveryBufferTrim=setInterval(function(){"connected"===o.fsm.state&&o.recoveryBuffer.flush(Date.now()-o.reconnectTimeout)},this.reconnectTimeout)}}else n.warn("Cannot connect, current state: ",this.fsm.state)},t.prototype.resetSequences=function(){this.recoveryBuffer.clear(),this.lastSentSequence=0,this.lastReceivedSequence=0},t.prototype.getAvailableSequence=function(){return this.lastSentSequence+1-this.recoveryBuffer.size()},t.prototype.dispatch=function(e){var t=new ev.BufferOutputStream;iv.writeToBuffer(e,t),this.lastSentSequence+=1,this.recoveryBuffer.put(e),this.recoveryBuffer.markTime(Date.now()),this.transport.dispatch(t.getBuffer())},t.prototype.send=function(e){return"connected"===this.fsm.state&&(this.dispatch(e),!0)},t.prototype.close=function(e){return this.closeReason=e,"disconnected"===this.fsm.state?this.onClose():this.fsm.change("disconnecting")&&(this.dispatch(iv.create(iv.types.CLOSE_REQUEST)),this.scheduledClose=setTimeout(this.transport.close.bind(this.transport),o)),this},t.prototype.closeIdleConnection=function(){this.fsm.change("disconnecting")&&(n.debug("Connection detected as idle"),this.closeReason=uM.CloseReasonEnum.IDLE_CONNECTION,this.transport.close())},t.prototype.getState=function(){return this.fsm.state},t}(sE.StreamImpl);VM.Connection=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var FM={};Object.defineProperty(FM,"__esModule",{value:!0}),FM.create=function(e,t,r){return new VM.Connection(e,t,r)};var GM={};Object.defineProperty(GM,"__esModule",{value:!0});var HM=function(){function e(){}return e.prototype.read=function(e){return e.readMany(e.count-e.pos)},e.prototype.write=function(e,t){e.writeMany(t)},e}();GM.BufferSerialiser=new HM;var WM={};(function(e){"use strict";var t=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(WM,"__esModule",{value:!0});var r="undefined"!=typeof window&&window.location.hostname?window.location.hostname:"localhost",n="undefined"!=typeof window&&"http:"===window.location.protocol&&window.location.port?parseInt(window.location.port,10):80,o="undefined"!=typeof window&&"https:"===window.location.protocol&&window.location.port?parseInt(window.location.port,10):443,i="undefined"==typeof window||"http:"!==window.location.protocol,s="/diffusion",a=6e4,u=function(e){setTimeout(e,5e3)},c=function(e,t){t()},p="",f="",l=!0,h=["WEBSOCKET"],d=2147483647,y=1024,v=function(){function v(t){if(void 0===t&&(t={}),void 0===t.host)t.host=r;else if(t.host.indexOf(":")>-1){var v=t.host.split(":");void 0===t.port&&(t.port=parseInt(v[1],10)),t.host=v[0]}var _;void 0===t.path?t.path=s:("/"!==t.path[0]&&(t.path="/"+t.path),t.path.substring(t.path.length-s.length)!==s&&("/"===t.path[t.path.length-1]&&(t.path=t.path.substring(0,t.path.length-1)),t.path=t.path+s)),void 0!==t.port&&"string"==typeof t.port&&(isNaN(parseInt(t.port,10))?t.port=void 0:t.port=parseInt(t.port,10)),void 0===t.secure&&(void 0===t.port?t.secure=i:t.secure=t.port===o),void 0===t.port&&(t.port=t.secure?o:n),this.host=t.host,this.port=t.port,this.path=t.path,this.secure=t.secure,void 0===t.reconnect||"boolean"==typeof t.reconnect&&t.reconnect?this.reconnect={timeout:a,strategy:u}:"number"==typeof t.reconnect?this.reconnect={timeout:t.reconnect,strategy:u}:"function"==typeof t.reconnect?this.reconnect={timeout:a,strategy:t.reconnect}:"object"==typeof t.reconnect?this.reconnect={timeout:void 0===t.reconnect.timeout?a:t.reconnect.timeout,strategy:t.reconnect.strategy||u}:this.reconnect={timeout:0,strategy:c},void 0!==t.principal&&(this.principal=t.principal||p,"string"==typeof t.credentials?this.credentials=t.credentials:(_=t.credentials)instanceof Int8Array||_ instanceof Int16Array||_ instanceof Int32Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Uint16Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array?this.credentials=e.from(t.credentials.buffer):Array.isArray(t.credentials)?(t.credentials.forEach(function(e){if("number"!=typeof e||e>127||e<-128)throw new Error("Custom credentials invalid. Element must be octet.")}),this.credentials=e.from(t.credentials)):this.credentials=f),"string"==typeof t.transports?this.transports=[t.transports]:"object"==typeof t.transports&&t.transports instanceof Array&&t.transports.length>0?this.transports=t.transports.slice():this.transports=h.slice(),this.transports=this.transports.slice().map(function(e){return e.toUpperCase()});var S=t.maxMessageSize&&t.maxMessageSize>y?t.maxMessageSize:d;if(this.maxMessageSize=S,this.activityMonitor=void 0!==t.activityMonitor?t.activityMonitor:l,void 0!==t.properties){var E={};Object.getOwnPropertyNames(t.properties).forEach(function(e){"string"==typeof t.properties[e]&&(E[e]=t.properties[e])}),this.properties=E}this.httpProxyAgent=t.httpProxyAgent}return v.prototype.with=function(e){var r,n,o,i,s,a={};try{for(var u=t(Object.getOwnPropertyNames(this)),c=u.next();!c.done;c=u.next())a[s=c.value]=this[s]}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}try{for(var p=t(Object.getOwnPropertyNames(e)),f=p.next();!f.done;f=p.next())a[s=f.value]=e[s]}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return new v(a)},v}();WM.OptionsImpl=v}).call(this,r({}).Buffer);var YM={};Object.defineProperty(YM,"__esModule",{value:!0}),function(e){e.CONNECT="connect",e.CONNECT_EXISTING="connect-existing",e.CLOSE="close",e.MESSAGE="message",e.STREAM="stream",e.SERVICE="service",e.LOCK="lock"}(YM.WorkerCommand||(YM.WorkerCommand={})),function(e){e.ACQUIRED="acquired",e.ACQUIRE_ERROR="acquire_error",e.OWNED="owned",e.REMOVED="removed",e.RELEASED="released",e.RELEASE_ERROR="release_error"}(YM.WorkerSessionLockCommand||(YM.WorkerSessionLockCommand={})),function(e){e.OPEN="open",e.VALUE="value",e.SUBSCRIPTION="subscription",e.UNSUBSCRIPTION="unsubscription",e.SUBSCRIPTION_ERROR="subscription_error"}(YM.WorkerStreamCommand||(YM.WorkerStreamCommand={}));var zM={},JM=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(zM,"__esModule",{value:!0});var $M=$y.create("InternalSessionLocksProxy"),KM=function(){function e(e,t,r,n,o){var i=this;this.owned=!0,this.name=e,this.sequence=t,this.scope=r,this.releaseLock=o,n.setOwned=function(e){i.owned=e}}return e.prototype.getName=function(){return this.name},e.prototype.getSequence=function(){return this.sequence},e.prototype.isOwned=function(){return this.owned},e.prototype.getScope=function(){return this.scope},e.prototype.unlock=function(){return this.owned?(this.owned=!1,this.releaseLock(this)):Promise.resolve(!1)},e}(),QM=function(){function e(e){var t=this;this.activeRequests={},this.releaseRequests={},this.locks={},this.nextRequestId=0,this.connector=e,this.connector.on("lock_event",function(e){var r=JM(e,3),n=r[0],o=r[1],i=r[2];switch(o){case YM.WorkerSessionLockCommand.ACQUIRED:t.onLockAcquired(n,i);break;case YM.WorkerSessionLockCommand.ACQUIRE_ERROR:t.onLockAcquireError(n,i);break;case YM.WorkerSessionLockCommand.OWNED:t.onLockOwned(n,i);break;case YM.WorkerSessionLockCommand.REMOVED:t.onLockRemoved(n);break;case YM.WorkerSessionLockCommand.RELEASED:t.onLockReleased(i);break;case YM.WorkerSessionLockCommand.RELEASE_ERROR:t.onLockReleaseError(i);break;default:$M.error("Unrecognised lock_event "+o)}})}return e.prototype.onLockAcquired=function(e,t){var r=JM(t,3),n=r[0],o=r[1],i=r[2];void 0!==this.activeRequests[n]&&(this.activeRequests[n](void 0,e,oe.fromString(o,10),i),delete this.activeRequests[n])},e.prototype.onLockAcquireError=function(e,t){var r=JM(t,2),n=r[0],o=r[1];void 0!==this.activeRequests[n]&&(this.activeRequests[n](o,e),delete this.activeRequests[n])},e.prototype.onLockOwned=function(e,t){void 0!==this.locks[e]&&this.locks[e].ownedSetter.setOwned(t)},e.prototype.onLockRemoved=function(e){delete this.locks[e]},e.prototype.onLockReleased=function(e){var t=JM(e,2),r=t[0],n=t[1];this.releaseRequests[r](void 0,n)},e.prototype.onLockReleaseError=function(e){var t=JM(e,2),r=t[0],n=t[1];this.releaseRequests[r](n)},e.prototype.handleAcquisition=function(e,t,r){var n=this.locks[e];if(void 0!==n&&n.lock.getSequence().equals(t))return n.lock;var o={setOwned:function(){throw Error("Session lock ownedSetter must be implemented")}},i=new KM(e,t,r,o,this.releaseLock.bind(this));return this.locks[e]={lock:i,ownedSetter:o},i},e.prototype.releaseLock=function(e){var t=this;return new Promise(function(r,n){var o=t.nextRequestId++;t.releaseRequests[o]=function(e,i){delete t.releaseRequests[o],e?($M.debug("Release shared-session lock failed"),n(e)):r(i)},t.connector.send(YM.WorkerCommand.LOCK,JSON.stringify({action:"release",requestId:o,name:e.getName(),sequence:e.getSequence().toString(10),scope:e.getScope()}))})},e.prototype.lock=function(e,t){var r=this;return new Promise(function(n,o){if(void 0!==r.locks[e]&&r.locks[e].lock.isOwned())n(r.locks[e].lock);else{var i=r.nextRequestId++;r.activeRequests[i]=function(e,t,s,a){delete r.activeRequests[i],e?($M.debug("Acquire shared-session lock failed"),o(e)):n(r.handleAcquisition(t,s,a))},r.connector.send(YM.WorkerCommand.LOCK,JSON.stringify({action:"acquire",requestId:i,name:e,scope:t}))}})},e}();zM.InternalSessionLocksProxy=QM;var XM={};(function(e){"use strict";function t(t){var r=new Xy.BufferInputStream(e.from(t,"base64"));return NE.read(r)}function r(e,t,r){return e?("any"===t.name()?iE.DataTypes.get(r.type):t).readValue(e):null}Object.defineProperty(XM,"__esModule",{value:!0});var n=function(){function n(e,t){this.stream=e,this.datatype=t}return n.prototype.onOpen=function(){this.stream.onOpen()},n.prototype.onValue=function(n){var o=JSON.parse(n),i=t(o.specification),s=o.oldValue?e.from(o.oldValue,"base64"):null,a=e.from(o.newValue,"base64");this.stream.onValue(o.path,i,s,a,r(s,this.datatype,i),r(a,this.datatype,i))},n.prototype.onSubscription=function(e){var r=JSON.parse(e);this.stream.onSubscription(r.path,t(r.specification))},n.prototype.onUnsubscription=function(e){var r=JSON.parse(e),n=void 0!==r.reason?FP.UnsubscribeReasonEnum[FP.UnsubscribeReasonEnum[r.reason]]:FP.UnsubscribeReasonEnum.UNKNOWN_UNSUBSCRIBE_REASON;this.stream.onUnsubscription(r.path,t(r.specification),n)},n.prototype.onSubscriptionError=function(e){this.stream.onSubscriptionError(av.ErrorReason[av.ErrorReason[parseInt(e,10)]])},n}();XM.ValueStreamWorkerReceiver=n}).call(this,r({}).Buffer);var ZM={},eL=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},tL=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(ZM,"__esModule",{value:!0});var rL=function(){var e=new oe(0);return function(){return e=e.add(1),new Pe.ConversationId(e)}}(),nL=function(){function e(e){var t=this;this.connector=e,this.adapters={},this.connector.on({stream_event:function(e){var r=eL(e,4),n=r[0],o=r[1],i=r[2],s=r[3],a=t.adapters[n];if(a)switch(o){case YM.WorkerStreamCommand.OPEN:a.onOpen();break;case YM.WorkerStreamCommand.VALUE:a.onValue(s);break;case YM.WorkerStreamCommand.SUBSCRIPTION:a.onSubscription(s);break;case YM.WorkerStreamCommand.UNSUBSCRIPTION:a.onUnsubscription(s);break;case YM.WorkerStreamCommand.SUBSCRIPTION_ERROR:a.onSubscriptionError(i)}}})}return e.prototype.add=function(e,t,r){var n=rL();this.adapters[n.toString()]=new XM.ValueStreamWorkerReceiver(t,r);var o={action:"add",adapterId:n.toString(),topic:e.expression,datatype:r.name()};this.connector.send(YM.WorkerCommand.STREAM,JSON.stringify(o))},e.prototype.addFallback=function(e,t){var r=rL();this.adapters[r.toString()]=new XM.ValueStreamWorkerReceiver(e,t);var n={action:"add_fallback",adapterId:r.toString(),datatype:t.name()};this.connector.send(YM.WorkerCommand.STREAM,JSON.stringify(n))},e.prototype.remove=function(e){var t,r;try{for(var n=tL(Object.getOwnPropertyNames(this.adapters)),o=n.next();!o.done;o=n.next()){var i=o.value;if(this.adapters[i].stream===e){var s={action:"remove",adapterId:i.toString()};this.connector.send(YM.WorkerCommand.STREAM,JSON.stringify(s)),delete this.adapters[i]}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.close=function(){this.connector.send(YM.WorkerCommand.STREAM,JSON.stringify({action:"close_registry"}))},e}();ZM.StreamRegistryWebworkerProxy=nL;var oL={};(function(e){"use strict";var t,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),n=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(oL,"__esModule",{value:!0});var i=$y.create("InternalSessionWebworkerProxy"),s=function(t){function s(r,n,s,a){var u=this,c=TE.Emitter.create();return(u=t.call(this,c)||this).emitter=c.emitter(u),u.connector=s,u.opts=a,u.connected=!1,u.state=te.InternalSessionState.INITIALISING,u.connector.on({connect_event:function(e){var t=o(e,3),r=t[0],n=t[1],s=t[2];u.sessionID=uw.SessionId.fromString(r),u.connected=!0;try{u.serverMaximumMessageSize=parseInt(s,10),u.opts=JSON.parse(n),u.emitter.emit("connect",u.sessionID,new WM.OptionsImpl(u.opts))}catch(e){i.error("Unable to parse options from shared session",e),u.emitter.emit("error",new Error("Unable to parse options from shared session"))}},connect_error:function(e){u.connector.disconnect(),u.emitter.emit("error",uM.CloseReasonEnum[e]||new Error(e))},reconnect_event:function(){u.connected=!0,u.emitter.emit("reconnect")},disconnect_event:function(e){u.connected=!1;var t=uM.CloseReasonEnum[e];u.emitter.emit("disconnect",uM.CloseReasonEnum[t])},close_event:function(e){u.connector.disconnect(),u.connected=!1;var t=uM.CloseReasonEnum[e];u.emitter.close(uM.CloseReasonEnum[t])},error_event:function(e){u.connector.disconnect(),u.connected=!1,u.emitter.emit("error",new Error(e))},command_response:function(t){var r=o(t,2),n=r[0],i=r[1],s=Pe.ConversationId.fromString(n),a=new Xy.BufferInputStream(e.from(i,"base64"));u.conversationSet.respondIfPresent(s,a)},command_error:function(e){var t,r=o(e,2),n=r[0],i=r[1],s=Pe.ConversationId.fromString(n);try{t=JSON.parse(i)}catch(e){t=new Error("Could not parse error response")}u.conversationSet.discard(s,t)},service_request:function(t){var r=o(t,3),n=r[0],i=r[1],s=r[2],a=Pe.ConversationId.fromString(i),c=new ev.BufferOutputStream;Gy.CommandHeaderSerialiser.write(c,new qy.CommandHeader(parseInt(n,10),a)),GM.BufferSerialiser.write(c,e.from(s,"base64"));var p=new Xy.BufferInputStream(c.getBuffer());u.serviceAdapter.onMessage(iv.types.SERVICE_REQUEST,p)},state_change:function(e){u.state=e}}),u.serviceAdapter=new uv.ServiceAdapter(u,function(e){u.connector.sendMessage(e)}),u.serviceLocator=new lv.ServiceLocatorImpl(u,u.serviceAdapter),u.serviceRegistry=n,u.serviceRegistry.addListener(u.serviceAdapter.addService.bind(u.serviceAdapter)),u.serviceRegistry.addListener(function(e){u.connector.send(YM.WorkerCommand.SERVICE,JSON.stringify({action:"add",serviceId:e.id}))}),u.topicStreamRegistry=new ZM.StreamRegistryWebworkerProxy(u.connector),u.conversationSet=r(),u.sessionLocks=new zM.InternalSessionLocksProxy(u.connector),u}return r(s,t),s.prototype.connect=function(){if(this.opts){var t=this.opts,r=t.credentials,o=t.reconnect,i=n(t,["credentials","reconnect"]),s=r instanceof e,a=s?r.toString("base64"):r;i.reconnect=o.timeout,this.connector.send(YM.WorkerCommand.CONNECT,JSON.stringify([i,s,a]))}else this.connector.send(YM.WorkerCommand.CONNECT_EXISTING)},s.prototype.close=function(){return this.state!==te.InternalSessionState.CLOSED&&this.connector.send(YM.WorkerCommand.CLOSE),this},s.prototype.isConnected=function(){return this.connected},s.prototype.checkConnected=function(e){return!!this.isConnected()||(e(new Error("The session is not connected. Operations are not possible at this time.")),!1)},s.prototype.getSessionId=function(){return this.sessionID},s.prototype.getPrincipal=function(){if(void 0===this.opts)throw new Error("Shared session is not connected");return this.opts.principal},s.prototype.setPrincipal=function(e){if(void 0===this.opts)throw new Error("Shared session is not connected");this.opts.principal=e},s.prototype.getOptions=function(){if(void 0===this.opts)throw new Error("Shared session is not connected");return this.opts},s.prototype.getState=function(){return this.state},s.prototype.getServerMaximumMessageSize=function(){return this.serverMaximumMessageSize},s.prototype.lock=function(e,t){return this.sessionLocks.lock(e,t)},s.prototype.onSystemPing=function(){throw new Error("Method not implemented.")},s.prototype.getStreamRegistry=function(){return this.topicStreamRegistry},s.prototype.getServiceRegistry=function(){return this.serviceRegistry},s.prototype.getRouting=function(){throw new Error("Method not implemented.")},s.prototype.getServiceLocator=function(){return this.serviceLocator},s.prototype.getConversationSet=function(){return this.conversationSet},s.prototype.isShared=function(){return!0},s}(sE.StreamImpl);oL.InternalSessionWebworkerProxy=s}).call(this,r({}).Buffer);var iL={},sL=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),aL=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},uL=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},cL=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(uL(arguments[t]));return e};Object.defineProperty(iL,"__esModule",{value:!0});var pL=function(){function e(e){var t=this;this.listeners={},this.worker=new SharedWorker(e),this.worker.port.onmessage=function(e){var r,n,o=e.data[0];if(void 0!==t.listeners[o])try{for(var i=aL(t.listeners[o]),s=i.next();!s.done;s=i.next()){s.value.apply(void 0,cL([e.data[1]],e.data.slice(2)))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}}return e.prototype.getWorker=function(){return this.worker},e.prototype.addListener=function(e,t){void 0===this.listeners[e]?this.listeners[e]=[t]:this.listeners[e].push(t)},e.prototype.removeListener=function(e,t){void 0!==this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(function(e){return e!==t}))},e}(),fL={};function lL(e){if(!window||!window.SharedWorker)throw new Error("SharedWorker could not be found!");return void 0===fL[e]&&(fL[e]=new pL(e)),fL[e]}var hL=function(e){function t(t,r){var n=this,o=TE.Emitter.create();return(n=e.call(this,o)||this).emitter=o.emitter(n),n.sessionName=t,n.router=lL(r),n.worker=n.router.getWorker(),n.listener=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t.length<2?n.emitter.emit(e,t[0]):n.emitter.emit(e,t)},n.router.addListener(t,n.listener),n}return sL(t,e),t.prototype.send=function(e,t){this.worker.port.postMessage([this.sessionName,e,t])},t.prototype.sendMessage=function(e){var t={type:e.type,encoding:e.encoding,data:e.data.toString("base64"),stream:e.getBuffer().toString("base64"),headers:e.headers,id:e.id,topic:e.topic};this.send(YM.WorkerCommand.MESSAGE,JSON.stringify(t))},t.prototype.disconnect=function(){this.router.removeListener(this.sessionName,this.listener)},t}(sE.StreamImpl);iL.SharedSessionConnector=hL;var dL={};function yL(e){e=S_.requireNonNull(e,"options");var t=new mM.ServiceRegistryImpl;return t.add(ZA.USER_PING,IM.pingService),t.add(ZA.SYSTEM_PING,gM.monitoredPingService),t.add(ZA.NOTIFY_SUBSCRIPTION,OM.notifySubscriptionService),t.add(ZA.UNSUBSCRIPTION_NOTIFICATION,TM.notifyUnsubscriptionService),new cM.InternalSessionImpl(RM.create,t,FM.create,e)}function vL(e,t){var r=new mM.ServiceRegistryImpl,n=new iL.SharedSessionConnector(e,t);return function(e){return new oL.InternalSessionWebworkerProxy(RM.create,r,n,e)}}Object.defineProperty(dL,"__esModule",{value:!0}),dL.createShared=vL,dL.create=function(e,t){if(void 0===e&&void 0===t)return yL;if(void 0!==e&&void 0!==t)return vL(e,t);throw new Error('Missing parameter "name" or "workerJs" when creating a shared session')};var _L={};Object.defineProperty(_L,"__esModule",{value:!0}),_L.escape=function(e){return UE.escape(S_.requireNonNull(e,"string"))},_L.stringToRoles=function(e){return UE.stringToSet(S_.requireNonNull(e,"string"))},_L.rolesToString=function(e){return UE.collectionToString(S_.requireNonNull(e,"roles"))};var SL={},EL=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),mL=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},wL=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(mL(arguments[t]));return e};Object.defineProperty(SL,"__esModule",{value:!0});var gL,OL=$y.create("Registration");!function(e){e[e.REGISTERING=0]="REGISTERING",e[e.ACTIVE=1]="ACTIVE",e[e.CLOSED=2]="CLOSED"}(gL=SL.ResponseHandlerState||(SL.ResponseHandlerState={}));var TL=function(e){function t(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e.apply(this,wL(r))||this;return o.cause=t,o}return EL(t,e),t}(Error);function IL(e,t,r){var n,o=gL.REGISTERING;return{onDiscard:function(e,r){try{r instanceof sM.CloseReasonImpl?t.close():t.close(r)}catch(r){OL.error("REGISTERED_HANDLER_EXCEPTION",r)}o=gL.CLOSED},onOpen:function(t){n=function(){return new Ty.Promise(function(n,i){o!==gL.CLOSED?r(t,function(r){r?(e.getConversationSet().discard(t,r),i(r)):(e.getConversationSet().respondIfPresent(t,gL.CLOSED),n())}):i(new Error("Handler already closed"))})}},onResponse:function(r,i){if(i===gL.CLOSED){try{t.close()}catch(e){OL.error("REGISTERED_HANDLER_EXCEPTION",e)}return o=i,!0}try{return i===gL.ACTIVE?(t.active(n,r),o=i,!1):t.respond(i)}catch(t){OL.error("REGISTERED_HANDLER_EXCEPTION",t),e.getConversationSet().discard(r,new TL(t,"An error was thrown by the handler")),n().catch(function(e){OL.debug("Failed to deregister with the server",e)})}return!0}}}function RL(e,t,r,n){return function(o){o?(e.discard(t,o),n(o)):(e.respondIfPresent(t,gL.ACTIVE),r())}}function bL(e,t,r,n,o){var i=e.getConversationSet(),s=e.getServiceLocator(),a=s.obtain(n),u=s.obtain(o),c=i.newConversation(IL(e,r,function(e,r){u.send(t,r)}));return new Ty.Promise(function(e,r){a.send({params:t,cid:c},RL(i,c,e,r))})}SL.responseHandler=IL,SL.registrationCallback=RL,SL.registerHandler=bL,SL.registerRequestHandler=function(e,t,r){return bL(e,t,r,ZA.MESSAGING_RECEIVER_CONTROL_REGISTRATION,ZA.MESSAGING_RECEIVER_CONTROL_DEREGISTRATION)},SL.registerTopicHandler=function(e,t,r){return bL(e,t,r,ZA.TOPIC_CONTROL_REGISTRATION,ZA.TOPIC_CONTROL_DEREGISTRATION)};var CL={};Object.defineProperty(CL,"__esModule",{value:!0});var PL=function(){return function(e,t,r){this.filter=e,this.rolesToRemove=t,this.rolesToAdd=r}}();CL.ChangeAuthorisationRolesFilterRequest=PL;var AL={};Object.defineProperty(AL,"__esModule",{value:!0});var NL=function(){return function(e,t,r){this.sessionID=e,this.rolesToRemove=t,this.rolesToAdd=r}}();AL.ChangeAuthorisationRolesRequest=NL;var ML={};Object.defineProperty(ML,"__esModule",{value:!0});var LL=function(){return function(e,t){this.filter=e,this.conflate=t}}();ML.SetClientConflationFilterRequest=LL;var DL={};Object.defineProperty(DL,"__esModule",{value:!0});var jL=function(){return function(e,t){this.sessionID=e,this.conflate=t}}();DL.SetClientConflationRequest=jL;var UL={};Object.defineProperty(UL,"__esModule",{value:!0});var xL=function(){return function(e,t,r){this.filter=e,this.overwriteProperties=t,this.removeProperties=r}}();UL.SetSessionPropertiesFilterRequest=xL;var BL={};Object.defineProperty(BL,"__esModule",{value:!0}),function(e){e[e.UPDATED=0]="UPDATED",e[e.RECONNECTED=1]="RECONNECTED",e[e.FAILED_OVER=2]="FAILED_OVER",e[e.DISCONNECTED=3]="DISCONNECTED"}(BL.SessionEventType||(BL.SessionEventType={}));var kL={},qL=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},VL=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},FL=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(VL(arguments[t]));return e};Object.defineProperty(kL,"__esModule",{value:!0});var GL=$y.create("Session.Clients"),HL=function(){function e(e){this.SessionEventType=BL.SessionEventType,this.internal=e,this.serviceLocator=e.getServiceLocator(),this.SET_CLIENT_CONFLATION=this.serviceLocator.obtain(ZA.SET_CLIENT_CONFLATION),this.SET_CLIENT_CONFLATION_FILTER=this.serviceLocator.obtain(ZA.SET_CLIENT_CONFLATION_FILTER),this.GET_SESSION_PROPERTIES=this.serviceLocator.obtain(ZA.GET_SESSION_PROPERTIES),this.SESSION_PROPERTIES_REGISTRATION=this.serviceLocator.obtain(ZA.SESSION_PROPERTIES_REGISTRATION_2),this.CHANGE_AUTHORISATION_ROLES=this.serviceLocator.obtain(ZA.CHANGE_AUTHORISATION_ROLES),this.CHANGE_AUTHORISATION_ROLES_FILTER=this.serviceLocator.obtain(ZA.CHANGE_AUTHORISATION_ROLES_FILTER),this.SET_SESSION_PROPERTIES_FILTER=this.serviceLocator.obtain(ZA.SET_SESSION_PROPERTIES_FILTER),this.internal.getServiceRegistry().add(ZA.SESSION_PROPERTIES_EVENT_2,{onRequest:function(e,t,r){e.getConversationSet().respondIfPresent(t.cid,t),r.respond()}})}return e.prototype.close=function(e){var t=this;return new Ty.Promise(function(r,n){try{S_.requireNonNull(e,"sessions")}catch(e){return void n(e)}if(t.internal.checkConnected(n)){var o=uw.SessionId.validate(e);o?t.serviceLocator.obtain(ZA.CLOSE_CLIENT).send({sessionID:o},function(e,t){e?n(e):r(1)}):"string"==typeof e?t.serviceLocator.obtain(ZA.CLOSE_CLIENT_FILTER).send(e,function(e,t){tN.responseSuccess(e,t)?t.errors.length>0?n(t.errors):r(t.count):n(e)}):n(new Error("Invalid SessionID: "+e))}})},e.prototype.subscribe=function(e,t){var r=this;return new Ty.Promise(function(n,o){try{e=S_.requireNonNull(e,"SessionID or Session Filter"),t=S_.requireNonNull(t,"Topic Selector")}catch(e){return void o(e)}if(r.internal.checkConnected(o)){var i=void 0;try{i=im.parseSelector(t)}catch(e){return void o(e)}var s=uw.SessionId.validate(e);s?r.serviceLocator.obtain(ZA.SUBSCRIBE_CLIENT).send({sessionID:s,selector:i},function(e){e?o(e):n()}):r.serviceLocator.obtain(ZA.FILTER_SUBSCRIBE).send({filter:e,selector:i},function(e,t){tN.responseSuccess(e,t)?t.isSuccess()?n(t.selected):o(t.errors):o(e)})}})},e.prototype.unsubscribe=function(e,t){var r=this;return new Ty.Promise(function(n,o){try{S_.requireNonNull(e,"SessionID or Session Filter"),S_.requireNonNull(t,"Topic Selector")}catch(e){return void o(e)}if(r.internal.checkConnected(o)){var i=void 0;try{i=im.parseSelector(t)}catch(e){return void o(e)}var s=uw.SessionId.validate(e);s?r.serviceLocator.obtain(ZA.UNSUBSCRIBE_CLIENT).send({sessionID:s,selector:i},function(e){e?o(e):n()}):r.serviceLocator.obtain(ZA.FILTER_UNSUBSCRIBE).send({filter:e,selector:i},function(e,t){tN.responseSuccess(e,t)?t.isSuccess()?n(t.selected):o(t.errors):o(e)})}})},e.prototype.getSessionProperties=function(e,t){var r=this;return void 0===t&&(t=[]),new Ty.Promise(function(n,o){"string"==typeof e&&(e=uw.SessionId.fromString(e)),r.internal.checkConnected(o)&&r.GET_SESSION_PROPERTIES.send({sessionID:e,propertyKeys:t},function(e,t){tN.responseSuccess(e,t)?null===t?o(new Error("Invalid session ID")):n(t.properties):o(e)})})},e.prototype.setSessionProperties=function(e,t){var r=this;return new Ty.Promise(function(n,o){try{S_.requireNonNull(e,"sessionId"),S_.requireNonNull(t,"properties")}catch(e){return void o(e)}if("string"==typeof e&&(e=uw.SessionId.fromString(e)),r.internal.checkConnected(o)){var i={},s=[];r.extractOverwriteAndRemoveProperties(i,s,t),r.serviceLocator.obtain(ZA.SET_SESSION_PROPERTIES).send({sessionID:e,overwriteProperties:i,removeProperties:s},function(e,t){tN.responseSuccess(e,t)?n(t.properties):o(e)})}})},e.prototype.setOverwriteOrRemoveProperty=function(e,t,r,n){null===n?t.push(r):e[r]=n},e.prototype.extractOverwriteAndRemoveProperties=function(e,t,r){var n,o,i=this;if(r.forEach instanceof Function)r.forEach(function(r,n){i.setOverwriteOrRemoveProperty(e,t,r,n)});else try{for(var s=qL(Object.getOwnPropertyNames(r)),a=s.next();!a.done;a=s.next()){var u=a.value;this.setOverwriteOrRemoveProperty(e,t,u,r[u])}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},e.prototype.setSessionPropertiesByFilter=function(e,t){var r=this;return new Ty.Promise(function(n,o){try{S_.requireNonNull(e,"filter"),S_.requireNonNull(t,"properties")}catch(e){return void o(e)}if(r.internal.checkConnected(o)){var i={},s=[],a=new UL.SetSessionPropertiesFilterRequest(e,i,s);r.extractOverwriteAndRemoveProperties(i,s,t),r.SET_SESSION_PROPERTIES_FILTER.send(a,function(e,t){tN.responseSuccess(e,t)?t.errors.length>0?o(t.errors):n(t.count):o(e)})}})},e.prototype.setSessionPropertiesListener=function(e,t){var r=this;return new Ty.Promise(function(n,o){if(t||o(new Error("Session Properties listener is null or undefined")),r.internal.checkConnected(o)){GL.debug("Adding Session Properties Listener");var i={active:function(e){GL.debug("Session Properties Listener active"),t.onActive(e)},respond:function(e){var r,n;try{for(var o=qL(e.events),i=o.next();!i.done;i=o.next()){var s=i.value;switch(s.type){case Ag.SessionPropertiesEventType.OPEN:t.onSessionOpen(s.sessionId,s.oldProperties);break;case Ag.SessionPropertiesEventType.UPDATE:t.onSessionEvent(s.sessionId,s.updateType,s.newProperties,s.oldProperties);break;case Ag.SessionPropertiesEventType.CLOSE:t.onSessionClose(s.sessionId,s.oldProperties,s.closeReason);break;default:GL.debug("Unknown event type received for session properties listener",s.type)}}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1},close:function(e){GL.debug("Session Properties Listener closed"),e?t.onError(e):t.onClose()}},s=r.internal.getConversationSet(),a=s.newConversation(SL.responseHandler(r.internal,i,function(e,t){r.SESSION_PROPERTIES_REGISTRATION.send({cid:e},t)}));r.SESSION_PROPERTIES_REGISTRATION.send({cid:a,properties:e},SL.registrationCallback(s,a,n,o))}})},e.prototype.changeRoles=function(e,t,r){var n=this,o=Array.isArray(t)?t:FL(t),i=Array.isArray(r)?r:FL(r);if(0===o.length&&0===i.length)throw new Error("rolesToRemove and rolesToAdd cannot both be empty");var s=uw.SessionId.validate(e);return new Ty.Promise(function(t,r){try{S_.requireNonNull(e,"sessions")}catch(e){return void r(e)}if(n.internal.checkConnected(r))if(!1===s){var a=new CL.ChangeAuthorisationRolesFilterRequest(e,o,i);n.CHANGE_AUTHORISATION_ROLES_FILTER.send(a,function(e,n){e?r(e):n.errors.length>0?r(n.errors):t(n.count)})}else{a=new AL.ChangeAuthorisationRolesRequest(s,o,i);n.CHANGE_AUTHORISATION_ROLES.send(a,function(e){e?r(e):t(1)})}})},e.prototype.setConflated=function(e,t){var r=this;return new Ty.Promise(function(n,o){try{S_.requireNonNull(e,"sessions")}catch(e){return void o(e)}if(r.internal.checkConnected(o)){var i=uw.SessionId.validate(e);if(i){var s=new DL.SetClientConflationRequest(i,t);r.SET_CLIENT_CONFLATION.send(s,function(e){e?o(e):n(1)})}else if("string"==typeof e){s=new ML.SetClientConflationFilterRequest(e,t);r.SET_CLIENT_CONFLATION_FILTER.send(s,function(e,t){tN.responseSuccess(e,t)?t.errors.length>0?o(t.errors):n(t.count):o(e)})}else o(new Error("Invalid SessionID: "+e))}})},e}();kL.ClientControlImpl=HL;var WL={};Object.defineProperty(WL,"__esModule",{value:!0});var YL=function(){function e(e){this.internal=e,this.FETCH_LOG_ENTRIES_SERVICE=e.getServiceLocator().obtain(ZA.FETCH_LOG_ENTRIES_SERVICE)}return e.prototype.fetchEntries=function(e,t){var r=this;return new Ty.Promise(function(n,o){r.internal.checkConnected(o)&&r.FETCH_LOG_ENTRIES_SERVICE.send(new QO.EntriesFetchRequest(e,t),function(e,t){e?o(e):n(t)})})},e}();WL.LogRetrieval=YL;var zL={};Object.defineProperty(zL,"__esModule",{value:!0}),zL.create=function(e){return{onRequest:function(t,r,n){try{e(t,r,n)}catch(e){n.fail(av.ErrorReason.CALLBACK_EXCEPTION,e.message)}}}};var JL={};Object.defineProperty(JL,"__esModule",{value:!0});var $L=$y.create("Session.Messages"),KL=function(){return function(e,t,r){this.reqType=e,this.resType=t,this.stream=r}}(),QL=function(){function e(e,t){this.callback=e,this.responseType=t}return e.prototype.respond=function(e){if(0===arguments.length)throw new Error("No argument provided to the responder");if(null==e&&!this.responseType)throw new Error("No response type has been provided and the value provided is null. Unable to determine the response type.");var t=this.responseType?iE.DataTypes.getChecked(this.responseType):iE.DataTypes.getByValue(e);if(void 0===t)throw new Error("Unable to determine the response type.");var r=t.writeValue(e);this.callback.respond({responseDataType:t.name(),data:r})},e.prototype.reject=function(e){this.callback.fail(av.ErrorReason.REJECTED_REQUEST,e)},e}();var XL=function(){function e(e){var t=this;this.requestStreams={},this.internal=e;var r=e.getServiceLocator();this.MESSAGING_SEND=r.obtain(ZA.MESSAGING_SEND),this.MESSAGING_FILTER_SEND=r.obtain(ZA.MESSAGING_FILTER_SEND),this.MESSAGING_RECEIVER_SERVER=r.obtain(ZA.MESSAGING_RECEIVER_SERVER),this.deregisterRequestHandler=r.obtain(ZA.MESSAGING_RECEIVER_CONTROL_DEREGISTRATION);var n=e.getServiceRegistry();n.add(ZA.MESSAGING_SEND,zL.create(function(e,r,n){var o=t.requestStreams[r.path];if(void 0!==o){var i,s,a=new QL(n,o.resType),u=iE.DataTypes.get(r.dataType),c=o.reqType?o.reqType:u.valueClass;if(u.canReadAs(c)){var p=void 0;try{p=u.readAs(c,r.request)}catch(e){return $L.error("Failed to convert "+u.name()+" datatype to "+c),o.stream.onError(av.ErrorReason.INVALID_DATA),void delete t.requestStreams[r.path]}try{o.stream.onRequest(r.path,p,a)}catch(e){$L.error("Messaging request stream threw an error",e),n.fail(av.ErrorReason.CALLBACK_EXCEPTION,e.stack)}}else{var f="Messaging request for path "+r.path+" with "+u.name()+"datatype is incompatible for stream ("+c+")";$L.debug(f),n.fail(av.ErrorReason.INCOMPATIBLE_DATATYPE,f)}}else n.fail(av.ErrorReason.UNHANDLED_MESSAGE,(i=e.getSessionId(),s=r.path,"Session "+i+" has no registered streams for message sent to path '"+s+"'"))})),n.add(ZA.FILTER_RESPONSE,zL.create(function(e,t,r){r.respond(),e.getConversationSet().respondIfPresent(t.cid,t)})),n.add(ZA.MESSAGING_RECEIVER_CLIENT,zL.create(function(e,t,r){e.getConversationSet().respondIfPresent(t.cid,{request:t,callback:r.respond,fail:r.fail})}))}return e.prototype.addRequestHandler=function(e,t,r,n){var o=this;return new Ty.Promise(function(i,s){if(o.internal.checkConnected(s)){try{S_.requireNonNull(e,"Message path"),S_.requireNonNull(t,"Request handler")}catch(e){return void s(e)}$L.debug("Adding request handler",e);var a={definition:ZA.MESSAGING_RECEIVER_CLIENT,group:Uw.DEFAULT,path:e,keys:void 0!==r?r:[]},u={active:function(r,n){$L.debug("Request handler active",e),i({close:function(){return new Ty.Promise(function(e){o.deregisterRequestHandler.send(a,function(r,i){r?(o.internal.getConversationSet().discard(n,r),$L.debug("Error with request handler deregistration: ",r)):(t.onClose(),o.internal.getConversationSet().respondIfPresent(n,i)),e()})})}})},respond:function(r){$L.debug("Request handler pair.request",e);var o={sessionId:r.request.sessionID,path:r.request.path,properties:r.request.properties};try{var i=(n||iE.DataTypes.getChecked(r.request.dataType)).readValue(r.request.content),s={respond:function(e,t){var n=iE.DataTypes.getChecked(t?t.name():e);r.callback({responseDataType:n.name(),data:n.writeValue(e)})},reject:function(e){r.fail(av.ErrorReason.REJECTED_REQUEST,e)}};return t.onRequest(i,o,s),!1}catch(e){return $L.info("An exception has occurred whilst processing the request:",e),t.onError(e),r.fail(av.ErrorReason.CALLBACK_EXCEPTION,e&&e.message),!1}},close:function(){$L.debug("Request handler closed",e),t.onClose()}};SL.registerRequestHandler(o.internal,a,u).then(void 0,function(e){s(e)})}})},e.prototype.sendRequestToController=function(e,t,r,n,o,i){try{S_.requireNonNull(r,"Message path"),S_.requireNonNull(n,"Request")}catch(e){return void t(e)}var s;try{s=o?iE.DataTypes.getChecked(o):iE.DataTypes.getByValue(n)}catch(e){return void t(e)}if(void 0===s)throw new Error("Could not determine request type");$L.debug("Sending request to server",n),this.MESSAGING_SEND.send({path:r,dataType:s.name(),request:s.writeValue(n)},function(n,o){var s;if(tN.responseSuccess(n,o)){$L.debug("Request complete",r);try{s=iE.DataTypes.getChecked(i||o.responseDataType)}catch(e){return void t(e)}e(s.readValue(o.data))}else $L.debug("Request failed",r),t(n)})},e.prototype.sendRequestToSession=function(e,t,r,n,o,i,s){try{S_.requireNonNull(o,"Session ID"),S_.requireNonNull(r,"Message path"),S_.requireNonNull(n,"Request")}catch(e){return void t(e)}var a;try{a=i?iE.DataTypes.getChecked(i):iE.DataTypes.getByValue(n)}catch(e){return void t(e)}if(void 0===a)throw new Error("Could not determine request type");$L.debug("Sending request to session",o,n),this.MESSAGING_RECEIVER_SERVER.send({sessionId:o,path:r,dataType:a.name(),request:a.writeValue(n)},function(n,o){var i;if(tN.responseSuccess(n,o)){$L.debug("Request complete",r);try{i=iE.DataTypes.getChecked(s||o.responseDataType)}catch(e){return void t(e)}e(i.readValue(o.data))}else $L.debug("Request failed",r),t(n)})},e.prototype.sendRequest=function(e,t,r,n,o){var i=this;return new Ty.Promise(function(s,a){if(i.internal.checkConnected(a))if(r instanceof uw.SessionId)i.sendRequestToSession(s,a,e,t,r,n,o);else if("string"==typeof r){var u=function(e){try{return uw.SessionId.fromString(e)}catch(e){return!1}}(r);u?i.sendRequestToSession(s,a,e,t,u,n,o):i.sendRequestToController(s,a,e,t,r,n)}else i.sendRequestToController(s,a,e,t,r,n)})},e.prototype.sendRequestToFilter=function(e,t,r,n,o,i){var s=this;return new Ty.Promise(function(a,u){if(s.internal.checkConnected(u)){try{S_.requireNonNull(t,"Message path"),S_.requireNonNull(e,"Session filter"),S_.requireNonNull(r,"Request"),S_.requireNonNull(n,"Response callback")}catch(e){return void u(e)}var c=void 0;try{c=o?iE.DataTypes.getChecked(o):iE.DataTypes.getByValue(r)}catch(e){return void u(e)}if(void 0===c)throw new Error("Could not determine request type");var p=0,f=-1,l=function(){return p>=f&&-1!==f||0===f},h=s.internal.getConversationSet().newConversation({onOpen:function(){},onResponse:function(e,t){if(null===t)return!0;if("number"==typeof t)return f=t,l();var r=t.sessionID;if(p++,t.errorReason)n.onResponseError(r,t.errorReason);else{var o=iE.DataTypes.getByName(t.response.responseDataType),s=void 0;try{s=iE.DataTypes.getChecked(i||t.response.responseDataType)}catch(e){return u(e),l()}if(o.canReadAs(s.valueClass)){var a=void 0;try{a=o.readAs(s.valueClass,t.response.data)}catch(e){return n.onResponseError(r,e),l()}try{n.onResponse(r,a)}catch(e){$L.error("Exception within messaging filter callback",e)}}else n.onResponseError(r,new Error("The received response was a "+o+",'\n                                        + ' which cannot be read as: "+s))}return l()},onDiscard:function(e,t){n.onError(t)}});$L.debug("Sending filter request to server",r),s.MESSAGING_FILTER_SEND.send({cid:h,path:t,filter:e,dataType:c,request:c.writeValue(r)},function(e,r){tN.responseSuccess(e,r)?r.isSuccess?($L.debug("Request complete",t),s.internal.getConversationSet().respondIfPresent(h,r.numberSent),a(r.numberSent)):($L.debug("Request failed",t),s.internal.getConversationSet().respondIfPresent(h,null),u(r.errors)):($L.debug("Request failed",t),s.internal.getConversationSet().respondIfPresent(h,null),u(e))})}})},e.prototype.setRequestStream=function(e,t,r,n){var o=new KL(r?iE.DataTypes.getValueClassChecked(r):void 0,n?iE.DataTypes.getValueClassChecked(n):void 0,t),i=this.requestStreams[e];if(this.requestStreams[e]=o,i)return i.stream},e.prototype.removeRequestStream=function(e){var t=this.requestStreams[e];if(delete this.requestStreams[e],t)return t.stream},e}();JL.MessagesImpl=XL;var ZL={};Object.defineProperty(ZL,"__esModule",{value:!0});var eD=function(){function e(e){this.internal=e}return e.prototype.callService=function(e,t){var r=this;return new Ty.Promise(function(n,o){r.internal.checkConnected(o)&&r.internal.getServiceLocator().obtain(e).send(t,function(e,t){e?o(e):n(null===t?void 0:t)})})},e.prototype.putSessionMetricCollector=function(e){return this.callService(ZA.PUT_SESSION_METRIC_COLLECTOR,e)},e.prototype.removeSessionMetricCollector=function(e){return this.callService(ZA.REMOVE_SESSION_METRIC_COLLECTOR,e)},e.prototype.fetchSessionMetricCollectors=function(){return this.callService(ZA.FETCH_SESSION_METRIC_COLLECTORS,null)},e.prototype.putTopicMetricCollector=function(e){return this.callService(ZA.PUT_TOPIC_METRIC_COLLECTOR,e)},e.prototype.removeTopicMetricCollector=function(e){return this.callService(ZA.REMOVE_TOPIC_METRIC_COLLECTOR,e)},e.prototype.fetchTopicMetricCollectors=function(){return this.callService(ZA.FETCH_TOPIC_METRIC_COLLECTORS,null)},e.prototype.getServerMetrics=function(){return this.callService(ZA.GET_SERVER_METRICS,null)},e.prototype.getMeasuredEntityClassMetrics=function(e){return this.callService(ZA.GET_MEASURED_ENTITY_CLASS_METRICS,e)},e.prototype.fetchJMXValues=function(e){return this.callService(ZA.FETCH_JMX_VALUES,new OO.JMXObjectNames(e))},e}();ZL.Metrics=eD;var tD={};Object.defineProperty(tD,"__esModule",{value:!0});var rD=function(){function e(e,t){void 0===t&&(t=Date.now),this.currentTime=Date.now,this.internal=e,this.currentTime=t,this.ping=e.getServiceLocator().obtain(ZA.USER_PING)}return e.prototype.pingServer=function(){var e=this;return new Ty.Promise(function(t,r){if(e.internal.checkConnected(r)){var n=e.currentTime();e.ping.send(null,function(o){if(o)r(o);else{var i=e.currentTime()-n;t({timestamp:n,rtt:i})}})}})},e}();tD.PingImpl=rD;var nD={};Object.defineProperty(nD,"__esModule",{value:!0});var oD=function(){return function(e,t,r,n,o){this.name=e,this.url=t,this.principal=r,this.credentials=n,this.connectionOptions=o}}();nD.RemoteServerDefinition=oD;var iD={};Object.defineProperty(iD,"__esModule",{value:!0});var sD=$y.create("RemoteServers"),aD=function(){function e(e){this.internal=e;var t=e.getServiceLocator();this.CREATE_REMOTE_SERVER=t.obtain(ZA.CREATE_REMOTE_SERVER),this.LIST_REMOTE_SERVERS=t.obtain(ZA.LIST_REMOTE_SERVERS),this.CHECK_REMOTE_SERVER=t.obtain(ZA.CHECK_REMOTE_SERVER),this.REMOVE_REMOTE_SERVER=t.obtain(ZA.REMOVE_REMOTE_SERVER)}return e.prototype.createRemoteServer=function(e,t,r,n,o){var i=this;return new Ty.Promise(function(s,a){if(0===S_.requireNonNull(e,"name").length)throw new Error("Remote server name cannot be empty");if(i.internal.checkConnected(a)){var u=new nD.RemoteServerDefinition(e,S_.requireNonNull(t,"url"),S_.requireNonNull(r,"url"),S_.requireNonNull(n,"credentials"),o||{});i.CREATE_REMOTE_SERVER.send(u,function(e,t){tN.responseSuccess(e,t)?t.errors?(a(t.errors.errors),sD.debug("Create remote server failed")):s(t.server):(a(e),sD.debug("Create remote server failed"))})}})},e.prototype.checkRemoteServer=function(e){var t=this;return new Ty.Promise(function(r,n){t.internal.checkConnected(n)&&t.CHECK_REMOTE_SERVER.send(S_.requireNonNull(e,"name"),function(e,t){e?(n(e),sD.debug("Check remote server failed")):r(t.status)})})},e.prototype.listRemoteServers=function(){var e=this;return new Ty.Promise(function(t,r){e.internal.checkConnected(r)&&e.LIST_REMOTE_SERVERS.send(null,function(e,n){tN.responseSuccess(e,n)?t(n.result):(r(e),sD.debug("List remote servers failed"))})})},e.prototype.removeRemoteServer=function(e){var t=this;return new Ty.Promise(function(r,n){t.internal.checkConnected(n)&&t.REMOVE_REMOTE_SERVER.send(S_.requireNonNull(e,"name"),function(e){e?(n(e),sD.debug("Remove remote server failed")):r()})})},e}();iD.RemoteServersImpl=aD;var uD={};(function(e){"use strict";Object.defineProperty(uD,"__esModule",{value:!0});var t=function(){function t(e){this.LICENCE_UPDATE=e.getServiceLocator().obtain(ZA.UPDATE_LICENSE)}return t.prototype.updateLicence=function(t){var r=this,n=e.from(t);return new Promise(function(e,t){r.LICENCE_UPDATE.send(n,function(r,n){r?t(r):e(n)})})},t}();uD.LicenceUpdater=t}).call(this,r({}).Buffer);var cD={},pD=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};function fD(e){var t,r,n="";if(e.indexOf("'")<0&&e.indexOf("\\")<0)n+=e;else try{for(var o=pD(e),i=o.next();!i.done;i=o.next()){var s=i.value;"'"!==s&&"\\"!==s||(n+="\\"),n+=s}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return"'"+n+"'"}Object.defineProperty(cD,"__esModule",{value:!0}),cD.quoteAndEscape=fD,cD.setToString=function(e){return"["+e.map(fD).join(" ")+"]"},cD.permissionsToString=function(e){return"["+e.join(" ")+"]"};var lD={};Object.defineProperty(lD,"__esModule",{value:!0});var hD=function(){function e(){this.commands="",this.setDefaultTopicPermissions=this.setDefaultPathPermissions.bind(this)}return e.prototype.maybeApppendNewLine=function(){this.commands.length>0&&(this.commands+="\n")},e.prototype.build=function(){return this.commands},e.prototype.toString=function(){return"ConfigurationScriptBuilder ["+this.commands+"]"},e.prototype.setRolesForAnonymousSessions=function(e){var t=S_.requireNonNull(e,"roles");return this.maybeApppendNewLine(),this.commands+="set roles for anonymous sessions ",this.commands+=cD.setToString(t),this},e.prototype.setRolesForNamedSessions=function(e){var t=S_.requireNonNull(e,"roles");return this.maybeApppendNewLine(),this.commands+="set roles for named sessions ",this.commands+=cD.setToString(t),this},e.prototype.setGlobalPermissions=function(e,t){var r=S_.requireNonNull(e,"role"),n=S_.requireNonNull(t,"permissions");return this.maybeApppendNewLine(),this.commands+="set "+cD.quoteAndEscape(r)+" permissions ",this.commands+=cD.permissionsToString(n),this},e.prototype.setDefaultPathPermissions=function(e,t){var r=S_.requireNonNull(e,"role"),n=S_.requireNonNull(t,"permissions");return this.maybeApppendNewLine(),this.commands+="set "+cD.quoteAndEscape(r)+" default path permissions ",this.commands+=cD.permissionsToString(n),this},e.prototype.removeTopicPermissions=function(e,t){return this.removePathPermissions(e,t)},e.prototype.removePathPermissions=function(e,t){var r=S_.requireNonNull(e,"role"),n=S_.requireNonNull(t,"path");return this.maybeApppendNewLine(),this.commands+="remove "+cD.quoteAndEscape(r)+" permissions for path "+cD.quoteAndEscape(n),this},e.prototype.setTopicPermissions=function(e,t,r){return this.setPathPermissions(e,t,r)},e.prototype.setPathPermissions=function(e,t,r){var n=S_.requireNonNull(e,"role"),o=S_.requireNonNull(t,"path"),i=S_.requireNonNull(r,"permissions");return this.maybeApppendNewLine(),this.commands+="set "+cD.quoteAndEscape(n)+" path "+cD.quoteAndEscape(o)+" permissions ",this.commands+=cD.permissionsToString(i),this},e.prototype.setRoleIncludes=function(e,t){var r=S_.requireNonNull(e,"role"),n=S_.requireNonNull(t,"includedRoles");return this.maybeApppendNewLine(),this.commands+="set "+cD.quoteAndEscape(r)+" includes ",this.commands+=cD.setToString(n),this},e.prototype.setRoleLockedByPrincipal=function(e,t){var r=S_.requireNonNull(e,"role"),n=S_.requireNonNull(t,"lockingPrincipal");return this.maybeApppendNewLine(),this.commands+="set role "+cD.quoteAndEscape(r)+" locked by principal "+cD.quoteAndEscape(n),this},e.prototype.isolatePath=function(e){var t=S_.requireNonNull(e,"path");return this.maybeApppendNewLine(),this.commands+="isolate path "+cD.quoteAndEscape(t),this},e.prototype.deisolatePath=function(e){var t=S_.requireNonNull(e,"path");return this.maybeApppendNewLine(),this.commands+="deisolate path "+cD.quoteAndEscape(t),this},e}();lD.SecurityScriptBuilderImpl=hD;var dD={};Object.defineProperty(dD,"__esModule",{value:!0});var yD=function(){function e(){this.commands=""}return e.prototype.maybeApppendNewLine=function(){this.commands.length>0&&(this.commands+="\n")},e.prototype.build=function(){return this.commands},e.prototype.toString=function(){return"SystemAuthenticationScriptBuilder ["+this.commands+"]"},e.prototype.assignRoles=function(e,t){var r=S_.requireNonNull(t,"roles"),n=S_.requireNonNull(e,"principal");return this.maybeApppendNewLine(),this.commands+="assign roles "+cD.quoteAndEscape(n)+" ",this.commands+=cD.setToString(r),this},e.prototype.addPrincipal=function(e,t,r,n){void 0===r&&(r=[]);var o=S_.requireNonNull(r,"roles"),i=S_.requireNonNull(e,"principal"),s=S_.requireNonNull(t,"password");return this.maybeApppendNewLine(),this.commands+="add principal "+cD.quoteAndEscape(i)+" "+cD.quoteAndEscape(s),o.length&&(this.commands+=" ",this.commands+=cD.setToString(o)),n&&(this.commands+=" locked by "+cD.quoteAndEscape(n)),this},e.prototype.setPassword=function(e,t){var r=S_.requireNonNull(e,"principal"),n=S_.requireNonNull(t,"password");return this.maybeApppendNewLine(),this.commands+="set password "+cD.quoteAndEscape(r)+" "+cD.quoteAndEscape(n),this},e.prototype.verifyPassword=function(e,t){var r=S_.requireNonNull(e,"principal"),n=S_.requireNonNull(t,"password");return this.maybeApppendNewLine(),this.commands+="verify password "+cD.quoteAndEscape(r)+" "+cD.quoteAndEscape(n),this},e.prototype.removePrincipal=function(e){var t=S_.requireNonNull(e,"principal");return this.maybeApppendNewLine(),this.commands+="remove principal "+cD.quoteAndEscape(t),this},e.prototype.allowAnonymousConnections=function(e){var t=S_.requireNonNull(e,"roles");return this.maybeApppendNewLine(),this.commands+="allow anonymous connections"+(e?" ":""),this.commands+=cD.setToString(t),this},e.prototype.denyAnonymousConnections=function(){return this.maybeApppendNewLine(),this.commands+="deny anonymous connections",this},e.prototype.abstainAnonymousConnections=function(){return this.maybeApppendNewLine(),this.commands+="abstain anonymous connections",this},e.prototype.trustClientProposedPropertyIn=function(e,t){var r=S_.requireNonNull(e,"propertyName"),n=S_.requireNonNull(t,"allowedValues");return this.maybeApppendNewLine(),this.commands+="trust client proposed property "+cD.quoteAndEscape(r)+" if value in ",this.commands+=cD.setToString(n),this},e.prototype.trustClientProposedPropertyMatches=function(e,t){var r=S_.requireNonNull(e,"propertyName"),n=S_.requireNonNull(t,"regex");return this.maybeApppendNewLine(),this.commands+="trust client proposed property "+cD.quoteAndEscape(r)+" if value matches "+cD.quoteAndEscape(n),this},e.prototype.ignoreClientProposedProperty=function(e){var t=S_.requireNonNull(e,"propertyName");return this.maybeApppendNewLine(),this.commands+="ignore client proposed property "+cD.quoteAndEscape(t),this},e}();dD.SystemAuthenticationScriptBuilderImpl=yD;var vD={},_D=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(vD,"__esModule",{value:!0});var SD=$y.create("Session.Security"),ED=function(){function e(e){this.GlobalPermission=Tm.GlobalPermission,this.PathPermission=Tm.PathPermission,this.TopicPermission=Tm.PathPermission,this.internal=e;var t=e.getServiceLocator();this.CHANGE_PRINCIPAL=t.obtain(ZA.CHANGE_PRINCIPAL),this.GET_SECURITY_CONFIGURATION=t.obtain(ZA.GET_SECURITY_CONFIGURATION),this.GET_SYSTEM_AUTHENTICATION=t.obtain(ZA.GET_SYSTEM_AUTHENTICATION),this.UPDATE_SECURITY_CONFIGURATION=t.obtain(ZA.UPDATE_SECURITY_CONFIGURATION),this.UPDATE_SYSTEM_AUTHENTICATION=t.obtain(ZA.UPDATE_SYSTEM_AUTHENTICATION),this.AUTHENTICATOR_DEREGISTRATION=t.obtain(ZA.AUTHENTICATOR_DEREGISTRATION),this.LIST_GLOBAL_PERMISSIONS=t.obtain(ZA.LIST_GLOBAL_PERMISSIONS),this.LIST_PATH_PERMISSIONS=t.obtain(ZA.LIST_PATH_PERMISSIONS),e.getServiceRegistry().add(ZA.AUTHENTICATION,zL.create(function(e,t,r){e.getConversationSet().respondIfPresent(t.cid,{req:t,callback:r})})),e.getServiceRegistry().add(ZA.AUTHENTICATOR,zL.create(function(e,t,r){e.getConversationSet().respondIfPresent(t.cid,{req:t,callback:r})}))}return e.prototype.getPrincipal=function(){return this.internal.getPrincipal()},e.prototype.changePrincipal=function(e,t){var r=this;return new Ty.Promise(function(n,o){r.internal.checkConnected(o)&&(SD.debug("Changing principal",e),r.CHANGE_PRINCIPAL.send({principal:e,credentials:t},function(t,i){t?o(t):i?(r.internal.setPrincipal(e),n()):o(new Error("Unable to change principal due to authentication failure"))}))})},e.prototype.getSecurityConfiguration=function(){var e=this;return new Ty.Promise(function(t,r){e.internal.checkConnected(r)&&(SD.debug("Getting security configuration"),e.GET_SECURITY_CONFIGURATION.send(null,function(e,n){e?r(e):t(n)}))})},e.prototype.getSystemAuthenticationConfiguration=function(){var e=this;return new Ty.Promise(function(t,r){e.internal.checkConnected(r)&&(SD.debug("Getting system authentication"),e.GET_SYSTEM_AUTHENTICATION.send(null,function(e,n){e?r(e):t(n)}))})},e.prototype.setAuthenticationHandler=function(e,t,r){var n=this;return new Ty.Promise(function(o,i){if(n.internal.checkConnected(i)){SD.debug('Setting Authentication Handler for "'+e+'"');var s={active:function(t){SD.debug('Authentication Handler active for "'+e+'"'),r.onActive(t),o()},respond:function(e){var t=e.req,n=e.callback;try{r.onAuthenticate(t.principal,t.credentials,t.details,{allow:function(e){n.respond(e?XI.allow(e):XI.ALLOW)},abstain:function(){n.respond(XI.ABSTAIN)},deny:function(){n.respond(XI.DENY)}})}catch(e){throw r.onError(e),n.fail(av.ErrorReason.CALLBACK_EXCEPTION,e&&e.message),e}return!1},close:function(t){t?(SD.debug("'Authentication Handler closed with error for \""+e+"\"'"),r.onError(t)):(SD.debug("'Authentication Handler closed for \""+e+"\"'"),r.onClose())}},a={definition:ZA.AUTHENTICATION,group:Uw.DEFAULT,details:t,name:e};return SL.registerHandler(n.internal,a,s,ZA.AUTHENTICATION_CONTROL_REGISTRATION,ZA.AUTHENTICATION_CONTROL_DEREGISTRATION)}})},e.prototype.setAuthenticator=function(e,t){var r=this;return new Ty.Promise(function(n,o){if(r.internal.checkConnected(o)){try{S_.requireNonNull(e,"handlerName"),S_.requireNonNull(t,"authenticator")}catch(e){return void o(e)}"function"==typeof t.authenticate&&"function"==typeof t.onError&&"function"==typeof t.onClose||o(new Error("authenticator does not implement the Authenticator interface")),SD.debug("Adding authenticator",e);var i={name:e,definition:ZA.AUTHENTICATOR,group:Uw.DEFAULT},s={active:function(o,s){SD.debug("Authenticator active",e),n({close:function(){return new Ty.Promise(function(e){r.AUTHENTICATOR_DEREGISTRATION.send(i,function(n,o){n?(r.internal.getConversationSet().discard(s,n),SD.debug("Error with authenticator deregistration: ",n)):(r.internal.getConversationSet().respondIfPresent(s,o),t.onClose()),e()})})}})},respond:function(e){var r=e.req,n=e.callback;try{t.authenticate(r.principal,r.credentials,r.sessionProperties,r.proposedProperties,{allow:function(e){var t,o;if(e){e=Ty.Object.assign({},e);try{for(var i=_D(Ty.Object.getOwnPropertyNames(r.sessionProperties)),s=i.next();!s.done;s=i.next()){var a=s.value;e[a]===r.sessionProperties[a]&&delete e[a]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}}n.respond(new mR.AuthenticatorResponse(mR.TypeCode.ALLOW,e))},abstain:function(){n.respond(mR.ABSTAIN)},deny:function(){n.respond(mR.DENY)}})}catch(e){throw t.onError(e),n.fail(av.ErrorReason.CALLBACK_EXCEPTION,e&&e.message),e}return!1},close:function(r){r?(SD.debug("'Authenticator closed with error for \""+e+"\"'"),t.onError(r)):(SD.debug("'Authentication Handler closed for \""+e+"\"'"),t.onClose())}};SL.registerHandler(r.internal,i,s,ZA.AUTHENTICATOR_REGISTRATION,ZA.AUTHENTICATOR_DEREGISTRATION).then(void 0,function(e){o(e)})}})},e.prototype.updateStoreCallback=function(e,t,r,n){e?n(e):t.errors.length>0?n(t.errors):r()},e.prototype.updateStore=function(e,t){var r=this;return new Ty.Promise(function(n,o){""===t?n():t&&"string"==typeof t?r.internal.checkConnected(o)&&e.send(new ym.SecurityCommandScript(t),function(e,t){r.updateStoreCallback(e,t,n,o)}):o(new Error("Invalid argument for script: "+t))})},e.prototype.updateSecurityStore=function(e){return SD.debug("Updating security store"),this.updateStore(this.UPDATE_SECURITY_CONFIGURATION,e)},e.prototype.updateAuthenticationStore=function(e){return SD.debug("Updating authentication store"),this.updateStore(this.UPDATE_SYSTEM_AUTHENTICATION,e)},e.prototype.securityScriptBuilder=function(){return new lD.SecurityScriptBuilderImpl},e.prototype.authenticationScriptBuilder=function(){return new dD.SystemAuthenticationScriptBuilderImpl},e.prototype.getGlobalPermissions=function(){var e=this;return new Ty.Promise(function(t,r){e.internal.checkConnected(r)&&(SD.debug("Getting global permissions"),e.LIST_GLOBAL_PERMISSIONS.send(null,function(e,n){e?r(e):t(n.permissions)}))})},e.prototype.getPathPermissions=function(e){var t=this;return new Ty.Promise(function(r,n){t.internal.checkConnected(n)&&(SD.debug("Getting path permissions"),t.LIST_PATH_PERMISSIONS.send(e,function(e,t){e?n(e):r(t.permissions)}))})},e.prototype.getTopicPermissions=function(e){var t=this;return new Ty.Promise(function(r,n){t.internal.checkConnected(n)&&(SD.debug("Getting path permissions"),t.LIST_PATH_PERMISSIONS.send(e,function(e,t){e?n(e):r(t.permissions)}))})},e}();vD.SecurityImpl=ED;var mD={};function wD(e,t){return e.withViewRange(t(e.viewRange))}function gD(e,t){return e.withEditRange(t(e.editRange))}Object.defineProperty(mD,"__esModule",{value:!0});var OD=function(){function e(e,t,r,n){this.context=e,this.valueType=t,this.parameters=r,this.mode=n}return e.prototype.withCurrentRange=function(t){return new e(this.context,this.valueType,this.mode(this.parameters,t),this.mode)},e.prototype.selectFrom=function(e){var t=this;return new Ty.Promise(function(r,n){if(e){var o={topicPath:e,parameters:t.parameters};t.context.send(o,function(e,o){tN.responseSuccess(e,o)?r(o.createQueryResult(t.valueType,t.parameters.queryType.streamStructure)):n(e)})}else n(new Error("Topic path is null"))})},e.prototype.forValues=function(){return new e(this.context,this.valueType,this.parameters.withQueryType(ab.QueryTypes.VALUES).withViewRange(ib.DEFAULT_RANGE),wD)},e.prototype.forEdits=function(){return new e(this.context,this.valueType,this.parameters.withQueryType(ab.QueryTypes.ALL_EDITS).withViewRange(ib.DEFAULT_RANGE),wD)},e.prototype.editRange=function(){if(this.parameters.queryType!==ab.QueryTypes.VALUES)throw new Error(".editRange() cannot be applied to this edit range query");return new e(this.context,this.valueType,this.parameters,gD)},e.prototype.allEdits=function(){if(this.parameters.queryType===ab.QueryTypes.VALUES)throw new Error(".allEdits() cannot be applied to this value range query");return new e(this.context,this.valueType,this.parameters.withQueryType(ab.QueryTypes.ALL_EDITS),gD)},e.prototype.latestEdits=function(){if(this.parameters.queryType===ab.QueryTypes.VALUES)throw new Error(".latestEdits() cannot be applied to this value range query");return new e(this.context,this.valueType,this.parameters.withQueryType(ab.QueryTypes.LATEST_EDITS),gD)},e.prototype.limit=function(t){return new e(this.context,this.valueType,this.parameters.withLimit(t),this.mode)},e.prototype.as=function(t){if(t&&t.valueClass)return new e(this.context,t.valueClass,this.parameters,this.mode);if(t instanceof Function)return new e(this.context,t,this.parameters,this.mode);throw new Error("Invalid value type: "+t)},e.prototype.from=function(e){return this.withCurrentRange(function(t){return t.from(e)})},e.prototype.fromStart=function(){return this.withCurrentRange(function(e){return e.fromStart()})},e.prototype.fromLast=function(e){return this.withCurrentRange(function(t){return t.fromLast(e)})},e.prototype.fromLastMillis=function(e){return this.withCurrentRange(function(t){return t.fromLastMillis(e)})},e.prototype.to=function(e){return this.withCurrentRange(function(t){return t.to(e)})},e.prototype.toStart=function(){return this.withCurrentRange(function(e){return e.toStart()})},e.prototype.untilLast=function(e){return this.withCurrentRange(function(t){return t.untilLast(e)})},e.prototype.untilLastMillis=function(e){return this.withCurrentRange(function(t){return t.untilLastMillis(e)})},e.prototype.next=function(e){return this.withCurrentRange(function(t){return t.next(e)})},e.prototype.nextMillis=function(e){return this.withCurrentRange(function(t){return t.nextMillis(e)})},e.prototype.previous=function(e){return this.withCurrentRange(function(t){return t.previous(e)})},e.prototype.previousMillis=function(e){return this.withCurrentRange(function(t){return t.previousMillis(e)})},e.createDefault=function(t){return new e(t,e_.BytesImpl,ab.DEFAULT_RANGE_QUERY,wD)},e.prototype.equals=function(t){return!!(t&&t instanceof e)&&this.parameters.equals(t.parameters)},e.prototype.toString=function(){return this.parameters.toString()},e}();mD.RangeQueryImpl=OD;var TD={};Object.defineProperty(TD,"__esModule",{value:!0});var ID=function(){function e(e){var t=e.getServiceLocator();this.defaultRangeQuery=mD.RangeQueryImpl.createDefault(t.obtain(ZA.RANGE_QUERY)),this.appendService=t.obtain(ZA.TIME_SERIES_APPEND),this.editService=t.obtain(ZA.TIME_SERIES_EDIT)}return e.prototype.rangeQuery=function(){return this.defaultRangeQuery},e.prototype.edit=function(e,t,r,n){var o=this;return new Ty.Promise(function(i,s){var a;try{a=n instanceof n_.AbstractDataType?n:n?iE.DataTypes.getByClass(n):iE.DataTypes.getByValue(r),S_.requireNonNull(e,"Path"),S_.requireNonNull(r,"Value"),S_.requireNonNull(t,"Sequence"),a=S_.requireNonNull(a,"Data type")}catch(e){return void s(e)}o.editService.send({path:e,sequence:t,dataType:a,value:a.writeValue(r)},function(e,t){e?s(e):i(t)})})},e.prototype.append=function(e,t,r){var n=this;return new Ty.Promise(function(o,i){var s;try{s=r instanceof n_.AbstractDataType?r:r?iE.DataTypes.getByClass(r):iE.DataTypes.getByValue(t),S_.requireNonNull(e,"Path"),S_.requireNonNull(t,"Value"),s=S_.requireNonNull(s,"Data type")}catch(e){return void i(e)}n.appendService.send({path:e,value:s.writeValue(t),dataType:s},function(e,t){e?i(e):o(t)})})},e}();TD.TimeSeriesImpl=ID;var RD={};Object.defineProperty(RD,"__esModule",{value:!0});var bD=function(){function e(e){this.SET_SERVICE=e.getServiceLocator().obtain(ZA.UPDATE_TOPIC_SET)}return e.prototype.dataToBytes=function(e){return e.$buffer.slice(e.$offset,e.$length)},e.prototype.update=function(e,t,r){var n=iE.DataTypes.get(t);if(n){var o=n.from(t);this.SET_SERVICE.send({path:e,bytes:this.dataToBytes(o)},r)}else r(FP.UpdateFailReasonEnum.INCOMPATIBLE_UPDATE)},e.prototype.updateValue=function(e,t,r,n){var o=iE.DataTypes.getChecked(r).from(t);this.SET_SERVICE.send({path:e,bytes:this.dataToBytes(o)},n)},e}();RD.UniversalUpdater=bD;var CD={},PD=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(CD,"__esModule",{value:!0});var AD=function(){function e(){this.cache={}}return e.prototype.get=function(e){return this.cache[VE.canonicalise(e)]},e.prototype.put=function(e,t){this.cache[VE.canonicalise(e)]=t},e.prototype.remove=function(e){var t,r;try{for(var n=PD(Object.getOwnPropertyNames(this.cache)),o=n.next();!o.done;o=n.next()){var i=o.value;e.selects(i)&&delete this.cache[i]}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e}();CD.ValueCache=AD;var ND={};function MD(e){return e.$buffer.slice(e.$offset,e.$length)}function LD(e,t){var r=im.parseSelector("?"+VE.canonicalise(t)+"//");e.remove(r)}Object.defineProperty(ND,"__esModule",{value:!0});var DD=function(){function e(e,t){this.isClosed=!1,this.cid=e,this.dispatch=t}return e.prototype.internalUpdate=function(e,t,r){var n=this;return new Ty.Promise(function(o,i){n.isClosed?i(new Error("Updater is closed")):e?null==t?i(new Error("Update cannot be null")):n.dispatch(o,i,n.cid,e,t,r):i(new Error("Topic can not be null or empty"))})},e.prototype.update=function(e,t){return this.internalUpdate(e,t,function(e){return iE.DataTypes.get(e)})},e.prototype.updateValue=function(e,t,r){return this.internalUpdate(e,t,function(){return r})},e}(),jD=function(){function e(e,t,r,n){this.state=EA.UpdateSourceState.INIT,this.internal=e,this.valueCache=t,this.topic=r,this.handler=n,this.UPDATE_SOURCE_DEREGISTRATION=e.getServiceLocator().obtain(ZA.UPDATE_SOURCE_DEREGISTRATION),this.UPDATE_SOURCE_DELTA=e.getServiceLocator().obtain(ZA.UPDATE_SOURCE_DELTA),this.UPDATE_SOURCE_SET=e.getServiceLocator().obtain(ZA.UPDATE_SOURCE_SET)}return e.prototype.dispatch=function(e,t,r,n,o,i){var s=function(r,o){r?t(r):o&&o.error?t(new Error("Topic update error for topic "+n+" : "+o.error)):e()};if(this.internal.checkConnected(t)){var a=i(o);if(!a)return void t(FP.UpdateFailReasonEnum.INCOMPATIBLE_UPDATE);var u=a.from(o),c=this.valueCache.get(n);if(c){var p=a.deltaType("binary"),f=p.diff(c,u);if(f===p.noChange())return void s(null);this.UPDATE_SOURCE_DELTA.send({id:0,cid:r,path:n,bytes:MD(f)},s)}else this.UPDATE_SOURCE_SET.send({cid:r,path:n,bytes:MD(u)},s);this.valueCache.put(n,u)}},e.prototype.onOpen=function(e){var t=this;this.close=function(){return new Ty.Promise(function(r,n){t.UPDATE_SOURCE_DEREGISTRATION.send({cid:e},function(o){o?(t.internal.getConversationSet().discard(e,o),n(o)):(t.internal.getConversationSet().respond(e,{old:t.state,current:EA.UpdateSourceState.CLOSED}),r())})})}},e.prototype.onResponse=function(e,t){if(t.old!==this.state)return this.internal.getConversationSet().discard(e,new Error("Inconsistent server/client update source state. Current: "+this.state+", expected: "+t.old)),!1;switch(this.state===EA.UpdateSourceState.INIT&&t.current!==EA.UpdateSourceState.CLOSED&&this.handler.onRegister(this.topic,this.close),this.updater&&(this.updater.isClosed=!0),this.state=t.current,this.state){case EA.UpdateSourceState.ACTIVE:return this.updater=new DD(e,this.dispatch.bind(this)),LD(this.valueCache,this.topic),this.handler.onActive(this.topic,this.updater),!1;case EA.UpdateSourceState.STANDBY:return this.handler.onStandBy(this.topic),!1;default:return LD(this.valueCache,this.topic),this.handler.onClose(this.topic),!0}},e.prototype.onDiscard=function(e,t){this.state=EA.UpdateSourceState.CLOSED,this.updater&&(this.updater.isClosed=!0),LD(this.valueCache,this.topic),t instanceof sM.CloseReasonImpl?this.handler.onClose(this.topic):this.handler.onClose(this.topic,t)},e}();ND.UpdateResponseHandler=jD;var UD={};Object.defineProperty(UD,"__esModule",{value:!0});var xD=$y.create("Session.Topics"),BD={103:FP.TopicAddFailReasonEnum.PERMISSIONS_FAILURE,110:FP.TopicAddFailReasonEnum.CLUSTER_REPARTITION,9004:FP.TopicAddFailReasonEnum.EXISTS_MISMATCH,9005:FP.TopicAddFailReasonEnum.INVALID_NAME,9006:FP.TopicAddFailReasonEnum.INVALID_DETAILS,9007:FP.TopicAddFailReasonEnum.EXCEEDED_LICENSE_LIMIT,9008:FP.TopicAddFailReasonEnum.INCOMPATIBLE_PARENT,9009:FP.TopicAddFailReasonEnum.INCOMPATIBLE_MASTER,9010:FP.TopicAddFailReasonEnum.EXISTS_INCOMPATIBLE,9011:FP.TopicAddFailReasonEnum.UNEXPECTED_ERROR},kD=function(){function e(e){this.internal=e;var t=e.getServiceLocator();this.TOPIC_ADD_SERVICE=t.obtain(ZA.TOPIC_ADD),this.TOPIC_REMOVAL=t.obtain(ZA.TOPIC_REMOVAL),this.TOPIC_WILL_REGISTRATION=t.obtain(ZA.TOPIC_SCOPED_WILL_REGISTRATION),this.TOPIC_WILL_DEREGISTRATION=t.obtain(ZA.TOPIC_SCOPED_WILL_DEREGISTRATION),this.UPDATE_SOURCE_REGISTRATION=t.obtain(ZA.UPDATE_SOURCE_REGISTRATION),this.valueCache=new CD.ValueCache,this.universalUpdater=new RD.UniversalUpdater(e);var r=e.getServiceRegistry();r.add(ZA.UPDATE_SOURCE_STATE,zL.create(function(e,t,r){r.respond(),e.getConversationSet().respondIfPresent(t.cid,{old:t.old,current:t.current})})),r.add(ZA.MISSING_TOPIC,zL.create(function(e,t,r){e.getConversationSet().respondIfPresent(t.cid,{request:t,callback:r})}))}return e.prototype.isSupportedTopicType=function(e){return Object.keys(nE.TopicTypeEnum).some(function(t){return nE.TopicTypeEnum[t]===e})},e.prototype.add=function(e,t){var r=this;return new Ty.Promise(function(n,o){if(e){if(r.internal.checkConnected(o)){xD.debug("Adding topic",e);var i=r.isSupportedTopicType(t)?new CE.TopicSpecification(t):t;if(!(i instanceof CE.TopicSpecification))throw new Error("Invalid topic specification or type");r.TOPIC_ADD_SERVICE.send({path:e,specification:i},function(t,i){t?o(BD[t.id]):(r.valueCache.put(e,void 0),n({topic:e,added:i.status===Hb.TopicAddResponseStatus.OK}))})}}else o({id:0,reason:"Path cannot be empty or null"})})},e.prototype.remove=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=arguments;return new Ty.Promise(function(r,n){if(t.internal.checkConnected(n)){xD.debug("Removing topics",e);try{t.TOPIC_REMOVAL.send({selector:o.length>1?im.parseSelector(Array.prototype.slice.call(o)):im.parseSelector(e)},function(t){t?(xD.debug("Topic removal failed",e),n(t)):(xD.debug("Topic removal complete",e),r())})}catch(t){xD.debug("Error parsing selector",e),n(t)}}})},e.prototype.removeWithSession=function(e){var t=this;return new Ty.Promise(function(r,n){if(t.internal.checkConnected(n)){xD.debug("Registering removeWithSession",e);var o=new GA.TopicWillParameters(e,GA.Will.REMOVE_TOPICS);t.TOPIC_WILL_REGISTRATION.send(o,function(i,s){if(tN.responseSuccess(i,s))if(s.result===JA.WillRegistrationResultEnum.SUCCESS){xD.debug("removeWithSession registration complete",e);var a=!0;r({deregister:function(){return new Ty.Promise(function(r,n){a&&t.internal.checkConnected(n)&&(xD.debug("Deregistering removeWithSession",e),t.TOPIC_WILL_DEREGISTRATION.send(o,function(t){t?n(t):(a=!1,r({topic:e}))}))})}})}else xD.debug("removeWithSession registration failed",e),n(new Error("REGISTRATION_CONFLICT"));else xD.debug("removeWithSession registration failed",e),n(i)})}})},e.prototype.update=function(e,t){var r=this;return new Ty.Promise(function(n,o){if(r.internal.checkConnected(o)){xD.debug("Updating topic",e);r.universalUpdater.update(e,t,function(t,r){t?(xD.debug("Update failed",e),o(t)):r.isError?(xD.debug("Update failed",e),o(r.reason)):(xD.debug("Update complete",e),n(e))})}})},e.prototype.updateValue=function(e,t,r){var n=this;return new Ty.Promise(function(o,i){if(r){if(n.internal.checkConnected(i)){xD.debug("Updating topic",e);n.universalUpdater.updateValue(e,t,r,function(t,r){t?(xD.debug("Update failed",e),i(t)):r.isError?(xD.debug("Update failed",e),i(r.reason)):(xD.debug("Update complete",e),o(e))})}}else i(new Error("Data type is required"))})},e.prototype.registerUpdateSource=function(e,t){var r=this;return new Ty.Promise(function(n,o){var i=r.internal.getConversationSet(),s=i.newConversation(new ND.UpdateResponseHandler(r.internal,r.valueCache,e,t));r.internal.checkConnected(o)&&r.UPDATE_SOURCE_REGISTRATION.send({cid:s,path:e},function(e,t){tN.responseSuccess(e,t)&&t.state!==EA.UpdateSourceState.CLOSED?(i.respond(s,{old:EA.UpdateSourceState.INIT,current:t.state}),n()):(i.discard(s,e),o(e))})})},e.prototype.addMissingTopicHandler=function(e,t){var r=this;return new Ty.Promise(function(n,o){if(t){if(r.internal.checkConnected(o)){var i={active:function(r){xD.debug("Missing Topic Handler registered for "+e),t.onRegister(e,r),n()},respond:function(r){var n=r.callback;xD.debug("Missing Topic Handler notification for "+r.request.sessionID+" using "+r.request.selector);try{t.onMissingTopic({path:r.request.selector.prefix,selector:r.request.selector,sessionID:r.request.sessionID,proceed:function(){n.respond(!0)},cancel:function(){n.respond(!1)}})}catch(r){throw t.onError(e,r),n.fail(av.ErrorReason.CALLBACK_EXCEPTION,r&&r.message),r}return!1},close:function(r){xD.debug("Missing Topic Handler closed for "+e),r?t.onError(e,r):t.onClose(e)}},s={definition:ZA.MISSING_TOPIC,group:Uw.DEFAULT,path:e};n(SL.registerTopicHandler(r.internal,s,i))}}else o(new Error("Missing Topic handler is null or undefined"))})},e}();UD.TopicControlImpl=kD;var qD={};Object.defineProperty(qD,"__esModule",{value:!0});var VD=$y.create("Session.Notifications"),FD=function(){function e(e){this.TopicNotificationType=Xb.TopicNotificationType,this.internal=e;var t=e.getServiceLocator();this.conversationSet=e.getConversationSet(),this.TOPIC_NOTIFICATION_SELECTION=t.obtain(ZA.TOPIC_NOTIFICATION_SELECTION),this.TOPIC_NOTIFICATION_DESELECTION=t.obtain(ZA.TOPIC_NOTIFICATION_DESELECTION),this.TOPIC_NOTIFICATION_DEREGISTRATION=t.obtain(ZA.TOPIC_NOTIFICATION_DEREGISTRATION);var r=e.getServiceRegistry(),n=zL.create(function(e,t,r){r.respond(),e.getConversationSet().respond(t.cid,t)});r.add(ZA.TOPIC_NOTIFICATION_EVENTS,n),r.add(ZA.TOPIC_DESCENDANT_EVENTS,n)}return e.prototype.addListener=function(e){var t=this;return new Ty.Promise(function(r,n){if(e){if(t.internal.checkConnected(n)){VD.debug("Adding Topic Notification Listener");var o={active:function(n,o){VD.debug("Topic Notification Listener active"),r({select:function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return new Ty.Promise(function(n,i){if(e)try{var s=r.length>0?im.parseSelector([e].concat(r)):im.parseSelector(e);t.TOPIC_NOTIFICATION_SELECTION.send({cid:o,selector:s},function(e){e?(t.conversationSet.discard(o,e),i(e)):n()})}catch(e){i(e)}else i(new Error("No topic selector provided"))})},deselect:function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return new Ty.Promise(function(n,i){if(e)try{var s=r.length>0?im.parseSelector([e].concat(r)):im.parseSelector(e);t.TOPIC_NOTIFICATION_DESELECTION.send({cid:o,selector:s},function(e){e?(t.conversationSet.discard(o,e),i(e)):n()})}catch(e){i(e)}else i(new Error("No topic selector provided"))})},close:function(){t.TOPIC_NOTIFICATION_DEREGISTRATION.send({cid:o},function(r,n){r?(t.conversationSet.discard(o,r),VD.debug("Error with topic notification deregistration: ",r)):(e.onClose(),t.conversationSet.respondIfPresent(o,n))})}})},respond:function(t){return t.isDescendantEvent?e.onDescendantNotification(t.path,t.type):e.onTopicNotification(t.path,t.specification,t.type),!1},close:function(t){VD.debug("Topic Notification Listener closed"),t?e.onError(t):e.onClose()}},i=t.conversationSet.newConversation(SL.responseHandler(t.internal,o,function(e,r){t.TOPIC_NOTIFICATION_DEREGISTRATION.send({cid:e},r)}));SL.registrationCallback(t.conversationSet,i,function(){},function(){})(void 0)}}else n(new Error("Topic Notification Listener is null or undefined"))})},e}();qD.TopicNotificationsImpl=FD;var GD={};Object.defineProperty(GD,"__esModule",{value:!0});var HD=function(){return function(e,t,r,n){this.path=e,this.topicSpecification=t,this.value=r,this.constraint=n}}();GD.AddAndSetTopicRequest=HD;var WD={};Object.defineProperty(WD,"__esModule",{value:!0});var YD=function(){return function(e,t,r){this.path=e,this.topicSpecification=t,this.constraint=r}}();WD.UpdateStreamAddTopicRequest=YD;var zD={};Object.defineProperty(zD,"__esModule",{value:!0});var JD=function(){return function(e,t){this.streamId=e,this.update=t}}();zD.UpdateStreamRequest=JD;var $D={};Object.defineProperty($D,"__esModule",{value:!0});var KD=function(){function e(e,t){this.value=t,this.err=e}return e.prototype.set=function(){return Ty.Promise.reject(this.err)},e.prototype.get=function(){return this.value},e.prototype.validate=function(){return Ty.Promise.reject(this.err)},e.prototype.onSetComplete=function(){},e.prototype.onSetFailed=function(){},e.prototype.onValidateComplete=function(){},e.prototype.onValidateFailed=function(){},e}();$D.InvalidSetStream=KD;var QD={};Object.defineProperty(QD,"__esModule",{value:!0});var XD=$y.create("diffusion.TopicUpdate"),ZD=function(){function e(e,t,r,n,o){this.streamServices=e,this.options=t,this.stream=r,this.streamId=n,this.cache=o}return e.prototype.set=function(e){var t=this;return this.options.checkOperation(e),new Ty.Promise(function(r,n){var o=t.options.toBuffer(t.cache,e);t.cache=e,t.options.deltaService.send(new zD.UpdateStreamRequest(t.streamId,o),function(e){e?(XD.debug("Set update stream failed"),t.stream.onSetFailed(e),n(e)):(t.stream.onSetComplete(t.streamId),r())})})},e.prototype.get=function(){return this.cache},e.prototype.validate=function(){var e=this;return new Ty.Promise(function(t,r){e.streamServices.CHECK_UPDATE_STREAM.send(e.streamId,function(n){n?(XD.debug("Validate update stream failed"),e.stream.onValidateFailed(n),r(n)):(e.stream.onValidateComplete(e.streamId),t(kC.TopicCreationResult.EXISTS))})})},e.prototype.onSetComplete=function(){},e.prototype.onSetFailed=function(e){this.stream.setDelegate(new $D.InvalidSetStream(e,this.cache))},e.prototype.onValidateComplete=function(){},e.prototype.onValidateFailed=function(e){this.stream.setDelegate(new $D.InvalidSetStream(e,this.cache))},e}();QD.SetStream=ZD;var ej={};(function(e){"use strict";Object.defineProperty(ej,"__esModule",{value:!0});var t=function(){function t(e,t,r,n,o){this.streamServices=e,this.options=t,this.stream=r,this.pendingResult=n,this.deferredResolvers=[],this.value=o,this.nextValue=o}return t.prototype.set=function(e){var t=this;return this.options.checkOperation(e),this.nextValue=e,new Ty.Promise(function(e,r){t.deferredResolvers.push({resolve:e,reject:r})})},t.prototype.get=function(){return this.nextValue},t.prototype.validate=function(){var e=this;return new Ty.Promise(function(t,r){e.pendingResult.then(function(e){return t(kC.TopicCreationResult.EXISTS),e},function(e){r(e)})})},t.prototype.onSetComplete=function(t){var r=this;this.stream.setDelegate(new QD.SetStream(this.streamServices,this.options,this.stream,t,this.nextValue));var n=this.options.dataType.toBytes(this.value).asBuffer(),o=this.options.dataType.toBytes(this.nextValue).asBuffer();if(0!==e.compare(n,o)){var i=this.options.toBuffer(this.value,this.nextValue);this.options.deltaService.send(new zD.UpdateStreamRequest(t,i),function(e){e?r.deferredResolvers.forEach(function(t){t.reject(e)}):r.deferredResolvers.forEach(function(e){e.resolve()})})}else this.deferredResolvers.forEach(function(e){e.resolve()})},t.prototype.onSetFailed=function(e){this.stream.setDelegate(new $D.InvalidSetStream(e,this.nextValue)),this.deferredResolvers.forEach(function(t){t.reject(e)})},t.prototype.onValidateComplete=function(){throw new Error("No validate request has been sent")},t.prototype.onValidateFailed=function(){throw new Error("No validate request has been sent")},t}();ej.PendingSetStream=t}).call(this,r({}).Buffer);var tj={};Object.defineProperty(tj,"__esModule",{value:!0});var rj=function(){function e(e){this.err=e}return e.prototype.set=function(){return Ty.Promise.reject(this.err)},e.prototype.get=function(){throw new Error("No value has been set")},e.prototype.validate=function(){return Ty.Promise.reject(this.err)},e.prototype.onSetComplete=function(){},e.prototype.onSetFailed=function(){},e.prototype.onValidateComplete=function(){},e.prototype.onValidateFailed=function(){},e}();tj.InvalidUnsetStream=rj;var nj={};Object.defineProperty(nj,"__esModule",{value:!0});var oj=function(){function e(e,t,r,n,o,i){this.streamServices=e,this.options=t,this.stream=r,this.pendingResult=n,this.deferredResolvers=[o],this.nextValue=i}return e.prototype.set=function(e){var t=this;return this.options.checkOperation(e),this.nextValue=e,new Ty.Promise(function(e,r){t.deferredResolvers.push({resolve:e,reject:r})})},e.prototype.get=function(){return this.nextValue},e.prototype.validate=function(){var e=this;return new Ty.Promise(function(t,r){e.pendingResult.then(function(e){return t(kC.TopicCreationResult.EXISTS),e},function(e){r(e)})})},e.prototype.onSetComplete=function(){throw new Error("No set request has been sent")},e.prototype.onSetFailed=function(){throw new Error("No set request has been sent")},e.prototype.onValidateComplete=function(e){var t=this;this.stream.setDelegate(new QD.SetStream(this.streamServices,this.options,this.stream,e,this.nextValue));var r=this.options.dataType.toBytes(this.nextValue).asBuffer();this.streamServices.STREAM_SET_TOPIC_SERVICE.send(new zD.UpdateStreamRequest(e,r),function(e){e?t.deferredResolvers.forEach(function(t){t.reject(e)}):t.deferredResolvers.forEach(function(e){e.resolve()})})},e.prototype.onValidateFailed=function(e){this.stream.setDelegate(new $D.InvalidSetStream(e,this.nextValue)),this.deferredResolvers.forEach(function(t){t.reject(e)})},e}();nj.PendingValidateAndSetStream=oj;var ij={};Object.defineProperty(ij,"__esModule",{value:!0});var sj=$y.create("diffusion.TopicUpdate"),aj=function(){function e(e,t,r,n){this.streamServices=e,this.options=t,this.stream=r,this.streamId=n}return e.prototype.set=function(e){var t=this;return this.options.checkOperation(e),new Ty.Promise(function(r,n){t.stream.setDelegate(new QD.SetStream(t.streamServices,t.options,t.stream,t.streamId,e));var o=t.options.dataType.toBytes(e).asBuffer();t.streamServices.STREAM_SET_TOPIC_SERVICE.send(new zD.UpdateStreamRequest(t.streamId,o),function(e){e?(sj.debug("Stream set topic failed"),t.stream.onSetFailed(e),n(e)):(t.stream.onSetComplete(t.streamId),r())})})},e.prototype.get=function(){throw new Error("The set method has not been called")},e.prototype.validate=function(){var e=this;return new Ty.Promise(function(t,r){e.streamServices.CHECK_UPDATE_STREAM.send(e.streamId,function(n){n?(sj.debug("Validate update stream failed"),e.stream.onValidateFailed(n),r(n)):(e.stream.onValidateComplete(e.streamId),t(kC.TopicCreationResult.EXISTS))})})},e.prototype.onSetComplete=function(){throw new Error("The set method has not been called")},e.prototype.onSetFailed=function(){throw new Error("The set method has not been called")},e.prototype.onValidateComplete=function(){},e.prototype.onValidateFailed=function(e){this.stream.setDelegate(new tj.InvalidUnsetStream(e))},e}();ij.ValidatedStream=aj;var uj={};Object.defineProperty(uj,"__esModule",{value:!0});var cj=function(){function e(e,t,r,n){this.streamServices=e,this.options=t,this.stream=r,this.pendingResult=n}return e.prototype.set=function(e){var t=this;return this.options.checkOperation(e),new Ty.Promise(function(r,n){t.stream.setDelegate(new nj.PendingValidateAndSetStream(t.streamServices,t.options,t.stream,t.pendingResult,{resolve:r,reject:n},e))})},e.prototype.get=function(){throw new Error("The set method has not been called")},e.prototype.validate=function(){var e=this;return new Ty.Promise(function(t,r){e.pendingResult.then(function(e){return t(kC.TopicCreationResult.EXISTS),e},function(e){r(e)})})},e.prototype.onSetComplete=function(){throw new Error("No set request has been sent")},e.prototype.onSetFailed=function(){throw new Error("No set request has been sent")},e.prototype.onValidateComplete=function(e){this.stream.setDelegate(new ij.ValidatedStream(this.streamServices,this.options,this.stream,e))},e.prototype.onValidateFailed=function(e){this.stream.setDelegate(new tj.InvalidUnsetStream(e))},e}();uj.PendingValidateStream=cj;var pj={};Object.defineProperty(pj,"__esModule",{value:!0});var fj=$y.create("diffusion.TopicUpdate"),lj=function(){function e(e,t,r,n,o,i){this.streamServices=e,this.options=t,this.stream=r,this.path=n,this.specification=o,this.constraint=i}return e.prototype.set=function(e){var t=this;this.options.checkOperation(e);var r=new Ty.Promise(function(r,n){var o=t.options.dataType.toBytes(e).asBuffer();t.streamServices.STREAM_ADD_AND_SET_TOPIC_SERVICE.send(new GD.AddAndSetTopicRequest(t.path,t.specification,o,t.constraint),function(e,o){tN.responseSuccess(e,o)?(t.stream.onSetComplete(o.streamId),r(o.creationResult)):(fj.debug("Stream add and set topic failed"),t.stream.onSetFailed(e),n(e))})});return this.stream.setDelegate(new ej.PendingSetStream(this.streamServices,this.options,this.stream,r,e)),r},e.prototype.get=function(){throw new Error("The set method has not been called")},e.prototype.validate=function(){var e=this,t=new Ty.Promise(function(t,r){e.streamServices.STREAM_ADD_TOPIC_SERVICE.send(new WD.UpdateStreamAddTopicRequest(e.path,e.specification,e.constraint),function(n,o){tN.responseSuccess(n,o)?(e.stream.onValidateComplete(o.streamId),t(o.creationResult)):(fj.debug("Stream add topic failed"),e.stream.onValidateFailed(n),r(n))})});return this.stream.setDelegate(new uj.PendingValidateStream(this.streamServices,this.options,this.stream,t)),t},e.prototype.onSetComplete=function(){throw new Error("No set request has been sent")},e.prototype.onSetFailed=function(){throw new Error("No set request has been sent")},e.prototype.onValidateComplete=function(){throw new Error("No validate request has been sent")},e.prototype.onValidateFailed=function(){throw new Error("No validate request has been sent")},e}();pj.NewAddTopicAndUpdateStream=lj;var hj={};Object.defineProperty(hj,"__esModule",{value:!0});var dj=function(){return function(e,t,r,n){this.path=e,this.topicType=t,this.value=r,this.constraint=n}}();hj.CreateUpdateStreamAndSetRequest=dj;var yj={};Object.defineProperty(yj,"__esModule",{value:!0});var vj=function(){return function(e,t,r){this.path=e,this.topicType=t,this.constraint=r}}();yj.CreateUpdateStreamRequest=vj;var _j={};Object.defineProperty(_j,"__esModule",{value:!0});var Sj=$y.create("diffusion.TopicUpdate"),Ej=function(){function e(e,t,r,n,o,i){this.streamServices=e,this.options=t,this.stream=r,this.path=n,this.topicType=o,this.constraint=i}return e.prototype.set=function(e){var t=this;this.options.checkOperation(e);var r=new Ty.Promise(function(r,n){var o=t.options.dataType.toBytes(e).asBuffer();t.streamServices.CREATE_UPDATE_STREAM_AND_SET.send(new hj.CreateUpdateStreamAndSetRequest(t.path,t.topicType,o,t.constraint),function(e,o){tN.responseSuccess(e,o)?(t.stream.onSetComplete(o),r(kC.TopicCreationResult.EXISTS)):(Sj.debug("Failed to create update stream and set"),t.stream.onSetFailed(e),n(e))})});return this.stream.setDelegate(new ej.PendingSetStream(this.streamServices,this.options,this.stream,r,e)),r},e.prototype.get=function(){throw new Error("The set method has not been called")},e.prototype.validate=function(){var e=this,t=new Ty.Promise(function(t,r){e.streamServices.CREATE_UPDATE_STREAM.send(new yj.CreateUpdateStreamRequest(e.path,e.topicType,e.constraint),function(n,o){tN.responseSuccess(n,o)?(e.stream.onValidateComplete(o),t(kC.TopicCreationResult.EXISTS)):(Sj.debug("Create update stream failed"),e.stream.onValidateFailed(n),r(n))})});return this.stream.setDelegate(new uj.PendingValidateStream(this.streamServices,this.options,this.stream,t)),t},e.prototype.onSetComplete=function(){throw new Error("No set request has been sent")},e.prototype.onSetFailed=function(){throw new Error("No set request has been sent")},e.prototype.onValidateComplete=function(){throw new Error("No validate request has been sent")},e.prototype.onValidateFailed=function(){throw new Error("No validate request has been sent")},e}();_j.NewUpdateStream=Ej;var mj={};Object.defineProperty(mj,"__esModule",{value:!0});var wj=function(){function e(e){this.delegate=e(this)}return e.prototype.set=function(e){return this.delegate.set(e)},e.prototype.get=function(){return this.delegate.get()},e.prototype.validate=function(){return this.delegate.validate()},e.prototype.onSetComplete=function(e){this.delegate.onSetComplete(e)},e.prototype.onSetFailed=function(e){this.delegate.onSetFailed(e)},e.prototype.onValidateComplete=function(e){this.delegate.onValidateComplete(e)},e.prototype.onValidateFailed=function(e){this.delegate.onValidateFailed(e)},e.prototype.setDelegate=function(e){this.delegate=e},e}();mj.UpdateStreamImpl=wj;var gj={};Object.defineProperty(gj,"__esModule",{value:!0});var Oj=function(){function e(e){this.streamServices=e}return e.prototype.getValueCheckOperation=function(e){switch(e.name()){case"int64":case"double":case"string":return function(){};default:return function(e){S_.requireNonNull(e,"null can only be passed for int64, double or string topics")}}},e.prototype.getChangeService=function(e){return void 0===e?this.streamServices.STREAM_SET_TOPIC_SERVICE:this.streamServices.STREAM_APPLY_DELTA_SERVICE},e.prototype.getToBytesFunction=function(e,t){return void 0===t?function(t,r){return e.toBytes(r).asBuffer()}:function(e,r){var n=t.diff(e,r);return n.$buffer.slice(n.$offset,n.$offset+n.$length)}},e.prototype.binaryDeltaType=function(e){try{return e.binaryDeltaType()}catch(e){return}},e.prototype.createUpdateStream=function(e,t,r){var n=this,o=this.binaryDeltaType(t),i={dataType:t,checkOperation:this.getValueCheckOperation(t),toBuffer:this.getToBytesFunction(t,o),deltaService:this.getChangeService(o)},s=nE.TopicTypeEnum[t.name().toUpperCase()];return new mj.UpdateStreamImpl(function(t){return new _j.NewUpdateStream(n.streamServices,i,t,e,s,r)})},e.prototype.createUpdateStreamThatAddsTopic=function(e,t,r,n){var o=this,i=this.binaryDeltaType(r),s={dataType:r,checkOperation:this.getValueCheckOperation(r),toBuffer:this.getToBytesFunction(r,i),deltaService:this.getChangeService(i)};return new mj.UpdateStreamImpl(function(r){return new pj.NewAddTopicAndUpdateStream(o.streamServices,s,r,e,t,n)})},e}();gj.UpdateStreamFactory=Oj;var Tj={};Object.defineProperty(Tj,"__esModule",{value:!0});var Ij=$y.create("Session.TopicUpdate"),Rj=new yC.Unconstrained,bj=function(){function e(e){var t=e.getServiceLocator();this.SET_TOPIC=t.obtain(ZA.SET_TOPIC),this.ADD_AND_SET_TOPIC=t.obtain(ZA.ADD_AND_SET_TOPIC),this.APPLY_JSON_PATCH=t.obtain(ZA.APPLY_JSON_PATCH);var r={CREATE_UPDATE_STREAM:t.obtain(ZA.CREATE_UPDATE_STREAM),CREATE_UPDATE_STREAM_AND_SET:t.obtain(ZA.CREATE_UPDATE_STREAM_AND_SET),CHECK_UPDATE_STREAM:t.obtain(ZA.CHECK_UPDATE_STREAM),STREAM_SET_TOPIC_SERVICE:t.obtain(ZA.STREAM_SET_TOPIC_SERVICE),STREAM_APPLY_DELTA_SERVICE:t.obtain(ZA.STREAM_APPLY_DELTA_SERVICE),STREAM_ADD_TOPIC_SERVICE:t.obtain(ZA.STREAM_ADD_TOPIC_SERVICE),STREAM_ADD_AND_SET_TOPIC_SERVICE:t.obtain(ZA.STREAM_ADD_AND_SET_TOPIC_SERVICE)};this.updateStreamFactory=new gj.UpdateStreamFactory(r)}return e.prototype.setTopic=function(e,t,r,n){var o=this;return new Ty.Promise(function(i,s){o.SET_TOPIC.send({path:e,topicType:nE.TopicTypeEnum[t.name().toUpperCase()],value:t.toBytes(r).asBuffer(),constraint:n},function(e){e?(Ij.debug("Set topic failed"),s(e)):i()})})},e.prototype.addAndSetTopic=function(e,t,r,n,o){var i=this;if(t.type!==nE.TopicTypeEnum[r.name().toUpperCase()])throw new Error("The specification and value have different data types");var s=r.toBytes(n).asBuffer();return new Ty.Promise(function(r,n){i.ADD_AND_SET_TOPIC.send({path:e,topicSpecification:t,value:s,constraint:o},function(e,t){e?(Ij.debug("Add and set topic failed"),n(e)):r(t.result)})})},e.prototype.set=function(e,t,r,n){var o=void 0!==n&&void 0!==n.constraint?n.constraint:Rj;return void 0!==n&&void 0!==n.specification?this.addAndSetTopic(e,n.specification,t,r,o):this.setTopic(e,t,r,o)},e.prototype.createUpdateStream=function(e,t,r){var n=void 0!==r&&void 0!==r.constraint?r.constraint:Rj;return void 0!==r&&void 0!==r.specification?this.updateStreamFactory.createUpdateStreamThatAddsTopic(e,r.specification,t,n):this.updateStreamFactory.createUpdateStream(e,t,n)},e.prototype.applyJsonPatch=function(e,t,r){var n=this;return new Ty.Promise(function(o,i){n.APPLY_JSON_PATCH.send({path:e,patch:"string"==typeof t?t:JSON.stringify(t),constraint:r||Rj},function(e,t){e?(Ij.debug("Apply JSON patch failed"),i(e)):o(t)})})},e}();Tj.TopicUpdateImpl=bj;var Cj={};Object.defineProperty(Cj,"__esModule",{value:!0});var Pj=function(){return function(e,t){this.name=e,this.specification=t}}();Cj.NamedTopicViewSpecification=Pj;var Aj={};Object.defineProperty(Aj,"__esModule",{value:!0});var Nj=$y.create("TopicViews"),Mj=function(){function e(e){this.internal=e;var t=e.getServiceLocator();this.CREATE_TOPIC_VIEW=t.obtain(ZA.CREATE_TOPIC_VIEW),this.LIST_TOPIC_VIEWS=t.obtain(ZA.LIST_TOPIC_VIEWS),this.REMOVE_TOPIC_VIEW=t.obtain(ZA.REMOVE_TOPIC_VIEW)}return e.prototype.createTopicView=function(e,t){var r=this;return new Ty.Promise(function(n,o){if(0===S_.requireNonNull(e,"name").length)throw new Error("Topic View name cannot be empty");if(r.internal.checkConnected(o)){var i=new Cj.NamedTopicViewSpecification(e,S_.requireNonNull(t,"specification"));r.CREATE_TOPIC_VIEW.send(i,function(e,t){tN.responseSuccess(e,t)?t.errors?(o(t.errors.errors),Nj.debug("Create topic view failed")):n(t.view):(o(e),Nj.debug("Create topic view failed"))})}})},e.prototype.listTopicViews=function(){var e=this;return new Ty.Promise(function(t,r){e.internal.checkConnected(r)&&e.LIST_TOPIC_VIEWS.send(null,function(e,n){tN.responseSuccess(e,n)?t(n.result):(r(e),Nj.debug("List topic views failed"))})})},e.prototype.removeTopicView=function(e){var t=this;return new Ty.Promise(function(r,n){t.internal.checkConnected(n)&&t.REMOVE_TOPIC_VIEW.send(S_.requireNonNull(e,"name"),function(e){e?(n(e),Nj.debug("Remove topic view failed")):r()})})},e}();Aj.TopicViewsImpl=Mj;var Lj={};Object.defineProperty(Lj,"__esModule",{value:!0});var Dj=function(){function e(e,t,r,n){this.mPath=e,this.mType=t,this.mValue=r,this.mProperties=n}return e.prototype.path=function(){return this.mPath},e.prototype.type=function(){return this.mType},e.prototype.value=function(){return this.mValue},e.prototype.specification=function(){return new CE.TopicSpecification(this.mType,this.mProperties)},e}();Lj.TopicResultImpl=Dj;var jj={};Object.defineProperty(jj,"__esModule",{value:!0}),jj.TIME_SERIES_DATA_TYPE=XS.TimeSeriesEventDataType.create({name:function(){return"event data type"},readValue:function(e){return e},toBytes:function(e){return e}});var Uj=function(){function e(e,t){this.resultList=t.results.map(function(r){var n;void 0!==r.value&&(n=r.type===nE.TopicTypeEnum.TIME_SERIES?jj.TIME_SERIES_DATA_TYPE.readAs(jj.TIME_SERIES_DATA_TYPE.valueClass,r.value):iE.DataTypes.get(r.type).readAs(e.valueClass,r.value));return new Lj.TopicResultImpl(r.path,r.type,n,0===t.properties.length?{}:t.properties[r.propertiesIndex])}),this.hasMoreFlag=t.hasMore}return e.prototype.results=function(){return this.resultList},e.prototype.hasMore=function(){return this.hasMoreFlag},e.prototype.size=function(){return this.resultList.length},e.prototype.isEmpty=function(){return 0===this.resultList.length},e}();jj.FetchResultImpl=Uj;var xj={};Object.defineProperty(xj,"__esModule",{value:!0});var Bj=function(){return function(e,t,r,n,o,i,s,a,u,c){this.selector=S_.requireNonNull(e,"FetchQuery.selector"),this.range=t,this.topicTypes=S_.requireNonNull(r,"FetchQuery.topicTypes"),this.withValues=n,this.withProperties=o,this.limit=i,this.maximumResultSize=s,this.deepBranchDepth=a,this.deepBranchLimit=u,this.withUnpublishedDelayedTopics=c}}();xj.FetchQuery=Bj;var kj={},qj=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(kj,"__esModule",{value:!0});var Vj=$y.create("Fetch Request"),Fj=function(){return function(e,t){this.path=e,this.includesPath=t}}(),Gj=function(){function e(e,t){this.from=e,this.to=t}return e.prototype.isUnbounded=function(){return void 0===this.from&&void 0===this.to},e}();function Hj(e,t){if(e===nE.TopicTypeEnum.TIME_SERIES)return jj.TIME_SERIES_DATA_TYPE.canReadAs(t);var r=iE.DataTypes.getByValue(e);return null!==r&&void 0!==t.valueClass&&r.canReadAs(t.valueClass)}function Wj(e,t){if(!Number.isInteger(e)||e<0)throw new Error("Invalid argument "+t+": "+e);return e}var Yj=function(e){function t(t,r){var n=e.call(this)||this,o={range:new Gj,topicTypes:qP.FetchRequest.getAllTypes(),dataType:void 0,withProperties:!1,limit:Nv.MAX_INT32,maximumResultSize:t.getOptions().maxMessageSize,deepBranchDepth:Nv.MAX_INT32,deepBranchLimit:Nv.MAX_INT32,withUnpublishedDelayedTopics:!1};return n.internal=t,n.options=Ty.Object.assign(o,r),n}return qj(t,e),t.prototype.copyOptions=function(){return{range:new Gj(this.options.range.from,this.options.range.to),topicTypes:new Ty.Set(this.options.topicTypes),dataType:this.options.dataType,withProperties:this.options.withProperties,limit:this.options.limit,maximumResultSize:this.options.maximumResultSize,deepBranchDepth:this.options.deepBranchDepth,deepBranchLimit:this.options.deepBranchLimit,withUnpublishedDelayedTopics:this.options.withUnpublishedDelayedTopics}},t.prototype.from=function(e){var r=new Fj(e,!0);return new t(this.internal,Ty.Object.assign(this.copyOptions(),{range:new Gj(r,this.options.range.to)}))},t.prototype.after=function(e){var r=new Fj(e,!1);return new t(this.internal,Ty.Object.assign(this.copyOptions(),{range:new Gj(r,this.options.range.to)}))},t.prototype.to=function(e){var r=new Fj(e,!0);return new t(this.internal,Ty.Object.assign(this.copyOptions(),{range:new Gj(this.options.range.from,r)}))},t.prototype.before=function(e){var r=new Fj(e,!1);return new t(this.internal,Ty.Object.assign(this.copyOptions(),{range:new Gj(this.options.range.from,r)}))},t.prototype.topicTypes=function(e){var r=this;if(0===e.length)throw new Error("No types specified");var n=qP.FetchRequest.getAllTypes();return e.forEach(function(e){if(!n.has(e))throw new Error("Invalid topic type "+e.id);if(void 0!==r.options.dataType&&!Hj(e,r.options.dataType))throw new Error("Topic type "+e.id+" cannot be read as "+r.options.dataType)}),new t(this.internal,Ty.Object.assign(this.copyOptions(),{topicTypes:new Ty.Set(e)}))},t.prototype.withValues=function(e){var r;if(void 0===e||e instanceof yv.AnyDataTypeImpl)r=this.options.topicTypes;else if(r=new Ty.Set(this.options.topicTypes),this.options.topicTypes.forEach(function(t){Hj(t,e)||r.delete(t)}),0===r.size)throw new Error("No selected topic types can be read as "+e);return new t(this.internal,Ty.Object.assign(this.copyOptions(),{topicTypes:r,dataType:e}))},t.prototype.withProperties=function(){return new t(this.internal,Ty.Object.assign(this.copyOptions(),{withProperties:!0}))},t.prototype.first=function(e){return new t(this.internal,Ty.Object.assign(this.copyOptions(),{limit:Wj(e,"count")}))},t.prototype.last=function(e){return new t(this.internal,Ty.Object.assign(this.copyOptions(),{limit:0-Wj(e,"count")}))},t.prototype.maximumResultSize=function(e){return new t(this.internal,Ty.Object.assign(this.copyOptions(),{maximumResultSize:Math.min(Wj(e,"maximumSize"),this.internal.getOptions().maxMessageSize)}))},t.prototype.limitDeepBranches=function(e,r){return new t(this.internal,Ty.Object.assign(this.copyOptions(),{deepBranchDepth:Wj(e,"deepBranchDepth"),deepBranchLimit:Wj(r,"deepBranchLimit")}))},t.prototype.withUnpublishedDelayedTopics=function(){return new t(this.internal,Ty.Object.assign(this.copyOptions(),{withUnpublishedDelayedTopics:!0}))},t.prototype.fetch=function(e){var t=this,r=this.internal.getServiceLocator().obtain(ZA.FETCH_QUERY),n=arguments.length>1?im.parseSelector(Array.prototype.slice.call(arguments)):im.parseSelector(e),o=new xj.FetchQuery(n,this.options.range,this.options.topicTypes,void 0!==this.options.dataType,this.options.withProperties,this.options.limit,this.options.maximumResultSize,this.options.deepBranchDepth,this.options.deepBranchLimit,this.options.withUnpublishedDelayedTopics);return new Ty.Promise(function(e,n){r.send(o,function(r,o){if(tN.responseSuccess(r,o)){var i=new jj.FetchResultImpl(t.options.dataType,o);e(i)}else Vj.debug("Fetch query failed"),n(r)})})},t}(qP.FetchRequest);kj.FetchRequestImpl=Yj;var zj={},Jj=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(zj,"__esModule",{value:!0});var $j=function(e){function t(t){return e.call(this,t)||this}return Jj(t,e),t}(sE.StreamImpl);zj.FetchStreamImpl=$j;var Kj={},Qj=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Kj,"__esModule",{value:!0});var Xj=function(e){function t(t,r){var n=e.call(this,t)||this;return n.selector=r,n}return Qj(t,e),t}(sE.StreamImpl);Kj.ValueStreamImpl=Xj;var Zj={};Object.defineProperty(Zj,"__esModule",{value:!0});var eU=function(){function e(e,t,r){this.stream=e,this.datatype=t,this.sourceDatatype=iE.DataTypes.getByValue(r)}return e.prototype.selects=function(e){return this.stream.selects(e)},e.prototype.onOpen=function(){return this.stream.onOpen()},e.prototype.onDelta=function(e,t,r,n,o,i,s){return this.stream.onDelta(e,t,r,n,o,null!==r?this.sourceDatatype.readAs(this.datatype.valueClass,r):null,this.sourceDatatype.readAs(this.datatype.valueClass,n))},e.prototype.onValue=function(e,t,r,n,o,i){return this.stream.onValue(e,t,r,n,null!==r?this.sourceDatatype.readAs(this.datatype.valueClass,r):null,this.sourceDatatype.readAs(this.datatype.valueClass,n))},e.prototype.onSubscription=function(e,t){return this.stream.onSubscription(e,t)},e.prototype.onUnsubscription=function(e,t,r){return this.stream.onUnsubscription(e,t,r)},e.prototype.onSubscriptionError=function(e){return this.stream.onSubscriptionError(e)},e}();Zj.ValueStreamAdapter=eU;var tU={};Object.defineProperty(tU,"__esModule",{value:!0});var rU=function(){function e(e,t,r,n,o,i){var s=this;this.pending=!0;var a=TE.Emitter.create();this.subscription=o(a,t),this.emitter=a.emitter(this.subscription),this.subscription.on("close",function(){e.remove(s)}),this.adapterFactory=i,this.datatype=r,this.registry=e;var u=this.subscription.on.bind(this.subscription);this.subscription.on=function(o,i){var a=u(o,i);return s.pending&&(n?e.addFallback(s,r):e.add(t,s,r),s.pending=!1),a}}return e.prototype.selects=function(e){if(e){if(e.type===nE.TopicTypeEnum.TIME_SERIES){var t=iE.DataTypes.get(e.properties.TIME_SERIES_EVENT_VALUE_TYPE),r=this.datatype instanceof XS.TimeSeriesEventDataType?iE.DataTypes.get(this.datatype.valueTypeName):this.datatype;return!!t&&t.canReadAs(r.valueClass)}return iE.DataTypes.getByValue(e.type).canReadAs(this.datatype.valueClass)}return!1},e.prototype.adapter=function(e){return e.type===nE.TopicTypeEnum.TIME_SERIES||e.type===nE.TopicTypeEnum[this.datatype.name().toUpperCase()]?this:this.adapterFactory(this,this.datatype,e.type)},e.prototype.onOpen=function(){this.emitter.emit("open",this.subscription)},e.prototype.onDelta=function(e,t,r,n,o,i,s){this.emitter.emit("value",e,t,s,i)},e.prototype.onValue=function(e,t,r,n,o,i){this.emitter.emit("value",e,t,i,o)},e.prototype.onSubscription=function(e,t){this.emitter.emit("subscribe",e,t)},e.prototype.onUnsubscription=function(e,t,r){this.emitter.emit("unsubscribe",e,t,r)},e.prototype.onSubscriptionError=function(e){this.emitter.error(e),this.registry.remove(this)},e}(),nU=new XE.SelectorSet([]);tU.create=function(e,t,r,n){return void 0===n&&(n=nU),new rU(e,n,t,r,function(e,t){return new Kj.ValueStreamImpl(e,t)},function(e,t,r){return new Zj.ValueStreamAdapter(e,t,r)}).subscription};var oU={},iU=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(oU,"__esModule",{value:!0});var sU=$y.create("Session"),aU=function(e){function t(t,r,n){var o=e.call(this,r,n)||this;return o.internal=t,o.UNSUBSCRIBE=t.getServiceLocator().obtain(ZA.UNSUBSCRIBE),o.SUBSCRIBE=t.getServiceLocator().obtain(ZA.SUBSCRIBE),o.FETCH=t.getServiceLocator().obtain(ZA.FETCH),o.streamRegistry=t.getStreamRegistry(),o}return iU(t,e),t.prototype.unsubscribe=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=arguments;return new Ty.Promise(function(r,n){try{var i=o.length>1?im.parseSelector(Array.prototype.slice.call(o)):im.parseSelector(e);if(t.internal.checkConnected(n)){sU.debug("Unsubscribing",e),t.UNSUBSCRIBE.send(i,function(t){t?(sU.debug("Unsubscribe failed",e),n(t)):(sU.debug("Unsubscribe complete",e),r())})}}catch(e){n(e)}})},t.prototype.fetch=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(sU.debug("Fetch request for: ",e),this.internal.isShared())throw new Error("Deprecated fetch is not implemented for shared sessions");S_.requireNonNull(e,"Selector");var n=TE.Emitter.create(),o=new zj.FetchStreamImpl(n),i=n.emitter(o);try{var s=arguments.length>1?im.parseSelector(Array.prototype.slice.call(arguments)):im.parseSelector(e);if(this.internal.checkConnected(function(e){i.error(e)})){var a=this.internal.getConversationSet().newConversation({onOpen:function(){i.emit("open")},onResponse:function(e,t){var r=t.data,n=t.topic;return n?(i.emit("value",r,n),!1):1===r.length&&1===r[0]?(i.close(),!0):(i.error(new Error("Unexpected end of fetch stream")),!0)},onDiscard:function(e,t){t instanceof sM.CloseReasonImpl?i.close():i.error(t)}});this.FETCH.send({cid:a,selector:s},function(e){e&&i.error(e)})}}catch(e){i.error(e)}return o},t.prototype.fetchRequest=function(){return new kj.FetchRequestImpl(this.internal)},t.prototype.select=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=arguments;return new Ty.Promise(function(r,n){sU.debug("Subscribing",e);try{var i=o.length>1?im.parseSelector(Array.prototype.slice.call(o)):im.parseSelector(e);t.internal.checkConnected(n)&&t.SUBSCRIBE.send(i,function(e){e?n(e):r()})}catch(e){n(e)}})},t.prototype.addStream=function(e,t){if(2!==arguments.length)throw new Error("Both topic selector and value type are needed");if(!t||iE.DataTypes.get(t))throw new Error("Data type required");var r=im.parseSelector(e);return tU.create(this.streamRegistry,t,!1,r)},t.prototype.addFallbackStream=function(e){if(!e||iE.DataTypes.get(e))throw new Error("Data type required");return tU.create(this.streamRegistry,e,!0)},t}(sE.StreamImpl);oU.TopicsImpl=aU;var uU={},cU=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(uU,"__esModule",{value:!0});var pU=function(e){function t(t,r,n){var o=this,i=TE.Emitter.create();o=e.call(this,n,i)||this;var s=i.emitter(o);return n.on({reconnect:function(){s.emit("reconnect")},disconnect:function(e){s.emit("disconnect",e)},error:function(e){s.emit("error",e)},close:function(e){s.emit("close",e)}}),o.topics=new UD.TopicControlImpl(n),o.clients=new kL.ClientControlImpl(n),o.messages=new JL.MessagesImpl(n),o.notifications=new qD.TopicNotificationsImpl(n),o.remoteServers=new iD.RemoteServersImpl(n),o.security=new vD.SecurityImpl(n),o.timeseries=new TD.TimeSeriesImpl(n),o.topicUpdate=new Tj.TopicUpdateImpl(n),o.topicViews=new Aj.TopicViewsImpl(n),o.logRetrieval=new WL.LogRetrieval(n),o.metrics=new ZL.Metrics(n),o.licenceUpdater=new uD.LicenceUpdater(n),o.sessionId=t,o.sessionID=t.toString(),o.ping=new tD.PingImpl(n),o.options=void 0!==r?r.with({credentials:void 0}):{},o}return cU(t,e),t.prototype.close=function(){return this.internal.close(),this},t.prototype.closeSession=function(){var e=this;return new Ty.Promise(function(t,r){e.on("close",t),e.close()})},t.prototype.isClosed=function(){var e=this.internal.getState();return"closing"===e||"closed"===e},t.prototype.isConnected=function(){return this.internal.isConnected()},t.prototype.toString=function(){return"Session<"+this.sessionId+" "+this.internal.getState()+">"},t.prototype.getPrincipal=function(){return this.options.principal||""},t.prototype.lock=function(e,t){return void 0===t&&(t=WR.SessionLockScope.UNLOCK_ON_SESSION_LOSS),this.internal.lock(e,t)},t.prototype.pingServer=function(){return this.ping.pingServer()},t.prototype.getServerMaximumMessageSize=function(){return this.internal.getServerMaximumMessageSize()},t.create=function(e,r){var n;return void 0!==r&&(n="string"==typeof r?new WM.OptionsImpl({host:r}):new WM.OptionsImpl(r)),new Ty.Promise(function(r,o){var i=e(n);function s(e,o){i.off("connect",s),i.off("close",a),i.off("error",a),r(new t(e,o||n,i))}function a(e){i.off("connect",s),i.off("close",a),i.off("error",a),o(e)}i.on("connect",s),i.on("close",a),i.on("error",a),i.connect()})},t}(oU.TopicsImpl);uU.SessionImpl=pU;var fU={};Object.defineProperty(fU,"__esModule",{value:!0});var lU=function(){function e(){}return e.prototype.locked=function(e){return new yC.Locked(e)},e.prototype.value=function(e,t){S_.requireNonNull(e,"value");var r=void 0!==t?t:iE.DataTypes.getByValue(e);if(void 0===r)throw new Error("Datatype invalid or could not be inferred");return new yC.BinaryValue(r.toBytes(e))},e.prototype.noValue=function(){return new yC.NoValue},e.prototype.noTopic=function(){return new yC.NoTopic},e.prototype.jsonValue=function(){return new yC.PartialJSONImpl},e}(),hU=Object.freeze(new lU);fU.updateConstraintFactory=hU;var dU={};Object.defineProperty(dU,"__esModule",{value:!0}),dU.ClientControlOptions={PropertyKeys:Object.freeze({ALL_FIXED_PROPERTIES:["*F"],ALL_USER_PROPERTIES:["*U"],ALL_PROPERTIES:["*F","*U"],SESSION_ID:"$SessionId",PRINCIPAL:"$Principal",CONNECTOR:"$Connector",TRANSPORT:"$Transport",CLIENT_TYPE:"$ClientType",COUNTRY:"$Country",LANGUAGE:"$Language",SERVER_NAME:"$ServerName",CLIENT_IP:"$ClientIP",LATITUDE:"$Latitude",LONGITUDE:"$Longitude",START_TIME:"$StartTime",ROLES:"$Roles"}),ANONYMOUS:"",ClientType:FI.ClientType,TransportType:FI.TransportType,AddressType:qI.AddressType,DetailType:bI.DetailType,CloseReason:uM.CloseReasonEnum};var yU={},vU=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},_U=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(vU(arguments[t]));return e};Object.defineProperty(yU,"__esModule",{value:!0});var SU=function(){function e(){this.Prefix=qE.Prefix,this.Type=qE.Type}return e.prototype.parse=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return im.parseSelector.apply(void 0,_U([e],t))},e}();yU.TopicSelectors=SU;var EU={};Object.defineProperty(EU,"__esModule",{value:!0}),function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.silent="silent"}(EU.LogLevel||(EU.LogLevel={}));var mU={};return Object.defineProperty(mU,"__esModule",{value:!0}),$y.setLevel("warn"),mU.version="6.5.0",mU.build="70454",mU.log=function(e){$y.setLevel(e)},mU.connect=function(e,t,r){return uU.SessionImpl.create(dL.create(t,r),e)},mU.connectShared=function(e,t){return uU.SessionImpl.create(dL.createShared(e,t),void 0)},mU.escape=function(e){return _L.escape(e)},mU.stringToRoles=function(e){return _L.stringToRoles(e)},mU.rolesToString=function(e){return _L.rolesToString(e)},mU.updateConstraints=function(){return fU.updateConstraintFactory},mU.datatypes=iE.DataTypes,mU.selectors=new yU.TopicSelectors,mU.topics=FP.topicsNamespace,mU.topicUpdate=kC.TopicUpdateNamespace,mU.errors=av.ErrorReason,mU.clients=dU.ClientControlOptions,mU.locks=WR.SessionLockOptions,mU.AddressType=qI.AddressType,mU.ClientType=FI.ClientType,mU.TransportType=FI.TransportType,mU.CloseReasonEnum=uM.CloseReasonEnum,mU.DetailType=bI.DetailType,mU.SessionEventType=BL.SessionEventType,mU.ConnectionOption=JT.ConnectionOption,mU.ConnectionState=JT.ConnectionState,mU.GlobalPermission=Tm.GlobalPermission,mU.PathPermission=Tm.PathPermission,mU.ValidationType=Tm.ValidationType,mU.SessionLockScope=WR.SessionLockScope,mU.TopicNotificationType=Xb.TopicNotificationType,mU.Prefix=qE.Prefix,mU.Type=qE.Type,mU.TopicCreationResult=kC.TopicCreationResult,mU.LogLevel=EU.LogLevel,mU.TopicPermission=Tm.PathPermission,mU});